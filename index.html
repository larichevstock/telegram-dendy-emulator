<!DOCTYPE html>
<html>
<head>
    <title>Dendy Emulator –¥–ª—è Telegram</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        body, html { height: 100%; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; -webkit-tap-highlight-color: transparent; background-color: #282c34; color: #ffffff; overflow-x: hidden; }
        .retro-container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 15px; box-sizing: border-box; }
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; background: linear-gradient(90deg, #ff0080, #ff8c00); border-radius: 12px; padding: 10px 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); }
        .logo { display: flex; align-items: center; } .logo img { width: 50px; height: 50px; border-radius: 50%; margin-right: 10px; border: 2px solid #fff; } .logo-text { font-family: 'Press Start 2P', cursive; color: #fff; text-shadow: 2px 2px 0 #000; } .logo-text h1 { margin: 0; font-size: 1.5em; } .logo-text p { margin: 5px 0 0 0; font-size: 0.8em; } .navigation { display: flex; gap: 10px; } .nav-button { background-color: rgba(0,0,0,0.3); color: #fff; border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 18px; transition: all 0.2s; } .nav-button:hover { background-color: rgba(0,0,0,0.5); transform: scale(1.1); }
        /* –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ */
        .search-container { position: relative; margin-bottom: 20px; max-width: 1200px; width: 100%; margin-left: auto; margin-right: auto; } .search-input { width: 100%; padding: 15px 45px 15px 20px; border: none; border-radius: 25px; background-color: rgba(255, 255, 255, 0.1); color: #fff; font-size: 16px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); transition: all 0.3s; box-sizing: border-box; } .search-input:focus { outline: none; background-color: rgba(255, 255, 255, 0.15); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); } .search-button { position: absolute; right: 5px; top: 5px; background: linear-gradient(90deg, #ff0080, #ff8c00); color: #fff; border: none; border-radius: 20px; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 18px; transition: all 0.2s; } .search-button:hover { transform: scale(1.05); }
        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */
        .categories { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; } .category-card { background: linear-gradient(135deg, #1e2033, #373b59); border-radius: 12px; padding: 15px; display: flex; flex-direction: column; align-items: center; text-align: center; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); overflow: hidden; position: relative; } .category-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); } .category-icon { font-size: 36px; margin-bottom: 10px; position: relative; z-index: 1; } .category-icon img { width: 60px; height: 60px; object-fit: contain; } .category-title { font-family: 'Press Start 2P', cursive; font-size: 14px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0; position: relative; z-index: 1; line-height: 1.3; word-break: break-word; } .category-card::after { content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 0, 128, 0.1), rgba(255, 140, 0, 0.1)); z-index: 0; opacity: 0; transition: opacity 0.3s; } .category-card:hover::after { opacity: 1; }
        /* –ë–æ–ª—å—à–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .featured-games { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; } .featured-card { background: linear-gradient(135deg, #373b59, #1e2033); border-radius: 12px; padding: 20px; position: relative; overflow: hidden; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); display: flex; flex-direction: column; } .featured-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); } .featured-content { position: relative; z-index: 1; flex-grow: 1; } .featured-title { font-family: 'Press Start 2P', cursive; font-size: 16px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 30px 0; } .featured-image { width: 100%; height: 120px; object-fit: contain; margin-top: auto; } .arrow-button { position: absolute; bottom: 10px; right: 10px; background: linear-gradient(90deg, #ff0080, #ff8c00); color: #fff; border: none; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 20px; font-weight: bold; transition: all 0.2s; z-index: 2; } .arrow-button:hover { transform: scale(1.1); }
        /* –°–µ–∫—Ü–∏—è 8-bit –•–∏—Ç—ã –∏ —Å–µ—Ç–∫–∞ –∏–≥—Ä */
        .retro-hits { margin-bottom: 20px; } .retro-hits-title { font-family: 'Press Start 2P', cursive; font-size: 18px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 15px 0; text-align: center; } .retro-games-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px; } .retro-game-card { background: linear-gradient(135deg, #1e2033, #373b59); border-radius: 12px; padding: 15px; display: flex; flex-direction: column; align-items: center; text-align: center; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); overflow: hidden; } .retro-game-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); } .retro-game-image { display: block; width: 100%; max-width: 90px; height: auto; object-fit: contain; margin-bottom: 8px; border-radius: 8px; background-color: rgba(0,0,0,0.1); } .retro-game-title { font-family: 'Press Start 2P', cursive; font-size: 12px; color: #fff; margin: 0; line-height: 1.3; word-break: break-word; }
        /* ROM –ó–∞–≥—Ä—É–∑–∫–∞ */
        .rom-upload { background: linear-gradient(135deg, #1e2033, #373b59); border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); } .rom-upload-title { font-family: 'Press Start 2P', cursive; font-size: 18px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 15px 0; text-align: center; } .upload-box { width: 100%; height: 120px; border: 2px dashed #555; border-radius: 8px; display: flex; align-items: center; justify-content: center; background-color: rgba(0, 0, 0, 0.2); transition: all 0.3s; cursor: pointer; position: relative; } .upload-box:hover, .upload-box[drag] { border-color: #ff0080; background-color: rgba(0, 0, 0, 0.3); } .file-input { position: absolute; width: 100%; height: 100%; opacity: 0; cursor: pointer; z-index: 10; } .upload-text { font-size: 16px; color: #aaa; text-align: center; padding: 0 15px; } .upload-text strong { color: #fff; display: block; margin-bottom: 5px; }
        /* –ù–æ–≤–æ—Å—Ç–∏/–ë–∞–Ω–Ω–µ—Ä */
        .news-banner { background: linear-gradient(135deg, #1e2033, #373b59); border-radius: 12px; padding: 20px; margin-bottom: 20px; position: relative; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); } .news-banner:hover { box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); } .news-content { position: relative; z-index: 1; display: flex; align-items: center; } .news-text { flex: 1; } .news-title { font-family: 'Press Start 2P', cursive; font-size: 16px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 10px 0; } .news-description { color: rgba(255, 255, 255, 0.8); margin: 0; font-size: 14px; } .news-icon { font-size: 36px; color: #ff0080; margin-right: 15px; }
        /* –≠–º—É–ª—è—Ç–æ—Ä –∏ –µ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        #display { width: 100%; height: calc(100vh - 160px); max-height: 600px; background-color: #000; border-radius: 12px; overflow: hidden; position: relative; margin-bottom: 20px; } #game { width: 100%; height: 100%; } #backButton { position: fixed; top: 15px; left: 15px; background-color: rgba(0,0,0,0.3); color: white; border: none; border-radius: 50%; width: 36px; height: 36px; display: none; align-items: center; justify-content: center; cursor: pointer; z-index: 1002; font-size: 22px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); background-color: transparent; } #backButton:hover { background-color: rgba(0,0,0,0.5); } #reloadEmulatorButton { position: fixed; top: 15px; right: 15px; background-color: rgba(0,0,0,0.3); color: white; border: none; border-radius: 50%; width: 36px; height: 36px; display: none; align-items: center; justify-content: center; cursor: pointer; z-index: 1002; font-size: 20px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); } #reloadEmulatorButton:hover { background-color: rgba(0,0,0,0.5); } #orientationMessage { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; padding: 20px; box-sizing: border-box; transition: opacity 0.3s ease; -webkit-tap-highlight-color: transparent; user-select: none; } #startPlayButton { background-color: #FF0000; color: white; border: none; border-radius: 8px; padding: 15px 30px; font-size: 20px; font-weight: bold; margin-bottom: 30px; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.3); transition: transform 0.1s ease, background-color 0.2s ease; -webkit-tap-highlight-color: transparent; } #startPlayButton:hover { background-color: #D00000; transform: translateY(2px); } .loading-state { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; } .loading-spinner { width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: white; animation: spin 1s ease-in-out infinite; } @keyframes spin { to { transform: rotate(360deg); } } .loading-indicator { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 2000; display: none; } .loading-indicator::after { content: ""; width: 50px; height: 50px; border: 5px solid #fff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite; }
        /* –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º */
        .fullscreen-mode #display { position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; max-height: none !important; z-index: 1000 !important; border-radius: 0 !important; margin: 0 !important; padding: 0 !important; overflow: hidden !important; background-color: #000 !important; } .fullscreen-mode #game { width: 100% !important; height: 100% !important; position: relative !important; display: flex !important; align-items: center !important; justify-content: center !important; overflow: hidden !important; background-color: #000 !important; } .fullscreen-mode #game canvas { object-fit: contain !important; max-width: 100% !important; max-height: 100% !important; width: auto !important; height: auto !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; image-rendering: pixelated !important; background-color: #000 !important; -webkit-backface-visibility: hidden !important; backface-visibility: hidden !important; } .fullscreen-mode .ejs_virtualGamepad, .fullscreen-mode .ejs_virtualGamepad_button, .fullscreen-mode .ejs_virtualGamepad_touchpad { z-index: 1002 !important; } .hidden { display: none !important; } body.touch-disabled { touch-action: none !important; -ms-touch-action: none !important; overflow: hidden !important; }
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–µ–∫—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞, –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä –∏ –∫–∞—Ç–∞–ª–æ–≥–∞ */
        #search-results-area { padding-top: 20px; } .search-results-title { font-family: 'Press Start 2P', cursive; font-size: 18px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 15px 0; text-align: center; } .back-to-main-button { display: block; margin: 20px auto 10px auto; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 12px; color: #fff; background: linear-gradient(90deg, #555, #333); border: none; border-radius: 8px; cursor: pointer; transition: background 0.3s; text-shadow: 1px 1px 0 #000; } .back-to-main-button:hover { background: linear-gradient(90deg, #666, #444); }
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (min-width: 768px) { .categories { grid-template-columns: repeat(3, 1fr); } .retro-games-grid { grid-template-columns: repeat(4, 1fr); } } @media (max-width: 600px) { .header { flex-direction: column; text-align: center; padding: 15px; } .logo { margin-bottom: 10px; justify-content: center; } .navigation { width: 100%; justify-content: center; } .featured-games { grid-template-columns: 1fr; } .news-content { flex-direction: column; text-align: center; } .news-icon { margin: 0 0 15px 0; } .retro-games-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; } } @media (max-width: 480px) { .rom-upload-title, .retro-hits-title { font-size: 14px; } .upload-box { height: 100px; } .upload-text { font-size: 14px; } .search-results-title { font-size: 16px; } } @media (max-width: 360px) { .retro-games-grid { grid-template-columns: repeat(2, 1fr); gap: 8px; } .retro-game-image { max-width: 70px; } .retro-game-title { font-size: 10px; } .retro-game-card { padding: 10px 5px; } .category-title { font-size: 12px; } }

/* === –°–¢–ò–õ–ò –î–õ–Ø –°–¢–†–ê–ù–ò–¶–´ –ò–ì–†–´ === */
#game-page-area {
    padding: 20px 15px;
    background-color: #1e2033; /* –ù–µ–º–Ω–æ–≥–æ –¥—Ä—É–≥–æ–π —Ñ–æ–Ω –¥–ª—è –æ—Ç–ª–∏—á–∏—è */
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.game-page-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.game-page-header {
    width: 100%;
    display: flex;
    justify-content: space-between; /* –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ —Å–ª–µ–≤–∞, –∂–∞–Ω—Ä —Å–ø—Ä–∞–≤–∞ */
    align-items: center;
    margin-bottom: 15px;
}

.game-page-back-button {
    background: none;
    border: none;
    color: #ff8c00; /* –û—Ä–∞–Ω–∂–µ–≤—ã–π —Ü–≤–µ—Ç */
    font-size: 28px; /* –ö—Ä—É–ø–Ω–µ–µ */
    cursor: pointer;
    padding: 5px;
    line-height: 1;
    font-weight: bold;
}
.game-page-back-button:hover {
    color: #ffae42; /* –°–≤–µ—Ç–ª–µ–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
}


.game-page-genre {
    font-family: 'Press Start 2P', cursive;
    font-size: 12px;
    color: #aaa;
    text-transform: uppercase;
    background-color: rgba(255, 255, 255, 0.1);
    padding: 5px 10px;
    border-radius: 6px;
    margin-left: auto; /* –ü—Ä–∏–∂–∏–º–∞–µ–º –≤–ø—Ä–∞–≤–æ */
}

.game-page-title {
    font-family: 'Press Start 2P', cursive;
    font-size: 20px; /* –ö—Ä—É–ø–Ω–µ–µ */
    color: #fff;
    text-shadow: 1px 1px 0 #000;
    margin: 0 0 20px 0; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
    line-height: 1.4;
}

.game-page-logo {
    width: 70%;           /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å 60% –¥–æ 70% */
    max-width: 250px;     /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å 200px –¥–æ 250px */
    height: auto;
    object-fit: contain;
    margin-bottom: 25px;
    border-radius: 8px;
    background-color: rgba(0,0,0,0.2);
    padding: 10px;
    box-sizing: border-box;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3); /* –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–Ω—å –¥–ª—è –ª—É—á—à–µ–≥–æ –≤–∏–¥–∞ */
}

.game-page-screenshots {
    margin-bottom: 25px;
    width: 100%;
    text-align: center;
    color: #aaa;
    font-style: italic;
}
/* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ (–∫–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏—Ç–µ)
.game-page-screenshots img {
    width: 48%;
    margin: 1%;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
} */

.game-page-description {
    color: #ddd;
    font-size: 15px;
    line-height: 1.6;
    margin-bottom: 30px;
    text-align: left; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é */
    max-width: 600px; /* –û–≥—Ä–∞–Ω–∏—á–∏–º —à–∏—Ä–∏–Ω—É –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
    width: 100%;
}

.game-page-play-button {
    font-family: 'Press Start 2P', cursive;
    font-size: 18px;
    color: #fff;
    background: linear-gradient(90deg, #ff0080, #ff8c00);
    border: none;
    border-radius: 10px;
    padding: 15px 30px;
    cursor: pointer;
    text-shadow: 1px 1px 0 #000;
    transition: all 0.2s;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}
.game-page-play-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 10px rgba(0,0,0,0.4);
}
/* === –ö–û–ù–ï–¶ –°–¢–ò–õ–ï–ô === */

    </style>
</head>
<body>
    <div class="retro-container" id="retro-container">
        <div class="header">
             <div class="logo"> <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSIjRkYwMDAwIiBkPSJNNTAsMTBjMjIuMSwwLDQwLDE3LjksNDAsNDBTNzIuMSw5MCw1MCw5MFMxMCw3Mi4xLDEwLDUwUzI3LjksMTAsNTAsMTB6Ii8+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTM1LDM1aDMwdjMwSDM1VjM1eiIvPjxjaXJjbGUgZmlsbD0iI0ZGRkZGRiIgY3g9IjI1IiBjeT0iMzUiIHI9IjUiLz48Y2lyY2xlIGZpbGw9IiNGRkZGRkYiIGN4PSI3NSIgY3k9IjM1IiByPSI1Ii8+PGNpcmNsZSBmaWxsPSIjRkZGRkZGIiBjeD0iNzUiIGN5PSI2NSIgcj0iNSIvPjxjaXJjbGUgZmlsbD0iI0ZGRkZGRiIgY3g9IjI1IiBjeT0iNjUiIHI9IjUiLz48L3N2Zz4=" alt="Logo" /> <div class="logo-text"> <h1>Dendy</h1> <p>–†–µ—Ç—Ä–æ-—ç–º—É–ª—è—Ç–æ—Ä</p> </div> </div>
             <div class="navigation"> <button class="nav-button" title="–ì–ª–∞–≤–Ω–∞—è" id="home-nav-button">üè†</button> <button class="nav-button" title="–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä">üéÆ</button> <button class="nav-button" title="–ò–∑–±—Ä–∞–Ω–Ω–æ–µ">‚≠ê</button> </div>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ª—é–±–∏–º—ã—Ö –∏–≥—Ä..." />
            <button class="search-button">üîç</button>
        </div>

        <div id="main-content">
            <div class="categories">
                <div class="category-card" id="top-games-btn"> <div class="category-icon">üèÜ</div> <h3 class="category-title">–¢–û–ü –ò–ì–†</h3> </div>
                <div class="category-card" id="alpha-sort-btn"> <div class="category-icon">üî§</div> <h3 class="category-title">–ü–û –ê–õ–§–ê–í–ò–¢–£</h3> </div>
                <div class="category-card" id="random-btn"> <div class="category-icon">üé≤</div> <h3 class="category-title">–°–õ–£–ß–ê–ô–ù–ê–Ø</h3> </div>
                <div class="category-card" id="popular-btn"> <div class="category-icon">üìä</div> <h3 class="category-title">–ü–û–ü–£–õ–Ø–†–ù–´–ï</h3> </div>
                <div class="category-card" id="recent-games-btn"> <div class="category-icon">üîÑ</div> <h3 class="category-title">–ù–ï–î–ê–í–ù–ò–ï</h3> </div>
                <div class="category-card" id="share-btn"> <div class="category-icon">üì±</div> <h3 class="category-title">–ü–û–î–ï–õ–ò–¢–¨–°–Ø</h3> </div>
            </div>

            <div class="retro-hits">
                <h2 class="retro-hits-title">8-BIT –•–ò–¢–´</h2>
                <div class="retro-games-grid" id="retro-games-grid"></div>
            </div>

            <div class="rom-upload">
                <h2 class="rom-upload-title">–ó–ê–ì–†–£–ó–ò–¢–¨ ROM</h2>
                <div class="upload-box" id="upload-box">
                    <input type="file" id="fileInput" accept=".nes,.fds,.unif,.unf" class="file-input">
                    <div class="upload-text"> <strong>–ó–∞–≥—Ä—É–∑–∏—Ç–µ ROM-—Ñ–∞–π–ª</strong> –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∑–¥–µ—Å—å </div>
                </div>
            </div>

            <div class="featured-games">
                 <div class="featured-card"> <div class="featured-content"> <h3 class="featured-title">–ü–†–û–î–û–õ–ñ–ò–¢–¨ –ò–ì–†–£</h3> <img src="data/img/next.png" alt="–ü–†–û–î–û–õ–ñ–ò–¢–¨ –ò–ì–†–£" class="featured-image"> </div> <button class="arrow-button">‚Üí</button> </div>
                 <div class="featured-card" id="catalog-btn"> <div class="featured-content"> <h3 class="featured-title">–ö–ê–¢–ê–õ–û–ì –ò–ì–†</h3> <img src="data/img/catalog.png" alt="Dendy –∫–∞—Ç–∞–ª–æ–≥" class="featured-image"> </div> <button class="arrow-button">‚Üí</button> </div>
            </div>

            <div class="news-banner">
                 <div class="news-content"> <div class="news-icon">üì∞</div> <div class="news-text"> <h3 class="news-title">–ù–û–í–û–°–¢–ò –ò –û–ë–ù–û–í–õ–ï–ù–ò–Ø</h3> <p class="news-description">–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∏ –Ω–æ–≤—ã–º–∏ –∏–≥—Ä–∞–º–∏ –≤ –Ω–∞—à–µ–º –∫–∞–Ω–∞–ª–µ!</p> </div> <button class="arrow-button">‚Üí</button> </div>
            </div>
        </div> <div id="search-results-area" class="hidden"></div>

   </div> <div id="search-results-area" class="hidden"></div>

   <div id="game-page-area" class="hidden">
   </div>
   <div id="display" class="hidden"> <div id="game"></div> </div>

        <div id="display" class="hidden"> <div id="game"></div> </div>
    </div> <button id="backButton">&#10229;</button>
    <button id="reloadEmulatorButton">‚Üª</button>

    <div id="orientationMessage"> <button id="startPlayButton">–ù–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å</button> <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"> <path d="M17 2H7C5.9 2 5 2.9 5 4v16c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"></path> <path d="M12 18h.01"></path> </svg> <h2 style="margin: 15px 0;">–î–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞</h2> <p style="font-size: 16px; margin: 0 0 20px 0;">–ü–æ–≤–µ—Ä–Ω–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ</p> </div>
    <div id="loadingState" class="loading-state"> <div class="loading-spinner"></div> <p>–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —ç–º—É–ª—è—Ç–æ—Ä–∞...</p> </div>
    <div id="loadingIndicator" class="loading-indicator"></div>

    <script>
        const enableDebug = false; const enableThreads = false; const defaultCore = "nes";
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        document.addEventListener('DOMContentLoaded', function() {
            // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            const fileInput = document.getElementById('fileInput'); const uploadBox = document.getElementById('upload-box'); const display = document.getElementById('display'); const backButton = document.getElementById('backButton'); const reloadEmulatorButton = document.getElementById('reloadEmulatorButton'); const startPlayButton = document.getElementById('startPlayButton'); const orientationMessage = document.getElementById('orientationMessage'); const loadingState = document.getElementById('loadingState'); const mainContent = document.getElementById('main-content'); const initialRetroGamesGrid = document.getElementById('retro-games-grid'); const searchInput = document.querySelector('.search-input'); const searchButton = document.querySelector('.search-button'); const searchResultsArea = document.getElementById('search-results-area');
            const recentGamesButton = document.getElementById('recent-games-btn'); const homeNavButton = document.getElementById('home-nav-button'); const shareButton = document.getElementById('share-btn');
            const alphaSortButton = document.getElementById('alpha-sort-btn'); const catalogButton = document.getElementById('catalog-btn');
            const popularButton = document.getElementById('popular-btn');
            const randomButton = document.getElementById('random-btn'); // --- –°–õ–£–ß–ê–ô–ù–ê–Ø –ò–ì–†–ê ---
            const topGamesButton = document.getElementById('top-games-btn'); // --- –¢–û–ü –ò–ì–† ---

            // –°–ø–∏—Å–æ–∫ –∏–≥—Ä –¥–ª—è "8-BIT –•–ò–¢–´"
            const libraryGames = [
                { id: "mario", title: "Super Mario Bros", romUrl: "roms/Mario.nes" }, 
                { id: "contra", title: "Contra", romUrl: "roms/Contra.nes" }, 
                { id: "battle_city", title: "Battle City", romUrl: "roms/Battle City.nes" }, 
                { id: "duck_hunt", title: "Duck Hunt", romUrl: "roms/Duck Hunt.nes" }, 
                { id: "tetris", title: "Tetris", romUrl: "roms/Tetris.nes" }, 
                { id: "ninja_gaiden", title: "Ninja Gaiden", romUrl: "roms/Ninja Gaiden.nes" }
            ];

            // --- –ö–ê–¢–ê–õ–û–ì –ò–ì–† ---
            const generateId = (filename) => { 
                let namePart = filename.split('.').slice(0, -1).join('.'); 
                return namePart.toLowerCase().replace(/[^a-z0-9_]/g, '_').replace(/_+/g, '_'); 
            };

            const gameDetailsData = {
    // --- –≠–∫—à–µ–Ω (Action) ---
    "Teenage Mutant Ninja Turtles III: The Manhattan Project": { genre: "–≠–∫—à–µ–Ω", description: "–ß–µ—Ä–µ–ø–∞—Ö–∏ —Å–Ω–æ–≤–∞ –≤ –¥–µ–ª–µ! –°–ø–∞—Å–∏ –ù—å—é-–ô–æ—Ä–∫ –æ—Ç –∑–ª–æ–¥–µ—è –®—Ä–µ–¥–¥–µ—Ä–∞ –∏ –µ–≥–æ –∞—Ä–º–∏–∏. –ò–≥—Ä–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤ —Å –¥–∏–Ω–∞–º–∏—á–Ω—ã–º –≥–µ–π–º–ø–ª–µ–µ–º, —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ –≤—Ä–∞–≥–∞–º–∏ –∏ –±–æ—Å—Å–∞–º–∏." },
    "Battletoads & Double Dragon: The Ultimate Team": { genre: "–≠–∫—à–µ–Ω", description: "–ö—Ä—É—Ç–æ–π –∫—Ä–æ—Å—Å–æ–≤–µ—Ä –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã—Ö –≥–µ—Ä–æ–µ–≤! –°—Ä–∞–∂–∞–π—Å—è –ø—Ä–æ—Ç–∏–≤ –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –∑–ª–æ–¥–µ–µ–≤, –∏—Å–ø–æ–ª—å–∑—É—è –º–æ—â–Ω—ã–µ —É–¥–∞—Ä—ã –∏ –∫–æ–º–±–æ. –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π –∏ —è—Ä–∫–∞—è –≥—Ä–∞—Ñ–∏–∫–∞." },
    "Battletoads (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–≠–∫—à–µ–Ω", description: "–ó–Ω–∞–º–µ–Ω–∏—Ç—ã–µ –±–æ–µ–≤—ã–µ –∂–∞–±—ã –∏–¥—É—Ç –Ω–∞ –±–æ–π —Å–æ –∑–ª–æ–º! –≠–∫—à–µ–Ω —Å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏, —Å–ª–æ–∂–Ω—ã–º–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞–º–∏ –∏ –Ω–∞–ø—Ä—è–∂—ë–Ω–Ω—ã–º –≥–µ–π–º–ø–ª–µ–µ–º. –ò–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è –∏–≥—Ä—ã –≤–¥–≤–æ—ë–º." },
    "Bucky O'Hare": { genre: "–≠–∫—à–µ–Ω", description: "–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –∫—Ä–æ–ª–∏–∫ –ë–∞–∫–∏ –∏ –µ–≥–æ –∫–æ–º–∞–Ω–¥–∞ –≤ –æ–ø–∞—Å–Ω–æ–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–∏! –°–ª–æ–∂–Ω—ã–µ —É—Ä–æ–≤–Ω–∏, —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –≥–µ—Ä–æ–∏ –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π —Å—é–∂–µ—Ç –¥–µ–ª–∞—é—Ç –∏–≥—Ä—É –∫—É–ª—å—Ç–æ–≤–æ–π." },
    "Captain America and the Avengers": { genre: "–≠–∫—à–µ–Ω", description: "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ –∫–æ–º–∞–Ω–¥–µ –ú—Å—Ç–∏—Ç–µ–ª–µ–π –∏ —Å–ø–∞—Å–∏ –º–∏—Ä –æ—Ç —Å—É–ø–µ—Ä–∑–ª–æ–¥–µ–µ–≤. –ò–≥—Ä–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ –∞–∫—Ç–∏–≤–Ω—ã–º —ç–∫—à–µ–Ω–æ–º." },
    "Contra Force": { genre: "–≠–∫—à–µ–Ω", description: "–ó–Ω–∞–º–µ–Ω–∏—Ç–∞—è —Å–µ—Ä–∏—è Contra –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è! –£–Ω–∏—á—Ç–æ–∂–∞–π –≤—Ä–∞–≥–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã –æ—Ä—É–∂–∏—è –∏ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–π –¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–∞–Ω–¥—ã –±–æ–π—Ü–æ–≤." },
    "Jackal": { genre: "–≠–∫—à–µ–Ω", description: "–í–æ–µ–Ω–Ω—ã–π —ç–∫—à–µ–Ω, –≥–¥–µ —Ç—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å –¥–∂–∏–ø–æ–º –∏ —Å–ø–∞—Å–∞–µ—à—å –∑–∞–ª–æ–∂–Ω–∏–∫–æ–≤. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Ä–∞–≥–æ–≤ –∏ –Ω–µ–ø—Ä–æ—Å—Ç—ã–µ –º–∏—Å—Å–∏–∏ –¥–µ–ª–∞—é—Ç –∏–≥—Ä—É —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π –∏ –¥–∏–Ω–∞–º–∏—á–Ω–æ–π." },
    "Monster in My Pocket": { genre: "–≠–∫—à–µ–Ω", description: "–°—Ä–∞–∂–µ–Ω–∏—è –º–∏–Ω–∏–∞—Ç—é—Ä–Ω—ã—Ö –º–æ–Ω—Å—Ç—Ä–æ–≤ –≤ –æ–±—ã—á–Ω–æ–º –¥–æ–º–µ! –î–∏–Ω–∞–º–∏—á–Ω—ã–π —ç–∫—à–µ–Ω —Å —è—Ä–∫–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º —É—Ä–æ–≤–Ω–µ–π." },
    "RoboCop": { genre: "–≠–∫—à–µ–Ω", description: "–ó–Ω–∞–º–µ–Ω–∏—Ç—ã–π —Ä–æ–±–æ—Ç-–ø–æ–ª–∏—Ü–µ–π—Å–∫–∏–π –±–æ—Ä–µ—Ç—Å—è —Å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é. –°—É—Ä–æ–≤—ã–µ —Å—Ä–∞–∂–µ–Ω–∏—è, –∂–µ—Å—Ç–æ–∫–∏–µ –≤—Ä–∞–≥–∏ –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏." },
    "RoboCop 2": { genre: "–≠–∫—à–µ–Ω", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –±–æ—Ä—å–±—ã –†–æ–±–æ–∫–æ–ø–∞ —Å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é. –ù–æ–≤—ã–µ –≤—Ä–∞–≥–∏ –∏ —É—Ä–æ–≤–Ω–∏." },
    "RoboCop 3": { genre: "–≠–∫—à–µ–Ω", description: "–†–æ–±–æ–∫–æ–ø —Å–Ω–æ–≤–∞ –Ω–∞ —Å—Ç—Ä–∞–∂–µ –∑–∞–∫–æ–Ω–∞. –¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å —Å–∞–≥–∏ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π –∏ –≥–µ–π–º–ø–ª–µ–µ–º." },
    "Shadow of the Ninja": { genre: "–≠–∫—à–µ–Ω", description: "–≠–∫—à–µ–Ω –æ –±–µ—Å—Å—Ç—Ä–∞—à–Ω—ã—Ö –Ω–∏–Ω–¥–∑—è, —Å—Ä–∞–∂–∞—é—â–∏—Ö—Å—è –ø—Ä–æ—Ç–∏–≤ —Å–∏–ª –∑–ª–∞. –û—Ç–ª–∏—á–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞, –ø–ª–∞–≤–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–µ —É—Ä–æ–≤–Ω–∏." },
    "Silkworm": { genre: "–≠–∫—à–µ–Ω", description: "–î–∏–Ω–∞–º–∏—á–Ω—ã–π —ç–∫—à–µ–Ω —Å –≤–µ—Ä—Ç–æ–ª—ë—Ç–æ–º –∏ –¥–∂–∏–ø–æ–º, —Å—Ä–∞–∂–∞—é—â–∏–º–∏—Å—è –ø—Ä–æ—Ç–∏–≤ –±–µ—Å—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤. –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤." },
    "Super C (Super Contra)": { genre: "–≠–∫—à–µ–Ω", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–π Contra —Å –µ—â—ë –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤—Ä–∞–≥–æ–≤, –æ—Ä—É–∂–∏—è –∏ —ç–ø–∏—á–Ω—ã—Ö –±–æ—Å—Å–æ–≤." },
    "Tokkyuu Shirei Solbrain": { genre: "–≠–∫—à–µ–Ω", description: "–Ø–ø–æ–Ω—Å–∫–∏–π —Å—É–ø–µ—Ä–≥–µ—Ä–æ–π —Å–ø–∞—Å–∞–µ—Ç –≥–æ—Ä–æ–¥ –æ—Ç –∑–ª–æ–¥–µ–µ–≤. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —ç–∫—à–µ–Ω –≤ –ª—É—á—à–∏—Ö —Ç—Ä–∞–¥–∏—Ü–∏—è—Ö —è–ø–æ–Ω—Å–∫–∏—Ö –±–æ–µ–≤–∏–∫–æ–≤." },
    "S.C.A.T.: Special Cybernetic Attack Team": { genre: "–≠–∫—à–µ–Ω", description: "–õ–µ—Ç–∞—é—â–∏–π —ç–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä (Final Mission)." }, // –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Final Mission.nes
    "Alien 3": { genre: "–≠–∫—à–µ–Ω", description: "–≠–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä –ø–æ –º–æ—Ç–∏–≤–∞–º —Ñ–∏–ª—å–º–∞ –ß—É–∂–æ–π 3. –°–ª–æ–∂–Ω—ã–µ –ª–∞–±–∏—Ä–∏–Ω—Ç—ã –∏ –æ–ø–∞—Å–Ω—ã–µ –∫—Å–µ–Ω–æ–º–æ—Ä—Ñ—ã."},

    // --- –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è (Adventure) ---
    "Adventure Island": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í–µ—Å—ë–ª—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –ø–∞—Ä–Ω—è –≤ —à–∞–ø–æ—á–∫–µ, —Å—Ä–∞–∂–∞—é—â–µ–≥–æ—Å—è —Å –º–æ–Ω—Å—Ç—Ä–∞–º–∏ –Ω–∞ –æ—Å—Ç—Ä–æ–≤–µ. –ü—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –º–Ω–æ–≥–æ —É—Ä–æ–≤–Ω–µ–π –∏ —è—Ä–∫–∞—è –≥—Ä–∞—Ñ–∏–∫–∞." },
    "Adventure Island II": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ –æ—Å—Ç—Ä–æ–≤–µ —Å –Ω–æ–≤—ã–º–∏ –¥–∏–Ω–æ–∑–∞–≤—Ä–∞–º–∏-–ø–æ–º–æ—â–Ω–∏–∫–∞–º–∏." },
    "Adventure Island III": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å —Å –µ—â—ë –±–æ–ª—å—à–∏–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º —É—Ä–æ–≤–Ω–µ–π –∏ –≤—Ä–∞–≥–æ–≤." },
    "Adventure Island IV": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ß–µ—Ç–≤—ë—Ä—Ç–∞—è —á–∞—Å—Ç—å, –≤—ã–ø—É—â–µ–Ω–Ω–∞—è —Ç–æ–ª—å–∫–æ –≤ –Ø–ø–æ–Ω–∏–∏, —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ RPG." },
    "Chip 'n Dale: Rescue Rangers (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ß–∏–ø –∏ –î–µ–π–ª –≤ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö! –£–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π, –∫–æ–º–∞–Ω–¥–Ω–∞—è –∏–≥—Ä–∞ –∏ –º–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω—è—Ö." },
    "Chip 'n Dale: Rescue Rangers 2 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Shedevr)": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π —Å–ø–∞—Å–∞—Ç–µ–ª–µ–π —Å –Ω–æ–≤—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏." },
    "Darkwing Duck": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ß—ë—Ä–Ω—ã–π –ø–ª–∞—â –≤—ã—Ö–æ–¥–∏—Ç –Ω–∞ –∑–∞—â–∏—Ç—É –≥–æ—Ä–æ–¥–∞ –æ—Ç –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤. –Ø—Ä–∫–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏ —É–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ." },
    "Duck Tales": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–î—è–¥—é—à–∫–∞ –°–∫—Ä—É–¥–∂ –∏ –æ—Ö–æ—Ç–∞ –∑–∞ —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É. –ö—Ä–∞—Å–∏–≤—ã–µ —É—Ä–æ–≤–Ω–∏, —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–µ–∫—Ä–µ—Ç–æ–≤." }, // –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è onlain-igrok.rf_23573.nes
    "DuckTales 2": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ—Ö–æ—Ç—ã –°–∫—Ä—É–¥–∂–∞ –∑–∞ —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏ —Å –Ω–æ–≤—ã–º–∏ –ª–æ–∫–∞—Ü–∏—è–º–∏." },
    "Felix the Cat": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í–µ—Å—ë–ª–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –∫–æ—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –§–µ–ª–∏–∫—Å–∞, —á—Ç–æ–±—ã –ø—Ä–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –≤—Å–µ —É—Ä–æ–≤–Ω–∏." },
    "Prince of Persia (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∞, –ø–æ–ª–Ω—ã–π –ª–æ–≤—É—à–µ–∫ –∏ –æ–ø–∞—Å–Ω–æ—Å—Ç–µ–π. –û—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –∑–∞–≥–∞–¥–∫–∞–º–∏." },
    "TaleSpin": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ë–∞–ª–ª—É –∏ –µ–≥–æ –≤–æ–∑–¥—É—à–Ω—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è. –ü–æ–ª—ë—Ç—ã, —Å—Ä–∞–∂–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –º–∏—Å—Å–∏–∏ –≤ –º–∏—Ä–µ –º—É–ª—å—Ç—Å–µ—Ä–∏–∞–ª–∞." },
    "The Flintstones: The Rescue of Dino & Hoppy": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–§–ª–∏–Ω—Å—Ç–æ—É–Ω—ã –≤ –¥–æ–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö. –í–µ—Å—ë–ª—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏ –∏ —É—Ä–æ–≤–Ω–∏." },
    "The Flintstones: Surprise at Dinosaur Peak": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π –§–ª–∏–Ω—Å—Ç–æ—É–Ω–æ–≤ —Å –Ω–æ–≤—ã–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏." },
    "Tiny Toon Adventures": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ó–∞–±–∞–≤–Ω—ã–µ –º—É–ª—å—Ç–≥–µ—Ä–æ–∏ Tiny Toon –≤ –≤–µ—Å—ë–ª—ã—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö. –Ø—Ä–∫–∏–π –º–∏—Ä, —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏ –ø—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ." },
    "Tiny Toon Adventures 2: Trouble in Wackyland": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π Tiny Toon –≤ –ø–∞—Ä–∫–µ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π Wackyland." },
    "Tom and Jerry (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í–µ—Å—ë–ª–æ–µ –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è–Ω–∏–µ –¢–æ–º–∞ –∏ –î–∂–µ—Ä—Ä–∏. –ü—Ä–æ–π–¥–∏—Ç–µ –≤—Å–µ —É—Ä–æ–≤–Ω–∏, –∏–∑–±–µ–≥–∞—è –ª–æ–≤—É—à–µ–∫ –∏ –≤—Ä–∞–≥–æ–≤." },

    // --- –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä—ã –∏ –≠–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä—ã ---
    "Batman": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ì–æ—Ç—ç–º –≤ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏! –£–ø—Ä–∞–≤–ª—è–π –ë—ç—Ç–º–µ–Ω–æ–º, –ø—Ä–æ—Ö–æ–¥–∏ —Å–ª–æ–∂–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏ —Å—Ä–∞–∂–∞–π—Å—è —Å –∫—É–ª—å—Ç–æ–≤—ã–º–∏ –∑–ª–æ–¥–µ—è–º–∏." },
    "Batman Returns": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ë–∏—Ç–≤–∞ –ë—ç—Ç–º–µ–Ω–∞ –ø—Ä–æ—Ç–∏–≤ –ü–∏–Ω–≥–≤–∏–Ω–∞ –∏ –ñ–µ–Ω—â–∏–Ω—ã-–∫–æ—à–∫–∏ –ø–æ –º–æ—Ç–∏–≤–∞–º —Ñ–∏–ª—å–º–∞." },
    "Castlevania": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è —Å–µ–º—å–∏ –ë–µ–ª—å–º–æ–Ω—Ç–æ–≤, —Å—Ä–∞–∂–∞—é—â–∏—Ö—Å—è —Å –î—Ä–∞–∫—É–ª–æ–π. –ú—Ä–∞—á–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞, —Å–ª–æ–∂–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏ –∫—É–ª—å—Ç–æ–≤—ã–π —Å–∞—É–Ω–¥—Ç—Ä–µ–∫." },
    "Castlevania II: Simon's Quest": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ RPG –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º –º–∏—Ä–∞." },
    "Castlevania III: Dracula's Curse": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ü—Ä–∏–∫–≤–µ–ª —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–º–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏." },
    "Mega Man": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–°–µ—Ä–∏—è –∏–≥—Ä –ø—Ä–æ –æ—Ç–≤–∞–∂–Ω–æ–≥–æ —Ä–æ–±–æ—Ç–∞. –°—Ä–∞–∂–∞–π—Å—è —Å –±–æ—Å—Å–∞–º–∏, —É–ª—É—á—à–∞–π –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–æ—Ö–æ–¥–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–µ —É—Ä–æ–≤–Ω–∏." },
    "Mega Man 2": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π –ú–µ–≥–∞–º–µ–Ω–∞ —Å –Ω–æ–≤—ã–º–∏ –±–æ—Å—Å–∞–º–∏ –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏." },
    "Mega Man 3": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ú–µ–≥–∞–º–µ–Ω 3 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –†–∞—à–∞ - –≤–µ—Ä–Ω–æ–≥–æ –ø—Å–∞-–ø–æ–º–æ—â–Ω–∏–∫–∞." },
    "Mega Man 4": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ù–æ–≤—ã–π –∑–ª–æ–¥–µ–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Ä—è–∂–∞—Ç—å –≤—ã—Å—Ç—Ä–µ–ª –ú–µ–≥–∞ –ë–∞—Å—Ç–µ—Ä–∞." },
    "Mega Man 5": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ë—Ä–∞—Ç –ú–µ–≥–∞–º–µ–Ω–∞ - –ü—Ä–æ—Ç–æ–º–µ–Ω - –ø–æ—Ö–∏—â–∞–µ—Ç –¥–æ–∫—Ç–æ—Ä–∞ –õ–∞–π—Ç–∞." },
    "Mega Man 6": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ú–µ–≥–∞–º–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã –†–∞—à–∞ –¥–ª—è –ø–æ–ª—ë—Ç–∞ –∏ –º–æ—â–Ω–æ–≥–æ —É–¥–∞—Ä–∞." },
    "Teenage Mutant Ninja Turtles (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ü–µ—Ä–≤–∞—è –∏–≥—Ä–∞ –ø—Ä–æ —á–µ—Ä–µ–ø–∞—à–µ–∫ –Ω–∞ NES. –°–ª–æ–∂–Ω—ã–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä —Å –≤–∏–¥–æ–º —Å–±–æ–∫—É –∏ —Å–≤–µ—Ä—Ö—É." },
    "Teenage Mutant Ninja Turtles II: The Arcade Game": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ü–æ—Ä—Ç –∞—Ä–∫–∞–¥–Ω–æ–π –∏–≥—Ä—ã –≤ –∂–∞–Ω—Ä–µ Beat 'em up. –°—Ä–∞–∂–∞–π—Å—è —Å –∫–ª–∞–Ω–æ–º –§—É—Ç –≤–¥–≤–æ—ë–º!" },
    "Teenage Mutant Ninja Turtles: Tournament Fighters": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–§–∞–π—Ç–∏–Ω–≥ –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π —á–µ—Ä–µ–ø–∞—à–µ–∫-–Ω–∏–Ω–¥–∑—è —Å —Ä–∞–∑–Ω—ã–º–∏ –±–æ–π—Ü–∞–º–∏ –∏ –∞—Ä–µ–Ω–∞–º–∏." }, // –ü–µ—Ä–µ–Ω–µ—Å –≤ –§–∞–π—Ç–∏–Ω–≥
    "Super Mario Bros.": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä, —Å–ø–∞—Å—à–∏–π –∏–Ω–¥—É—Å—Ç—Ä–∏—é –≤–∏–¥–µ–æ–∏–≥—Ä." }, // –î–ª—è –∏–≥—Ä—ã –∏–∑ libraryGames
    "Super Mario Bros. 2 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä", description: "–ù–µ–æ–±—ã—á–Ω–∞—è —á–∞—Å—Ç—å —Å–µ—Ä–∏–∏ —Å –≤—ã–±–æ—Ä–æ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –º–µ—Ö–∞–Ω–∏–∫–æ–π –≤—ã–¥–µ—Ä–≥–∏–≤–∞–Ω–∏—è –æ–≤–æ—â–µ–π." },
    "Super Mario Bros. 3 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç 2R Team)": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä", description: "–û–¥–Ω–∞ –∏–∑ –ª—É—á—à–∏—Ö –∏–≥—Ä –Ω–∞ NES. –û–≥—Ä–æ–º–Ω—ã–π –º–∏—Ä, –º–Ω–æ–∂–µ—Å—Ç–≤–æ –±–æ–Ω—É—Å–æ–≤ –∏ —Å–µ–∫—Ä–µ—Ç–æ–≤." },
    "Mario Bros.": { genre: "–ê—Ä–∫–∞–¥–∞", description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∞—Ä–∫–∞–¥–∞, –≥–¥–µ –ú–∞—Ä–∏–æ –∏ –õ—É–∏–¥–∂–∏ —Å—Ä–∞–∂–∞—é—Ç—Å—è —Å –≤—Ä–µ–¥–∏—Ç–µ–ª—è–º–∏ –≤ –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏–∏." }, // –ü–µ—Ä–µ–Ω–µ—Å –≤ –ê—Ä–∫–∞–¥—ã

    // --- –†–æ–ª–µ–≤—ã–µ –∏–≥—Ä—ã (RPG) ---
    "Final Fantasy": { genre: "RPG", description: "–ö—É–ª—å—Ç–æ–≤–∞—è —Å–µ—Ä–∏—è —Ä–æ–ª–µ–≤—ã—Ö –∏–≥—Ä —Å –≥–ª—É–±–æ–∫–∏–º —Å—é–∂–µ—Ç–æ–º, –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –±–æ—è." },
    "Final Fantasy II": { genre: "RPG", description: "–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å —Å —É–Ω–∏–∫–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–æ–∫–∞—á–∫–∏, –∑–∞–≤–∏—Å—è—â–µ–π –æ—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π." },
    "Final Fantasy III": { genre: "RPG", description: "–¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å —Å —Ä–∞–∑–≤–∏—Ç–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–π (–¥–∂–æ–±)." },

    // --- –§–∞–π—Ç–∏–Ω–≥–∏ (Fighting) ---
    "Best of the Best: Championship Karate": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–ö–∞—Ä–∞—Ç–µ-—á–µ–º–ø–∏–æ–Ω–∞—Ç, –≥–¥–µ —Ç—ã –ø—Ä–æ—Ö–æ–¥–∏—à—å –ø—É—Ç—å –æ—Ç –Ω–æ–≤–∏—á–∫–∞ –¥–æ —á–µ–º–ø–∏–æ–Ω–∞. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–µ—Ö–Ω–∏–∫ –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –±–æ–∏." },
    "Mighty Final Fight": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–ß–∏–±–∏-–≤–µ—Ä—Å–∏—è –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–≥–æ Beat 'em up Final Fight —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–∫–∞—á–∫–∏." }, // –î–æ–±–∞–≤–∏–ª –∂–∞–Ω—Ä –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
    "Double Dragon": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Beat 'em up. –ë—Ä–∞—Ç—å—è –ë–∏–ª–ª–∏ –∏ –î–∂–∏–º–º–∏ –õ–∏ —Å–ø–∞—Å–∞—é—Ç –ú—ç—Ä–∏–∞–Ω." }, // –î–æ–±–∞–≤–∏–ª –∂–∞–Ω—Ä –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
    "Double Dragon II: The Revenge": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ Beat 'em up —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∏—ë–º–∞–º–∏ –∏ —É–ª—É—á—à–µ–Ω–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π." }, // –î–æ–±–∞–≤–∏–ª –∂–∞–Ω—Ä –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
    "Double Dragon III: The Sacred Stones": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å Beat 'em up —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–∫—É–ø–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∏ –Ω–æ–≤—ã–º–∏ –±–æ–π—Ü–∞–º–∏." }, // –î–æ–±–∞–≤–∏–ª –∂–∞–Ω—Ä –∏ –æ–ø–∏—Å–∞–Ω–∏–µ

    // --- –ê—Ä–∫–∞–¥—ã –∏ –ø–∞–∑–ª—ã (Arcade, Puzzle) ---
    "Battle City": { genre: "–ê—Ä–∫–∞–¥–∞", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —Ç–∞–Ω–∫–æ–≤–∞—è –±–∞—Ç–∞–ª–∏—è. –ó–∞—â–∏—â–∞–π –±–∞–∑—É, –ø—Ä–æ–∫–∞—á–∏–≤–∞–π —Ç–∞–Ω–∫ –∏ –∏–≥—Ä–∞–π —Å –¥—Ä—É–≥–æ–º." }, // –¢–∞–∫–∂–µ –¥–ª—è 487_Tank_1990.nes
    "Bomberman": { genre: "–ê—Ä–∫–∞–¥–∞/–ü–∞–∑–ª", description: "–ü–æ–¥—Ä—ã–≤–∞–π —Å—Ç–µ–Ω—ã, —É–Ω–∏—á—Ç–æ–∂–∞–π –≤—Ä–∞–≥–æ–≤ –∏ –Ω–∞–π–¥–∏ –≤—ã—Ö–æ–¥ –∏–∑ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞. –ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∞—è –∞—Ä–∫–∞–¥–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–≥—Ä–æ–∫–æ–≤." },
    "Bomberman II": { genre: "–ê—Ä–∫–∞–¥–∞/–ü–∞–∑–ª", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ Bomberman —Å –Ω–æ–≤—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏, –≤–∫–ª—é—á–∞—è –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä." },
    "Dr. Mario (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Multisoft)": { genre: "–ü–∞–∑–ª", description: "–ó–∞—Ç—è–≥–∏–≤–∞—é—â–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞ —Å —É—á–∞—Å—Ç–∏–µ–º –ú–∞—Ä–∏–æ, –≥–¥–µ –Ω—É–∂–Ω–æ –æ—á–∏—â–∞—Ç—å —ç–∫—Ä–∞–Ω –æ—Ç –≤–∏—Ä—É—Å–æ–≤." },
    "Pac-Man": { genre: "–ê—Ä–∫–∞–¥–∞", description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∞—Ä–∫–∞–¥–∞, –≥–¥–µ –Ω—É–∂–Ω–æ —Å—ä–µ—Å—Ç—å –≤—Å–µ —Ç–æ—á–∫–∏ –∏ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–∏–∑—Ä–∞–∫–æ–≤." },
    "Lode Runner (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Multisoft)": { genre: "–ê—Ä–∫–∞–¥–∞/–ü–∞–∑–ª", description: "–£–º–Ω–∞—è –∞—Ä–∫–∞–¥–∞, –≥–¥–µ –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –∑–æ–ª–æ—Ç–æ, –∏–∑–±–µ–≥–∞—è –≤—Ä–∞–≥–æ–≤ –∏ –ª–æ–≤—É—à–µ–∫." },
    "Tetris": { genre: "–ü–∞–∑–ª", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞ —Å–æ —Å–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ–º –ø–∞–¥–∞—é—â–∏—Ö —Ñ–∏–≥—É—Ä." }, // –î–ª—è –∏–≥—Ä—ã –∏–∑ libraryGames

    // --- –°–ø–æ—Ä—Ç (Sport) ---
    "Blades of Steel": { genre: "–°–ø–æ—Ä—Ç", description: "–î–∏–Ω–∞–º–∏—á–Ω—ã–π —Ö–æ–∫–∫–µ–π —Å –¥—Ä–∞–∫–∞–º–∏ –∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω—ã–º–∏ –º–∞—Ç—á–∞–º–∏."}, // –î–æ–±–∞–≤–∏–ª

    // --- –î—Ä—É–≥–æ–µ (Other/Misc) ---
    "Duck Hunt": { genre: "–®—É—Ç–µ—Ä (Light Gun)", description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —à—É—Ç–µ—Ä –¥–ª—è —Å–≤–µ—Ç–æ–≤–æ–≥–æ –ø–∏—Å—Ç–æ–ª–µ—Ç–∞. –°—Ç—Ä–µ–ª—è–π –ø–æ —É—Ç–∫–∞–º!"}, // –î–ª—è –∏–≥—Ä—ã –∏–∑ libraryGames
    "Ninja Gaiden": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–°–ª–æ–∂–Ω—ã–π –∏ —Å—Ç–∏–ª—å–Ω—ã–π —ç–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä –ø—Ä–æ –Ω–∏–Ω–¥–∑—è –†—é –•–∞—è–±—É—Å—É."}, // –î–ª—è –∏–≥—Ä—ã –∏–∑ libraryGames
    "Contra": { genre: "–≠–∫—à–µ–Ω", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π Run and gun —à—É—Ç–µ—Ä. –°—Ä–∞–∂–∞–π—Å—è —Å –ø—Ä–∏—à–µ–ª—å—Ü–∞–º–∏ –≤ –æ–¥–∏–Ω–æ—á–∫—É –∏–ª–∏ —Å –¥—Ä—É–≥–æ–º."}, // –î–ª—è –∏–≥—Ä—ã –∏–∑ libraryGames
    "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∏–≥—Ä–∞ (–ø–∏—Ä–∞—Ç—Å–∫–∞—è —Å–±–æ—Ä–∫–∞)": { genre: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ", description: "–ü–∏—Ä–∞—Ç—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –∏–≥—Ä—ã. –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º." } // –î–ª—è onlain-igrok.rf_23573.nes (—Å—Ç–∞—Ä–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)

};
            
            const fullCatalogGames = [ 
                { filename: "teenage-manhattan.nes", title: "Teenage Mutant Ninja Turtles III: The Manhattan Project" }, 
                { filename: "487_Tank_1990.nes", title: "Battle City" }, 
                { filename: "adventure_islan.nes", title: "Adventure Island" }, 
                { filename: "adventure_islan2.nes", title: "Adventure Island II" }, 
                { filename: "adventure_islan3.nes", title: "Adventure Island III" }, 
                { filename: "adventure_islan4.nes", title: "Adventure Island IV" }, 
                { filename: "Alien 3.nes", title: "Alien 3" }, 
                { filename: "Batman Returns.nes", title: "Batman Returns" }, 
                { filename: "Batman.nes", title: "Batman" }, 
                { filename: "Battletoads and Double Dragon.nes", title: "BattletoadsDoubleDragon" }, 
                { filename: "battletoads-rus_onlain-igrok.rf_.nes", title: "Battletoadsrus" }, 
                { filename: "Best of the Best - Championship Karate.nes", title: "BBCKarate" }, 
                { filename: "Blades_of_Steel.nes", title: "BladesofSteel" }, 
                { filename: "Bomberman (U) [T-Rus] [!].nes", title: "Bomberman" }, 
                { filename: "Bomberman2.nes", title: "Bomberman II" }, 
                { filename: "Bucky O'Hare.nes", title: "BuckyOHare" }, 
                { filename: "Captain America and the Avengers.nes", title: "CaptainAmerica" }, 
                { filename: "Castlevania 2 Simon's Quest.nes", title: "Castlevania II: Simon's Quest" }, 
                { filename: "Castlevania 3 - Dracula's Curse.nes", title: "Castlevania III: Dracula's Curse" }, 
                { filename: "Castlevania.nes", title: "Castlevania" }, 
                { filename: "Chip n Dale Rescue Rangers 2 (U) [T-Rus] [!] by Shedevr.nes", title: "Chip 'n Dale: Rescue Rangers 2 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Shedevr)" }, 
                { filename: "chip-n-dale-rescue-rangers-[rus].nes", title: "Chip 'n Dale: Rescue Rangers (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" }, 
                { filename: "Contra Force.nes", title: "Contra Force" }, 
                { filename: "Darkwing_Duck-U-.nes", title: "Darkwing Duck" }, 
                { filename: "Double Dragon II - The Revenge.nes", title: "Double Dragon II: The Revenge" }, 
                { filename: "Double Dragon III - The Sacred Stones.nes", title: "Double Dragon III: The Sacred Stones" }, 
                { filename: "Double Dragon.nes", title: "Double Dragon" }, 
                { filename: "Dr. Mario (U) [!p] [T-Rus] by Multisoft.nes", title: "Dr. Mario (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Multisoft)" }, 
                { filename: "onlain-igrok.rf_23573.nes", title: "Duck Tales" },                 
                { filename: "Duck Tales 2.nes", title: "DuckTales 2" }, 
                { filename: "Felix the Cat.nes", title: "Felix the Cat" }, 
                { filename: "Final Fantasy 2.nes", title: "Final Fantasy II" }, 
                { filename: "Final Fantasy 3.nes", title: "Final Fantasy III" }, 
                { filename: "Final Fantasy.nes", title: "Final Fantasy" }, 
                { filename: "Final Mission.nes", title: "S.C.A.T.: Special Cybernetic Attack Team" }, 
                { filename: "Jackal.nes", title: "Jackal" }, 
                { filename: "Lode Runner (U) [T-Rus] by Multisoft.nes", title: "Lode Runner (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Multisoft)" }, 
                { filename: "Mario Bros.nes", title: "Mario Bros." }, 
                { filename: "Mega Man5.nes", title: "Mega Man 5" }, 
                { filename: "Megaman6.nes", title: "Mega Man 6" }, 
                { filename: "Mega_Man.nes", title: "Mega Man" }, 
                { filename: "Mega_Man2.nes", title: "Mega Man 2" }, 
                { filename: "Mega_Man3.nes", title: "Mega Man 3" }, 
                { filename: "Mega_Man4.nes", title: "Mega Man 4" }, 
                { filename: "Mighty Final Fight.nes", title: "Mighty Final Fight" }, 
                { filename: "Monster In My Pocket.nes", title: "Monster in My Pocket" }, 
                { filename: "Pac-Man.nes", title: "Pac-Man" }, 
                { filename: "prince-of-persia-rus_onlain-igrok.rf_.nes", title: "Prince of Persia (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" }, 
                { filename: "Robocop-2.nes", title: "RoboCop 2" }, 
                { filename: "Robocop-3.nes", title: "RoboCop 3" }, 
                { filename: "RoboCop.nes", title: "RoboCop" }, 
                { filename: "shadow of the ninja.nes", title: "Shadow of the Ninja" }, 
                { filename: "Silkworm.nes", title: "Silkworm" }, 
                { filename: "Super Contra.nes", title: "Super C (Super Contra)" }, 
                { filename: "super-mario-bros.-2-rus.nes", title: "Super Mario Bros. 2 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" }, 
                { filename: "super-mario-bros.-3-e-t-rus-by-2r-team-2r-team.nes", title: "Super Mario Bros. 3 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç 2R Team)" }, 
                { filename: "TaleSpin.nes", title: "TaleSpin" }, 
                { filename: "teenage-mutant-ninja-turtles-ii-the-arcade-game.nes", title: "Teenage Mutant Ninja Turtles II: The Arcade Game" }, 
                { filename: "teenage-mutant-ninja-turtles-rus.nes", title: "Teenage Mutant Ninja Turtles (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" }, 
                { filename: "teenage-mutant-ninja-turtles-tournament-fighters.nes", title: "Teenage Mutant Ninja Turtles: Tournament Fighters" }, 
                { filename: "The Flintstones - The Rescue of Dino & Hoppy.nes", title: "The Flintstones: The Rescue of Dino & Hoppy" }, 
                { filename: "The Flintstones 2 - The Surprise at Dinosaur Peak.nes", title: "The Flintstones: Surprise at Dinosaur Peak" }, 
                { filename: "Tiny Toon Adventures 2.nes", title: "Tiny Toon Adventures 2: Trouble in Wackyland" }, 
                { filename: "Tiny_Toon_Adventures-U-.nes", title: "Tiny Toon Adventures" }, 
                { filename: "Tokkyuu Shirei - Solbrain.nes", title: "Tokkyuu Shirei Solbrain" }, 
                { filename: "tom-jerry-u-p1trus_onlain-igrok.rf_.nes", title: "Tom and Jerry (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" } 
            ].map(game => ({ ...game, id: generateId(game.filename) }));


// –¢–µ–ø–µ—Ä—å –æ–±–æ–≥–∞—â–∞–µ–º fullCatalogGames
const enrichedFullCatalogGames = fullCatalogGames.map(game => {
    const details = gameDetailsData[game.title] || gameDetailsData[game.title.replace(" (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)", "")] || {}; // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –ø–æ —Ç–æ—á–Ω–æ–º—É –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –±–µ–∑ "(–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)"
    // –û—Å–æ–±—ã–π —Å–ª—É—á–∞–π –¥–ª—è Battle City / Tank 1990
    if (game.id === '487_tank_1990') {
        const detailsBC = gameDetailsData["Battle City"];
        return {
            ...game,
            genre: detailsBC?.genre || '–ê—Ä–∫–∞–¥–∞',
            description: detailsBC?.description || '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —Ç–∞–Ω–∫–æ–≤–∞—è –±–∞—Ç–∞–ª–∏—è.'
        };
    }
     // –û—Å–æ–±—ã–π —Å–ª—É—á–∞–π –¥–ª—è S.C.A.T. / Final Mission
    if (game.id === 'final_mission') {
        const detailsSCAT = gameDetailsData["S.C.A.T.: Special Cybernetic Attack Team"];
        return {
            ...game,
            genre: detailsSCAT?.genre || '–≠–∫—à–µ–Ω',
            description: detailsSCAT?.description || '–õ–µ—Ç–∞—é—â–∏–π —ç–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä.'
        };
    }
    // –û—Å–æ–±—ã–π —Å–ª—É—á–∞–π –¥–ª—è Super C / Super Contra
    if (game.id === 'super_contra') {
        const detailsSuperC = gameDetailsData["Super C (Super Contra)"];
        return {
            ...game,
            genre: detailsSuperC?.genre || '–≠–∫—à–µ–Ω',
            description: detailsSuperC?.description || '–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–π Contra.'
        };
    }

    return {
        ...game,
        genre: details.genre || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
        description: details.description || '–û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —ç—Ç–æ–π –∏–≥—Ä—ã –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ.'
    };
});

// –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–π –º–∞—Å—Å–∏–≤ –Ω–∞ –Ω–æ–≤—ã–π, –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–π
window.fullCatalogGames = enrichedFullCatalogGames;

// --- –ö–û–ù–ï–¶ –î–û–ë–ê–í–õ–ï–ù–ò–Ø –î–ê–ù–ù–´–• ---

// –°–ø–∏—Å–æ–∫ –∏–≥—Ä –¥–ª—è "8-BIT –•–ò–¢–´" - —Ç–æ–∂–µ –æ–±–æ–≥–∞—Ç–∏–º –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
const enrichedLibraryGames = libraryGames.map(game => {
    const details = gameDetailsData[game.title] || {};
     return {
        ...game,
        genre: details.genre || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
        description: details.description || '–û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —ç—Ç–æ–π –∏–≥—Ä—ã –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ.'
     };
});
window.libraryGames = enrichedLibraryGames; // –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–¥–µ-—Ç–æ –µ—â–µ

// --- –ö–û–ù–ï–¶ –û–ë–û–ì–ê–©–ï–ù–ò–Ø libraryGames ---



            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∏–≥—Ä—ã (–∏–∑ —Ö–∏—Ç–æ–≤ –∏–ª–∏ –∫–∞—Ç–∞–ª–æ–≥–∞) –ø–æ ID
            const findGameDataById = (id) => libraryGames.find(g => g.id === id) || fullCatalogGames.find(g => g.id === id);

            // --- –ü–û–ü–£–õ–Ø–†–ù–´–ï –ò–ì–†–´ (–û–±–Ω–æ–≤–ª–µ–Ω–æ) ---
            const popularGameIds = [ 
                'battletoads_and_double_dragon', 
                'teenage-manhattan',
                'tiny_toon_adventures_u_', 
                'chip_n_dale_rescue_rangers_rus_', 
                'dr_mario_u_p_t_rus_by_multisoft', 
                'mega_man', 
                'pac_man' 
            ];
            const popularGamesList = popularGameIds.map(findGameDataById)
                                                 .filter(Boolean) // –£–±–∏—Ä–∞–µ–º –Ω–µ–Ω–∞–π–¥–µ–Ω–Ω—ã–µ
                                                 // –î–æ–±–∞–≤–ª—è–µ–º romUrl –¥–ª—è –∏–≥—Ä –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞
                                                 .map(g => ({ ...g, romUrl: g.romUrl || `roms/catalog/${g.filename}` }));

            // --- –¢–û–ü –ò–ì–† ---
            const topGameIds = [ 
                'battletoads_and_double_dragon', 
                'chip_n_dale_rescue_rangers_rus_', 
                'felix_the_cat', 
                'mario_bros', 
                '487_tank_1990', 
                'teenage_mutant_ninja_turtles_rus', 
                'teenage_mutant_ninja_turtles_ii_the_arcade_game', 
                'tom_jerry_u_p1trus_onlain_igrok_rf_', 
                'robocop' 
            ];
            const topGamesList = topGameIds.map(findGameDataById)
                                           .filter(Boolean)
                                           .map(g => ({ ...g, romUrl: g.romUrl || `roms/catalog/${g.filename}` }));


            window.orientationShown = false; 
            window.currentRomUrl = null; 
            window.currentGameName = null; 
            window.isEmulatorActive = false;

            const imageMap = { 
    "teenage_manhattan": "manhattan.webp",
    "487_tank_1990": "battlecity.webp",
    "adventure_islan": "adventure_island1.webp",
    "adventure_islan2": "adventure_islan2.webp",
    "adventure_islan3": "adventure_islan3.webp",
    "adventure_islan4": "adventure_islan4.webp",
    "alien_3": "Alien 3.webp",
    "batman_returns": "Batman Returns.webp",
    "batman": "Batman.webp",
    "battletoads_and_double_dragon": "BattletoadsDoubleDragon.webp",
    "battletoads_rus_onlain_igrok_rf_": "Battletoadsrus.webp",
    "best_of_the_best_championship_karate": "BBCKarate.webp",
    "blades_of_steel": "BladesofSteel.webp",
    "bomberman_u_t_rus_": "Bomberman.webp",
    "bomberman2": "Bomberman2.webp",
    "bucky_o_hare": "BuckyOHare.webp",
    "captain_america_and_the_avengers": "CaptainAmerica.webp",
    "castlevania_2_simon_s_quest": "Castlevania2.webp",
    "castlevania_3_dracula_s_curse": "Castlevania3.webp",
    "castlevania": "Castlevania.webp",
    "chip_n_dale_rescue_rangers_2_u_t_rus_by_shedevr": "Chip2.webp",
    "chip_n_dale_rescue_rangers_rus_": "chipr.webp",
    "contra_force": "contra_force.webp",
    "darkwing_duck_u_": "darkwing_duck_u.webp",
    "double_dragon_ii_the_revenge": "double_dragon_revenge.webp",
    "double_dragon_iii_the_sacred_stones": "DoubleDragonSacred.webp",
    "double_dragon": "DoubleDragon.webp",
    "dr_mario_u_p_t_rus_by_multisoft": "dr_mario.webp",
    "onlain_igrok_rf_23573": "dt2.webp",
    "duck_tales_2": "DuckTales2.webp",
    "felix_the_cat": "felix_the_cat.webp",
    "final_fantasy_2": "final_fantasy_2.webp",
    "final_fantasy_3": "final_fantasy_3.webp",
    "final_fantasy": "final_fantasy.webp",
    "final_mission": "final_mission.webp",
    "jackal": "Jackal.webp",
    "lode_runner_u_t_rus_by_multisoft": "lode_runner.webp",
    "mario_bros": "mario_bros.webp",
    "mega_man5": "mega_man5.webp",
    "megaman6": "megaman6.webp",
    "mega_man": "mega_man.webp",
    "mega_man2": "Mega_Man2.webp",
    "mega_man3": "Mega_Man3.webp",
    "mega_man4": "Mega_Man4.webp",
    "mighty_final_fight": "mighty_final_fight.webp",
    "monster_in_my_pocket": "monster_in_my_pocket.webp",
    "pac_man": "pac_man.webp",
    "prince_of_persia_rus_onlain_igrok_rf_": "prince_of_persia.webp",
    "robocop_2": "robocop_2.webp",
    "robocop_3": "robocop_3.webp",
    "robocop": "robocop.webp",
    "shadow_of_the_ninja": "shadow_of_the_ninja.webp",
    "silkworm": "silkworm.webp",
    "super_contra": "super_contra.webp",
    "super_mario_bros_2_rus": "super_mario_bros_2_rus.webp",
    "super_mario_bros_3_e_t_rus_by_2r_team_2r_team": "super_mario_bros_3.webp",
    "talespin": "talespin.webp",
    "teenage_mutant_ninja_turtles_ii_the_arcade_game": "teenagemutantarcade.webp",
    "teenage_mutant_ninja_turtles_rus": "teenagemutant.webp",
    "teenage_mutant_ninja_turtles_tournament_fighters": "teenagemutantfighters.webp",
    "the_flintstones_the_rescue_of_dino_hoppy": "Flintstones.webp",
    "the_flintstones_2_the_surprise_at_dinosaur_peak": "Flintstones2.webp",
    "tiny_toon_adventures_2": "tiny_toon_adventures_2.webp",
    "tiny_toon_adventures_u_": "tiny_toon_adventures.webp",
    "tokkyuu_shirei_solbrain": "tokkyuu_shirei_solbrain.webp",
    "tom_jerry_u_p1trus_onlain_igrok_rf_": "tom_jerry.webp",

                "487_tank_1990": "battlecity.webp",
                "mario": "mario.webp", 
                "contra": "contra.webp", 
                "battle_city": "battlecity.webp", 
                "duck_hunt": "duckhunt.webp", 
                "tetris": "tetris.webp", 
                "ninja_gaiden": "ninja.webp" 
            
};
            const imgBasePath = "data/img/games/"; 
            const catalogImgBasePath = "data/img/catalog/";

            // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–µ—Ç–∫–∏ "8-BIT –•–ò–¢–´" / –ü–æ–∏—Å–∫–∞ / –ù–µ–¥–∞–≤–Ω–∏—Ö / –ü–æ–ø—É–ª—è—Ä–Ω—ã—Ö / –¢–û–ü
            function renderGamesGrid(gamesToRender, targetGridElement) {
                targetGridElement.innerHTML = '';
                if (!gamesToRender || gamesToRender.length === 0) { 
                    targetGridElement.innerHTML = '<p style="color: #aaa; grid-column: 1 / -1; text-align: center; margin-top: 20px;">–ò–≥—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>'; 
                    return; 
                }
                gamesToRender.forEach(game => {
                    if (!game || !game.id || !game.title || !game.romUrl) { 
                        console.warn("–ü—Ä–æ–ø—É—Å–∫ –∏–≥—Ä—ã (renderGamesGrid) —Å –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:", game); 
                        return; 
                    }
                    const gameCard = document.createElement('div'); 
                    gameCard.className = 'retro-game-card';
                    // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–ø–∫–µ, –ø–æ—Ç–æ–º –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
                    let imagePath = imageMap[game.id] ? (imgBasePath + imageMap[game.id]) : (catalogImgBasePath + game.id + '.webp');
                    gameCard.innerHTML = `<img src="${imagePath}" alt="${game.title}" class="retro-game-image" onerror="this.onerror=null; this.src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';"><div class="retro-game-title">${game.title}</div>`;
                    gameCard.addEventListener('click', () => loadGameFromUrl(game.romUrl, game.title));
                    targetGridElement.appendChild(gameCard);
                });
            }

            // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–µ—Ç–∫–∏ –ö–ê–¢–ê–õ–û–ì–ê
            function renderCatalogGrid(gamesToRender, targetGridElement) {
                 targetGridElement.innerHTML = '';
                 if (!gamesToRender || gamesToRender.length === 0) { 
                     targetGridElement.innerHTML = '<p style="color: #aaa; grid-column: 1 / -1; text-align: center; margin-top: 20px;">–ò–≥—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>'; 
                     return; 
                 }
                 gamesToRender.forEach(game => {
                    if (!game || !game.id || !game.title || !game.filename) { 
                        console.warn("–ü—Ä–æ–ø—É—Å–∫ –∏–≥—Ä—ã (–∫–∞—Ç–∞–ª–æ–≥) —Å –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:", game); 
                        return; 
                    }
                    const gameCard = document.createElement('div'); 
                    gameCard.className = 'retro-game-card';
                    const imagePath = `${catalogImgBasePath}${game.id}.webp`; 
                    const romPath = `roms/catalog/${game.filename}`;
                    gameCard.innerHTML = `<img src="${imagePath}" alt="${game.title}" class="retro-game-image" onerror="this.onerror=null; this.src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';"><div class="retro-game-title">${game.title}</div>`;
                    gameCard.addEventListener('click', () => showGamePage(game)); // –ü–µ—Ä–µ–¥–∞–µ–º –≤–µ—Å—å –æ–±—ä–µ–∫—Ç game
                    targetGridElement.appendChild(gameCard);
                });
            }

            // –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞
            function performSearch() {
                const searchTerm = searchInput.value.toLowerCase().trim(); 
                if (!searchTerm) return;
                
                const filteredGames = libraryGames.filter(game => 
                    game.title.toLowerCase().includes(searchTerm)
                ); // –ü–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –ø–æ —Ö–∏—Ç–∞–º
                
                searchResultsArea.innerHTML = '';
                const titleElement = document.createElement('h2'); 
                titleElement.className = 'search-results-title'; 
                titleElement.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: "${searchInput.value}"`;
                searchResultsArea.appendChild(titleElement);
                
                const backToMainButton = document.createElement('button'); 
                backToMainButton.className = 'back-to-main-button'; 
                backToMainButton.textContent = '‚Äπ –ù–∞–∑–∞–¥ –∫ –∏–≥—Ä–∞–º'; 
                backToMainButton.onclick = showMainContent; 
                searchResultsArea.appendChild(backToMainButton);
                
                const resultsGrid = document.createElement('div'); 
                resultsGrid.className = 'retro-games-grid'; 
                searchResultsArea.appendChild(resultsGrid);
                
                renderGamesGrid(filteredGames, resultsGrid); // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –∫–∞–∫ —Ö–∏—Ç–æ–≤
                mainContent.classList.add('hidden'); 
                searchResultsArea.classList.remove('hidden'); 
                window.scrollTo(0, 0);
            }

            // –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É
            function showMainContent() { 
                searchResultsArea.classList.add('hidden'); 
                mainContent.classList.remove('hidden'); 
                searchInput.value = ''; 
            }

            // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä
            function showRecentGames() {
                 try {
                    const recentGames = JSON.parse(localStorage.getItem('recentGamesList') || '[]');
                    searchResultsArea.innerHTML = '';
                    const titleElement = document.createElement('h2'); 
                    titleElement.className = 'search-results-title'; 
                    titleElement.textContent = '–ù–µ–¥–∞–≤–Ω–∏–µ –∏–≥—Ä—ã'; 
                    searchResultsArea.appendChild(titleElement);
                    
                    const backToMainButton = document.createElement('button'); 
                    backToMainButton.className = 'back-to-main-button'; 
                    backToMainButton.textContent = '‚Äπ –ù–∞–∑–∞–¥ –∫ –∏–≥—Ä–∞–º'; 
                    backToMainButton.onclick = showMainContent; 
                    searchResultsArea.appendChild(backToMainButton);
                    
                    const resultsGrid = document.createElement('div'); 
                    resultsGrid.className = 'retro-games-grid'; 
                    searchResultsArea.appendChild(resultsGrid);
                    
                    renderGamesGrid(recentGames, resultsGrid); // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–Ω–¥–µ—Ä –¥–ª—è –•–∏—Ç–æ–≤ –¥–ª—è –Ω–µ–¥–∞–≤–Ω–∏—Ö
                    mainContent.classList.add('hidden'); 
                    searchResultsArea.classList.remove('hidden'); 
                    window.scrollTo(0, 0);
                } catch (e) { 
                    console.error("–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä:", e); 
                    alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä."); 
                }
            }
// --- –ö–ê–¢–ê–õ–û–ì –ò–ì–† ---
            // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞
            function showCatalog(catalogData, catalogTitle) {
                searchResultsArea.innerHTML = '';
                const titleElement = document.createElement('h2'); 
                titleElement.className = 'search-results-title'; 
                titleElement.textContent = catalogTitle; 
                searchResultsArea.appendChild(titleElement);
                
                const backToMainButton = document.createElement('button'); 
                backToMainButton.className = 'back-to-main-button'; 
                backToMainButton.textContent = '‚Äπ –ù–∞–∑–∞–¥ –∫ –∏–≥—Ä–∞–º'; 
                backToMainButton.onclick = showMainContent; 
                searchResultsArea.appendChild(backToMainButton);
                
                const catalogGrid = document.createElement('div'); 
                catalogGrid.className = 'retro-games-grid';
                searchResultsArea.appendChild(catalogGrid);
                
                renderCatalogGrid(catalogData, catalogGrid); // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–Ω–¥–µ—Ä–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞
                mainContent.classList.add('hidden'); 
                searchResultsArea.classList.remove('hidden'); 
                window.scrollTo(0, 0);
            }

            // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∏–≥—Ä
            function showPopularGames() {
                searchResultsArea.innerHTML = '';
                const titleElement = document.createElement('h2'); 
                titleElement.className = 'search-results-title'; 
                titleElement.textContent = '–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–≥—Ä—ã'; 
                searchResultsArea.appendChild(titleElement);
                
                const backToMainButton = document.createElement('button'); 
                backToMainButton.className = 'back-to-main-button'; 
                backToMainButton.textContent = '‚Äπ –ù–∞–∑–∞–¥ –∫ –∏–≥—Ä–∞–º'; 
                backToMainButton.onclick = showMainContent; 
                searchResultsArea.appendChild(backToMainButton);
                
                const resultsGrid = document.createElement('div'); 
                resultsGrid.className = 'retro-games-grid'; 
                searchResultsArea.appendChild(resultsGrid);
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º renderGamesGrid, —Ç.–∫. popularGamesList —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—ä–µ–∫—Ç—ã —Å romUrl
                renderGamesGrid(popularGamesList, resultsGrid);
                mainContent.classList.add('hidden'); 
                searchResultsArea.classList.remove('hidden'); 
                window.scrollTo(0, 0);
            }

            // --- –¢–û–ü –ò–ì–† ---
            function showTopGames() {
                searchResultsArea.innerHTML = '';
                const titleElement = document.createElement('h2'); 
                titleElement.className = 'search-results-title'; 
                titleElement.textContent = '–¢–û–ü –ò–ì–†'; 
                searchResultsArea.appendChild(titleElement);
                
                const backToMainButton = document.createElement('button'); 
                backToMainButton.className = 'back-to-main-button'; 
                backToMainButton.textContent = '‚Äπ –ù–∞–∑–∞–¥ –∫ –∏–≥—Ä–∞–º'; 
                backToMainButton.onclick = showMainContent; 
                searchResultsArea.appendChild(backToMainButton);
                
                const resultsGrid = document.createElement('div'); 
                resultsGrid.className = 'retro-games-grid'; 
                searchResultsArea.appendChild(resultsGrid);
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º renderGamesGrid, —Ç.–∫. topGamesList —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—ä–µ–∫—Ç—ã —Å romUrl
                renderGamesGrid(topGamesList, resultsGrid);
                mainContent.classList.add('hidden'); 
                searchResultsArea.classList.remove('hidden'); 
                window.scrollTo(0, 0);
            }


// –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–µ—Ç–∫–∏ –ö–ê–¢–ê–õ–û–ì–ê
function renderCatalogGrid(gamesToRender, targetGridElement) {
    targetGridElement.innerHTML = '';
    if (!gamesToRender || gamesToRender.length === 0) {
        targetGridElement.innerHTML = '<p style="color: #aaa; grid-column: 1 / -1; text-align: center; margin-top: 20px;">–ò–≥—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>';
        return;
    }
    gamesToRender.forEach(game => {
        // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –Ω–∞–ª–∏—á–∏–µ genre –∏ description, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        if (!game || !game.id || !game.title || !game.filename /* || !game.genre || !game.description */ ) {
            console.warn("–ü—Ä–æ–ø—É—Å–∫ –∏–≥—Ä—ã (–∫–∞—Ç–∞–ª–æ–≥) —Å –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:", game);
            return;
        }
        const gameCard = document.createElement('div');
        gameCard.className = 'retro-game-card';
        // --- –ó–ê–ú–ï–ù–ò–¢–¨ –°–¢–ê–†–£–Æ –°–¢–†–û–ö–£ const imagePath = ... –ù–ê –≠–¢–û–¢ –ë–õ–û–ö ---
let imagePath;
if (imageMap[game.id]) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ ID –∏–≥—Ä—ã –≤ imageMap
    // –ï—Å–ª–∏ –µ—Å—Ç—å, –±–µ—Ä–µ–º –ø—É—Ç—å –∏–∑ imgBasePath –∏ –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ imageMap
    imagePath = imgBasePath + imageMap[game.id];
} else {
    // –ï—Å–ª–∏ –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—É—Ç—å –∫–∞—Ç–∞–ª–æ–≥–∞
    imagePath = `<span class="math-inline">\{catalogImgBasePath\}</span>{game.id}.webp`; // <--- –ò–°–ü–†–ê–í–õ–ï–ù –°–ò–ù–¢–ê–ö–°–ò–°
}
// --- –ö–û–ù–ï–¶ –ó–ê–ú–ï–ù–´ ---
        const romPath = `roms/catalog/${game.filename}`; // romPath –≤—Å–µ –µ—â–µ –Ω—É–∂–µ–Ω –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ò–ì–†–ê–¢–¨"

        gameCard.innerHTML = `<img src="${imagePath}" alt="${game.title}" class="retro-game-image" onerror="this.onerror=null; this.src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';"><div class="retro-game-title">${game.title}</div>`;

// --- –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø –°–¢–†–ê–ù–ò–¶–´ –ò–ì–†–´ ---
function showGamePage(game) {
    const gamePageArea = document.getElementById('game-page-area');
    if (!game || !gamePageArea) {
        console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä—ã:", game);
        return;
    }

    // –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã (—É–∂–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–±—ä–µ–∫—Ç–µ game –ø–æ—Å–ª–µ –æ–±–æ–≥–∞—â–µ–Ω–∏—è)
    const fullGameData = window.fullCatalogGames.find(g => g.id === game.id);
    if (!fullGameData) {
         console.error("–ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã:", game.id);
         alert("–û—à–∏–±–∫–∞: –ù–µ –Ω–∞–π–¥–µ–Ω—ã –¥–µ—Ç–∞–ª–∏ –∏–≥—Ä—ã.");
         return;
    }

    const romPath = `roms/catalog/${fullGameData.filename}`;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–æ—Ç–∏–ø–∞ –≤ imageMap
    let imagePath;
    if (imageMap[fullGameData.id]) {
        // –ï—Å–ª–∏ –µ—Å—Ç—å –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ—Ç–∏–ø–∞—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
        imagePath = imgBasePath + imageMap[fullGameData.id];
    } else {
        // –ò–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞
        imagePath = `${catalogImgBasePath}${fullGameData.id}.webp`;
    }

    // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä—ã
    gamePageArea.innerHTML = `
        <div class="game-page-container">
            <div class="game-page-header">
                 <button class="game-page-back-button" id="game-page-back-btn" title="–ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–∞–ª–æ–≥—É">&#10094;</button>
                 <span class="game-page-genre">${fullGameData.genre || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</span>
            </div>
            <h2 class="game-page-title">${fullGameData.title}</h2>
            <img src="${imagePath}" alt="${fullGameData.title}" class="game-page-logo" onerror="this.onerror=null; this.style.display='none';">
            <div class="game-page-screenshots">
                <p>(–ó–¥–µ—Å—å –±—É–¥—É—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã)</p>
            </div>
            <div class="game-page-description">
                ${fullGameData.description || '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.'}
            </div>
            <button class="game-page-play-button" id="game-page-play-btn">–ò–ì–†–ê–¢–¨</button>
        </div>
    `;

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫
    const playButton = gamePageArea.querySelector('#game-page-play-btn');
    const backCatalogButton = gamePageArea.querySelector('#game-page-back-btn');

    if (playButton) {
        playButton.onclick = () => {
             gamePageArea.classList.add('hidden'); // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä—ã
             loadGameFromUrl(romPath, fullGameData.title); // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É
        };
    }

    if (backCatalogButton) {
        backCatalogButton.onclick = () => {
            gamePageArea.classList.add('hidden');
            searchResultsArea.classList.remove('hidden'); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥ –æ–±—Ä–∞—Ç–Ω–æ
            window.scrollTo(0, 0); // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö
        };
    }

    // –°–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ —Å–µ–∫—Ü–∏–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä—ã
    mainContent.classList.add('hidden');
    searchResultsArea.classList.add('hidden');
    display.classList.add('hidden');
    gamePageArea.classList.remove('hidden');
    window.scrollTo(0, 0);
}
        // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï –ó–î–ï–°–¨ ---
        // –ë—ã–ª–æ: gameCard.addEventListener('click', () => loadGameFromUrl(romPath, game.title));
        gameCard.addEventListener('click', () => showGamePage(game)); // –ü–µ—Ä–µ–¥–∞–µ–º –≤–µ—Å—å –æ–±—ä–µ–∫—Ç game
        // --- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø ---

        targetGridElement.appendChild(gameCard);
    });
}

            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã –ø–æ URL
            function loadGameFromUrl(romUrl, gameName) { 
                loadGame(romUrl, gameName, defaultCore); 
            }

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ DND, –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
            uploadBox.addEventListener('dragover', function(e) { 
                e.preventDefault(); 
                this.setAttribute("drag", true); 
            }); 
            
            uploadBox.addEventListener('dragleave', function() { 
                this.removeAttribute("drag"); 
            }); 
            
            uploadBox.addEventListener('drop', function(e) { 
                e.preventDefault(); 
                this.removeAttribute("drag"); 
                if (e.dataTransfer.files.length > 0) { 
                    handleRomFile(e.dataTransfer.files[0]); 
                } 
            });
            
            fileInput.addEventListener('change', function() { 
                if (this.files.length > 0) { 
                    handleRomFile(this.files[0]); 
                } 
            });
            
            function handleRomFile(file) { 
                const fileName = file.name; 
                const parts = fileName.split("."); 
                const extension = parts.pop().toLowerCase(); 
                const gameName = parts.join("."); 
                
                if (["fds", "nes", "unif", "unf"].includes(extension)) { 
                    loadGame(file, gameName, defaultCore); 
                } else { 
                    alert("–≠—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è..."); 
                } 
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–¥–∞–≤–Ω–∏—Ö
            function loadGame(romFile, gameName, core) {
                 stopEmulator();
                 // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –Ω–µ–¥–∞–≤–Ω–∏–µ
                 let gameDataToStore = null;
                 if (typeof romFile === 'string') { 
                     gameDataToStore = libraryGames.find(g => g.romUrl === romFile) || fullCatalogGames.find(g => `roms/catalog/${g.filename}` === romFile); 
                     if (!gameDataToStore && romFile.startsWith('roms/catalog/')) { 
                         const filename = romFile.split('/').pop(); 
                         gameDataToStore = fullCatalogGames.find(g => g.filename === filename); 
                     } 
                 }
                 else if (romFile instanceof File) { 
                     gameDataToStore = libraryGames.find(g => g.title === gameName) || fullCatalogGames.find(g => g.title === gameName); 
                     if (!gameDataToStore) { 
                         console.log("–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–∞—è –∏–≥—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–µ–¥–∞–≤–Ω–∏–µ."); 
                     } 
                 }
                 
                 if (gameDataToStore && gameDataToStore.id) {
                     try {
                         const MAX_RECENT_GAMES = 9; 
                         let recentGames = JSON.parse(localStorage.getItem('recentGamesList') || '[]'); 
                         recentGames = recentGames.filter(g => g.id !== gameDataToStore.id);
                         
                         let recentRomUrl = ''; 
                         if (typeof romFile === 'string') { 
                             recentRomUrl = romFile; 
                         } else { 
                             const libEntry = libraryGames.find(g => g.id === gameDataToStore.id); 
                             const catEntry = fullCatalogGames.find(g => g.id === gameDataToStore.id); 
                             if (libEntry) recentRomUrl = libEntry.romUrl; 
                             else if (catEntry) recentRomUrl = `roms/catalog/${catEntry.filename}`; 
                         }
                         
                         if (recentRomUrl) { 
                             recentGames.unshift({ 
                                 id: gameDataToStore.id, 
                                 title: gameDataToStore.title, 
                                 romUrl: recentRomUrl 
                             }); 
                             recentGames = recentGames.slice(0, MAX_RECENT_GAMES); 
                             localStorage.setItem('recentGamesList', JSON.stringify(recentGames)); 
                         }
                     } catch (e) { 
                         console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä:", e); 
                     }
                 }
                 
                 // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã
                 window.currentRomUrl = romFile; 
                 window.currentGameName = gameName; 
                 window.orientationShown = false; 
                 window.isEmulatorActive = true; 
                 
                 mainContent.classList.add('hidden'); 
                 searchResultsArea.classList.add('hidden'); 
                 display.classList.remove('hidden'); 
                 backButton.style.display = 'flex'; 
                 reloadEmulatorButton.style.display = 'flex'; 
                 
                 if (isMobile) { 
                     enableFullscreen(); 
                 }
                 
                 window.EJS_player = "#game"; 
                 window.EJS_gameName = gameName; 
                 window.EJS_biosUrl = ""; 
                 window.EJS_gameUrl = romFile; 
                 window.EJS_core = core; 
                 window.EJS_pathtodata = "data/"; 
                 window.EJS_startOnLoaded = true; 
                 window.EJS_DEBUG_XX = enableDebug; 
                 window.EJS_disableDatabases = true; 
                 window.EJS_threads = enableThreads;
                 
                 window.EJS_onGameStart = function() { 
                     if (window.Telegram && window.Telegram.WebApp) { 
                         window.Telegram.WebApp.expand(); 
                     } 
                     setTimeout(fixCanvasScaling, 1000); 
                 };
                 
                 const script = document.createElement("script"); 
                 script.id = "emulatorScript"; 
                 script.src = "data/loader.js"; 
                 document.body.appendChild(script);
            }

            // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç–º—É–ª—è—Ç–æ—Ä–æ–º, –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–µ–π, –∞—É–¥–∏–æ –∏ —Ç.–¥.
            backButton.addEventListener('click', function() {
    stopEmulator();
    display.classList.add('hidden');
    mainContent.classList.remove('hidden');
    searchResultsArea.classList.add('hidden');
    backButton.style.display = 'none';
    reloadEmulatorButton.style.display = 'none';
    window.currentRomUrl = null;
    window.currentGameName = null;
    window.orientationShown = false;
    window.isEmulatorActive = false;

    // --- –î–û–ë–ê–í–ò–¢–¨ –≠–¢–£ –°–¢–†–û–ö–£ ---
    document.body.classList.remove('fullscreen-mode');
    console.log("Fullscreen mode disabled."); // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
    // --- –ö–û–ù–ï–¶ –î–û–ë–ê–í–õ–ï–ù–ò–Ø ---
})
            
            reloadEmulatorButton.addEventListener('click', function() { 
                loadingState.style.display = 'flex'; 
                setTimeout(() => { 
                    reloadEmulator(); 
                    setTimeout(() => { 
                        loadingState.style.display = 'none'; 
                    }, 1500); 
                }, 500); 
            });
            
            function checkOrientation() { 
                /* –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ */ 
            } 
            
            function fixCanvasScaling() { 
                /* –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–¥ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è canvas */ 
            } 
            
          function enableFullscreen() {
    document.body.classList.add('fullscreen-mode');
    console.log("Fullscreen mode enabled."); // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
} 
            
            function reloadEmulator() { 
                /* –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–¥ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —ç–º—É–ª—è—Ç–æ—Ä–∞ */ 
            } 
            
            function stopEmulator() { 
                /* –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —ç–º—É–ª—è—Ç–æ—Ä–∞ */ 
            } 
            
            function stopAllAudio() { 
                /* –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ–≥–æ –∞—É–¥–∏–æ */ 
            } 
            
            function initTelegramWebApp() { 
                /* –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram Web App */ 
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            window.addEventListener('orientationchange', () => setTimeout(checkOrientation, 300)); 
            window.addEventListener('resize', () => { 
                checkOrientation(); 
                if (window.isEmulatorActive) { 
                    setTimeout(fixCanvasScaling, 100); 
                } 
            }); 
            
            startPlayButton.addEventListener('click', (event) => { 
                event.stopPropagation(); 
                window.orientationShown = true; 
                orientationMessage.style.display = 'none'; 
            }); 
            
            orientationMessage.addEventListener('click', function() { 
                window.orientationShown = true; 
                this.style.display = 'none'; 
            });
            
            searchButton.addEventListener('click', performSearch); 
            searchInput.addEventListener('keydown', (event) => { 
                if (event.key === 'Enter') { 
                    event.preventDefault(); 
                    performSearch(); 
                } 
            });
            
            if (recentGamesButton) { 
                recentGamesButton.addEventListener('click', showRecentGames); 
            }
            
            if (homeNavButton) { 
                homeNavButton.addEventListener('click', showMainContent); 
            }
            
            if (shareButton) { 
                shareButton.addEventListener('click', () => { 
                    if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initData) { 
                        const botUrl = "https://t.me/YourBotUsername"; /* !!! –ó–ê–ú–ï–ù–ò !!! */ 
                        const shareText = encodeURIComponent("–ó–∞—Ü–µ–Ω–∏ –∫—Ä—É—Ç–æ–π —ç–º—É–ª—è—Ç–æ—Ä –î–µ–Ω–¥–∏ –ø—Ä—è–º–æ –≤ –¢–µ–ª–µ–≥—Ä–∞–º!"); 
                        const shareUrl = `https://t.me/share/url?url=${encodeURIComponent(botUrl)}&text=${shareText}`; 
                        window.Telegram.WebApp.openLink(shareUrl); 
                    } else { 
                        alert("–§—É–Ω–∫—Ü–∏—è '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è' —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram."); 
                    } 
                }); 
            }
            
            if (catalogButton) { 
                catalogButton.addEventListener('click', () => { 
                    showCatalog(fullCatalogGames, "–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä"); 
                }); 
            }
            
            if (alphaSortButton) { 
                alphaSortButton.addEventListener('click', () => { 
                    const sortedCatalog = [...fullCatalogGames].sort((a, b) => 
                        a.title.localeCompare(b.title, 'ru')
                    ); 
                    showCatalog(sortedCatalog, "–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä (–ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É)"); 
                }); 
            }
            
            if (popularButton) { 
                popularButton.addEventListener('click', showPopularGames); 
            }
            
            // --- –°–õ–£–ß–ê–ô–ù–ê–Ø –ò–ì–†–ê ---
            if (randomButton) {
                randomButton.addEventListener('click', () => {
                    if (fullCatalogGames && fullCatalogGames.length > 0) {
                        const randomIndex = Math.floor(Math.random() * fullCatalogGames.length);
                        const randomGame = fullCatalogGames[randomIndex];
                        const romPath = `roms/catalog/${randomGame.filename}`;
                        loadGameFromUrl(romPath, randomGame.title); // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É
                    } else {
                        alert("–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä –ø—É—Å—Ç!");
                    }
                });
            }
            
            // --- –¢–û–ü –ò–ì–† ---
            if (topGamesButton) {
                topGamesButton.addEventListener('click', showTopGames);
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            renderGamesGrid(libraryGames, initialRetroGamesGrid); 
            initTelegramWebApp();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è featured-card (–∫—Ä–æ–º–µ –∫–∞—Ç–∞–ª–æ–≥–∞)
            document.querySelectorAll('.featured-card:not(#catalog-btn)').forEach(card => { 
                card.addEventListener('click', function() { 
                    const title = this.querySelector('.featured-title').textContent; 
                    if (title === "–ü–†–û–î–û–õ–ñ–ò–¢–¨ –ò–ì–†–£") { 
                        alert("–§—É–Ω–∫—Ü–∏—è '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É' –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!"); 
                    } 
                }); 
            });
            
            // –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å –∑–∞ DOM
            const observer = new MutationObserver((m) => { 
                m.forEach((mu) => { 
                    if (mu.addedNodes && mu.addedNodes.length > 0) { 
                        for (let i = 0; i < mu.addedNodes.length; i++) { 
                            const n = mu.addedNodes[i]; 
                            if (n.nodeName === 'CANVAS' || (n.classList && n.classList.contains('ejs_canvas'))) { 
                                setTimeout(fixCanvasScaling, 50); 
                                break; 
                            } 
                        } 
                    } 
                }); 
            }); 
            observer.observe(document.getElementById('game'), {childList: true, subtree: true});
        });
    </script>
</body>
</html>