<!DOCTYPE html>
<html>
<head>
    <title>Dendy Emulator –¥–ª—è Telegram</title>
<meta charset="UTF-8">    
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>

/* CSS –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ */
.favorite-button {
    position: absolute;
    top: 5px;
    right: 5px;
    width: 24px;
    height: 24px;
    background-color: rgba(0, 0, 0, 0.5);
    color: #ccc;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 16px;
    z-index: 10;
    transition: all 0.2s;
}

.favorite-button.add-favorite:hover {
    color: #FFD700;
}

.favorite-button.remove-favorite {
    color: #FFD700;
}

.favorite-button.remove-favorite:hover {
    background-color: rgba(255, 0, 0, 0.7);
    color: white;
}

.retro-game-card {
    position: relative; /* –î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ */
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–≥—Ä—ã */
#game-page-favorite-btn {
    position: relative; /* –°–±—Ä–æ—Å–∏–º absolute –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ */
    top: auto;
    right: auto;
    width: 30px;
    height: 30px;
    font-size: 20px;
    margin-right: 10px; /* –û—Ç—Å—Ç—É–ø –æ—Ç –∂–∞–Ω—Ä–∞ —Å–ø—Ä–∞–≤–∞ */
    margin-left: auto; /* –ü—Ä–∏–∂–∏–º–∞–µ–º –∫ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–æ–π –Ω–∞–∑–∞–¥ –∏ –∂–∞–Ω—Ä–æ–º */
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–≥—Ä—ã */
.game-page-header {
    width: 100%;
    display: flex;
    justify-content: flex-start; /* –ò–∑–º–µ–Ω–∏–º —Å space-between –Ω–∞ flex-start */
    align-items: center;
    margin-bottom: 15px;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∂–∞–Ω—Ä–∞, —á—Ç–æ–±—ã –æ–Ω –Ω–µ –ø—Ä–∏–∂–∏–º–∞–ª—Å—è –∫ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é */
.game-page-genre {
    margin-left: 0; /* –£–±–∏—Ä–∞–µ–º auto margin */
}        

/* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        body, html { height: 100%; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; -webkit-tap-highlight-color: transparent; background-color: #282c34; color: #ffffff; overflow-x: hidden; }
        .retro-container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 15px; box-sizing: border-box; }
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; background: linear-gradient(90deg, #ff0080, #ff8c00); border-radius: 12px; padding: 10px 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); }
        .logo { display: flex; align-items: center; } .logo img { width: 50px; height: 50px; border-radius: 50%; margin-right: 10px; border: 2px solid #fff; } .logo-text { font-family: 'Press Start 2P', cursive; color: #fff; text-shadow: 2px 2px 0 #000; } .logo-text h1 { margin: 0; font-size: 1.5em; } .logo-text p { margin: 5px 0 0 0; font-size: 0.8em; } .navigation { display: flex; gap: 10px; } .nav-button { background-color: rgba(0,0,0,0.3); color: #fff; border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 18px; transition: all 0.2s; } .nav-button:hover { background-color: rgba(0,0,0,0.5); transform: scale(1.1); }
        /* –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ */
        .search-container { position: relative; margin-bottom: 20px; max-width: 1200px; width: 100%; margin-left: auto; margin-right: auto; } .search-input { width: 100%; padding: 15px 45px 15px 20px; border: none; border-radius: 25px; background-color: rgba(255, 255, 255, 0.1); color: #fff; font-size: 16px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); transition: all 0.3s; box-sizing: border-box; } .search-input:focus { outline: none; background-color: rgba(255, 255, 255, 0.15); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); } .search-button { position: absolute; right: 5px; top: 5px; background: linear-gradient(90deg, #ff0080, #ff8c00); color: #fff; border: none; border-radius: 20px; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 18px; transition: all 0.2s; } .search-button:hover { transform: scale(1.05); }
        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */
        .categories { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; } .category-card { background: linear-gradient(135deg, #1e2033, #373b59); border-radius: 12px; padding: 15px; display: flex; flex-direction: column; align-items: center; text-align: center; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); overflow: hidden; position: relative; } .category-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); } .category-icon { font-size: 36px; margin-bottom: 10px; position: relative; z-index: 1; } .category-icon img { width: 60px; height: 60px; object-fit: contain; } .category-title { font-family: 'Press Start 2P', cursive; font-size: 14px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0; position: relative; z-index: 1; line-height: 1.3; word-break: break-word; } .category-card::after { content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 0, 128, 0.1), rgba(255, 140, 0, 0.1)); z-index: 0; opacity: 0; transition: opacity 0.3s; } .category-card:hover::after { opacity: 1; }
        /* –ë–æ–ª—å—à–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .featured-games { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; } .featured-card { background: linear-gradient(135deg, #373b59, #1e2033); border-radius: 12px; padding: 20px; position: relative; overflow: hidden; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); display: flex; flex-direction: column; } .featured-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); } .featured-content { position: relative; z-index: 1; flex-grow: 1; } .featured-title { font-family: 'Press Start 2P', cursive; font-size: 16px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 30px 0; } .featured-image { width: 100%; height: 120px; object-fit: contain; margin-top: auto; } .arrow-button {
    position: absolute;
    right: 15px !important; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –ø—Ä–∞–≤–æ–≥–æ –∫—Ä–∞—è */
    bottom: 10px; /* –ü–æ–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–∏–∑—É */
    background: linear-gradient(90deg, #ff0080, #ff8c00);
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 20px;
    font-weight: bold;
    text-shadow: 0px 1px 1px rgba(0,0,0,0.3); /* –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–Ω—å –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ */
    transition: all 0.2s;
    z-index: 2;
}

/* –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è —Å—Ç—Ä–µ–ª–∫–∏ –≤ –Ω–æ–≤–æ—Å—Ç–Ω–æ–º –±–∞–Ω–Ω–µ—Ä–µ */
.news-banner .arrow-button {
    bottom: auto; /* –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
    top: 50%; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
    transform: translateY(-50%); /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Ç–æ—á–Ω–æ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
}

.news-banner .arrow-button:hover {
    transform: translateY(-50%) scale(1.1); /* –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ hover */
}

/* –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç–∏–ª–∏ –¥–ª—è news-banner */
.news-banner {
    position: relative; /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Ä–æ–¥–∏—Ç–µ–ª—å –∏–º–µ–µ—Ç relative */
}

.news-banner .arrow-button {
    position: absolute;
    bottom: 10px; 
    right: 15px; /* –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ –≤—ã—à–µ */
}

/* –¢–∞–∫–∂–µ —Ñ–∏–∫—Å–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏—é –¥–ª—è .featured-card */
.featured-card {
    position: relative; /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Ä–æ–¥–∏—Ç–µ–ª—å –∏–º–µ–µ—Ç relative */
}

.featured-card .arrow-button {
    position: absolute;
    bottom: 10px;
    right: 15px; /* –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ –≤—ã—à–µ */
}

.arrow-button:hover {
    transform: scale(1.1);
}

/* –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–æ—á–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç—Ä–µ–ª–∫–∏ –≤ –Ω–æ–≤–æ—Å—Ç—è—Ö */
.news-banner .arrow-button {
    right: 20px !important; /* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ important –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö —Å—Ç–∏–ª–µ–π */
}

/* –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤ –±–ª–æ–∫–µ –Ω–æ–≤–æ—Å—Ç–µ–π */
.news-banner .arrow-button {
    bottom: auto; /* –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é bottom */
    top: 50%;    /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
    transform: translateY(-50%); /* –°–º–µ—â–∞–µ–º –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è */
    right: 10px; /* –¢–∞–∫–æ–π –∂–µ –æ—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ –∫–∞–∫ —É –¥—Ä—É–≥–∏—Ö –∫–Ω–æ–ø–æ–∫ */
}

.news-banner .arrow-button:hover {
    transform: translateY(-50%) scale(1.1); /* –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç —É–≤–µ–ª–∏—á–µ–Ω–∏—è */
}

/* –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
@media (max-width: 600px) {
    .news-banner .arrow-button {
        top: auto; /* –û—Ç–º–µ–Ω—è–µ–º —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
        bottom: 10px; /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–Ω–∏–∑—É */
        transform: none; /* –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é */
    }
    
    .news-banner .arrow-button:hover {
        transform: scale(1.1); /* –û–±–Ω–æ–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç hover */
    }
}
        /* –°–µ–∫—Ü–∏—è 8-bit –•–∏—Ç—ã –∏ —Å–µ—Ç–∫–∞ –∏–≥—Ä */
        .retro-hits { margin-bottom: 20px; } .retro-hits-title { font-family: 'Press Start 2P', cursive; font-size: 18px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 15px 0; text-align: center; } .retro-games-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px; } .retro-game-card { background: linear-gradient(135deg, #1e2033, #373b59); border-radius: 12px; padding: 15px; display: flex; flex-direction: column; align-items: center; text-align: center; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); overflow: hidden; } .retro-game-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); } .retro-game-image { display: block; width: 100%; max-width: 90px; height: auto; object-fit: contain; margin-bottom: 8px; border-radius: 8px; background-color: rgba(0,0,0,0.1); } .retro-game-title { font-family: 'Press Start 2P', cursive; font-size: 12px; color: #fff; margin: 0; line-height: 1.3; word-break: break-word; }
        /* ROM –ó–∞–≥—Ä—É–∑–∫–∞ */
        .rom-upload { background: linear-gradient(135deg, #1e2033, #373b59); border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); } .rom-upload-title { font-family: 'Press Start 2P', cursive; font-size: 18px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 15px 0; text-align: center; } .upload-box { width: 100%; height: 120px; border: 2px dashed #555; border-radius: 8px; display: flex; align-items: center; justify-content: center; background-color: rgba(0, 0, 0, 0.2); transition: all 0.3s; cursor: pointer; position: relative; } .upload-box:hover, .upload-box[drag] { border-color: #ff0080; background-color: rgba(0, 0, 0, 0.3); } .file-input { position: absolute; width: 100%; height: 100%; opacity: 0; cursor: pointer; z-index: 10; } .upload-text { font-size: 16px; color: #aaa; text-align: center; padding: 0 15px; } .upload-text strong { color: #fff; display: block; margin-bottom: 5px; }
        /* –ù–æ–≤–æ—Å—Ç–∏/–ë–∞–Ω–Ω–µ—Ä */
        .news-banner { background: linear-gradient(135deg, #1e2033, #373b59); border-radius: 12px; padding: 20px; margin-bottom: 20px; position: relative; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); } .news-banner:hover { box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); } .news-content { position: relative; z-index: 1; display: flex; align-items: center; } .news-text { flex: 1; } .news-title { font-family: 'Press Start 2P', cursive; font-size: 16px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 10px 0; } .news-description { color: rgba(255, 255, 255, 0.8); margin: 0; font-size: 14px; } .news-icon { font-size: 36px; color: #ff0080; margin-right: 15px; }
        /* –≠–º—É–ª—è—Ç–æ—Ä –∏ –µ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        #display { width: 100%; height: calc(100vh - 160px); max-height: 600px; background-color: #000; border-radius: 12px; overflow: hidden; position: relative; margin-bottom: 20px; } #game { width: 100%; height: 100%; } #backButton { position: fixed; top: 15px; left: 15px; background-color: rgba(0,0,0,0.3); color: white; border: none; border-radius: 50%; width: 36px; height: 36px; display: none; align-items: center; justify-content: center; cursor: pointer; z-index: 1002; font-size: 22px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); background-color: transparent; } #backButton:hover { background-color: rgba(0,0,0,0.5); } #reloadEmulatorButton { position: fixed; top: 15px; right: 15px; background-color: rgba(0,0,0,0.3); color: white; border: none; border-radius: 50%; width: 36px; height: 36px; display: none; align-items: center; justify-content: center; cursor: pointer; z-index: 1002; font-size: 20px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); } #reloadEmulatorButton:hover { background-color: rgba(0,0,0,0.5); } #orientationMessage { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; padding: 20px; box-sizing: border-box; transition: opacity 0.3s ease; -webkit-tap-highlight-color: transparent; user-select: none; } #startPlayButton { background-color: #FF0000; color: white; border: none; border-radius: 8px; padding: 15px 30px; font-size: 20px; font-weight: bold; margin-bottom: 30px; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.3); transition: transform 0.1s ease, background-color 0.2s ease; -webkit-tap-highlight-color: transparent; } #startPlayButton:hover { background-color: #D00000; transform: translateY(2px); } .loading-state { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; } .loading-spinner { width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: white; animation: spin 1s ease-in-out infinite; } @keyframes spin { to { transform: rotate(360deg); } } .loading-indicator { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 2000; display: none; } .loading-indicator::after { content: ""; width: 50px; height: 50px; border: 5px solid #fff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite; }
        /* –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º */
        .fullscreen-mode #display { position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; max-height: none !important; z-index: 1000 !important; border-radius: 0 !important; margin: 0 !important; padding: 0 !important; overflow: hidden !important; background-color: #000 !important; } .fullscreen-mode #game { width: 100% !important; height: 100% !important; position: relative !important; display: flex !important; align-items: center !important; justify-content: center !important; overflow: hidden !important; background-color: #000 !important; } .fullscreen-mode #game canvas { object-fit: contain !important; max-width: 100% !important; max-height: 100% !important; width: auto !important; height: auto !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; image-rendering: pixelated !important; background-color: #000 !important; -webkit-backface-visibility: hidden !important; backface-visibility: hidden !important; } .fullscreen-mode .ejs_virtualGamepad, .fullscreen-mode .ejs_virtualGamepad_button, .fullscreen-mode .ejs_virtualGamepad_touchpad { z-index: 1002 !important; } .hidden { display: none !important; } body.touch-disabled { touch-action: none !important; -ms-touch-action: none !important; overflow: hidden !important; }
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–µ–∫—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞, –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä –∏ –∫–∞—Ç–∞–ª–æ–≥–∞ */
        #search-results-area { padding-top: 20px; } .search-results-title { font-family: 'Press Start 2P', cursive; font-size: 18px; color: #fff; text-shadow: 1px 1px 0 #000; margin: 0 0 15px 0; text-align: center; } .back-to-main-button { display: block; margin: 20px auto 10px auto; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 12px; color: #fff; background: linear-gradient(90deg, #555, #333); border: none; border-radius: 8px; cursor: pointer; transition: background 0.3s; text-shadow: 1px 1px 0 #000; } .back-to-main-button:hover { background: linear-gradient(90deg, #666, #444); }
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (min-width: 768px) { .categories { grid-template-columns: repeat(3, 1fr); } .retro-games-grid { grid-template-columns: repeat(4, 1fr); } } @media (max-width: 600px) { .header { flex-direction: column; text-align: center; padding: 15px; } .logo { margin-bottom: 10px; justify-content: center; } .navigation { width: 100%; justify-content: center; } .featured-games { grid-template-columns: 1fr; } .news-content { flex-direction: column; text-align: center; } .news-icon { margin: 0 0 15px 0; } .retro-games-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; } } @media (max-width: 480px) { .rom-upload-title, .retro-hits-title { font-size: 14px; } .upload-box { height: 100px; } .upload-text { font-size: 14px; } .search-results-title { font-size: 16px; } } @media (max-width: 360px) { .retro-games-grid { grid-template-columns: repeat(2, 1fr); gap: 8px; } .retro-game-image { max-width: 70px; } .retro-game-title { font-size: 10px; } .retro-game-card { padding: 10px 5px; } .category-title { font-size: 12px; } }

/* === –°–¢–ò–õ–ò –î–õ–Ø –°–¢–†–ê–ù–ò–¶–´ –ò–ì–†–´ === */
#game-page-area {
    padding: 20px 15px;
    background-color: #1e2033; /* –ù–µ–º–Ω–æ–≥–æ –¥—Ä—É–≥–æ–π —Ñ–æ–Ω –¥–ª—è –æ—Ç–ª–∏—á–∏—è */
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.game-page-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.game-page-header {
    width: 100%;
    display: flex;
    justify-content: space-between; /* –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ —Å–ª–µ–≤–∞, –∂–∞–Ω—Ä —Å–ø—Ä–∞–≤–∞ */
    align-items: center;
    margin-bottom: 15px;
}

.game-page-back-button {
    background: none;
    border: none;
    color: #ff8c00; /* –û—Ä–∞–Ω–∂–µ–≤—ã–π —Ü–≤–µ—Ç */
    font-size: 28px; /* –ö—Ä—É–ø–Ω–µ–µ */
    cursor: pointer;
    padding: 5px;
    line-height: 1;
    font-weight: bold;
}
.game-page-back-button:hover {
    color: #ffae42; /* –°–≤–µ—Ç–ª–µ–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
}


.game-page-genre {
    font-family: 'Press Start 2P', cursive;
    font-size: 12px;
    color: #aaa;
    text-transform: uppercase;
    background-color: rgba(255, 255, 255, 0.1);
    padding: 5px 10px;
    border-radius: 6px;
    margin-left: auto; /* –ü—Ä–∏–∂–∏–º–∞–µ–º –≤–ø—Ä–∞–≤–æ */
}

.game-page-title {
    font-family: 'Press Start 2P', cursive;
    font-size: 20px; /* –ö—Ä—É–ø–Ω–µ–µ */
    color: #fff;
    text-shadow: 1px 1px 0 #000;
    margin: 0 0 20px 0; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
    line-height: 1.4;
}

.game-page-logo {
    width: 70%;           /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å 60% –¥–æ 70% */
    max-width: 250px;     /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å 200px –¥–æ 250px */
    height: auto;
    object-fit: contain;
    margin-bottom: 25px;
    border-radius: 8px;
    background-color: rgba(0,0,0,0.2);
    padding: 10px;
    box-sizing: border-box;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3); /* –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–Ω—å –¥–ª—è –ª—É—á—à–µ–≥–æ –≤–∏–¥–∞ */
}

.game-page-screenshots {
    margin-bottom: 25px;
    width: 100%;
    text-align: center;
    color: #aaa;
    font-style: italic;
}
/* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ (–∫–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏—Ç–µ)
.game-page-screenshots img {
    width: 48%;
    margin: 1%;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
} */

.game-page-description {
    color: #ddd;
    font-size: 15px;
    line-height: 1.6;
    margin-bottom: 30px;
    text-align: center; /* –ú–µ–Ω—è–µ–º left –Ω–∞ center */
    max-width: 600px; /* –û–≥—Ä–∞–Ω–∏—á–∏–º —à–∏—Ä–∏–Ω—É –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
    width: 100%;
    margin-left: auto; /* –î–æ–±–∞–≤–ª—è–µ–º –¥–ª—è –ª—É—á—à–µ–≥–æ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è */
    margin-right: auto; /* –î–æ–±–∞–≤–ª—è–µ–º –¥–ª—è –ª—É—á—à–µ–≥–æ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è */
}

.game-page-play-button {
    font-family: 'Press Start 2P', cursive;
    font-size: 18px;
    color: #fff;
    background: linear-gradient(90deg, #ff0080, #ff8c00);
    border: none;
    border-radius: 10px;
    padding: 15px 30px;
    cursor: pointer;
    text-shadow: 1px 1px 0 #000;
    transition: all 0.2s;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}
.game-page-play-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 10px rgba(0,0,0,0.4);
}
/* === –ö–û–ù–ï–¶ –°–¢–ò–õ–ï–ô === */

/* === –°–¢–ò–õ–ò –î–õ–Ø –°–ü–ò–°–ö–ê –ü–û –ê–õ–§–ê–í–ò–¢–£ === */
        #alpha-list-overlay {
            position: fixed; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%; /* –ù–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω */
            background-color: rgba(40, 44, 52, 0.97); /* –ü–æ—á—Ç–∏ –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
            z-index: 1100; /* –í—ã—à–µ –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ */
            padding: 15px;
            box-sizing: border-box;
            display: flex; /* –ò—Å–ø–æ–ª—å–∑—É–µ–º flex –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏ */
            flex-direction: column;
            overscroll-behavior: contain; /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É body –ø–æ–¥ –æ–≤–µ—Ä–ª–µ–µ–º */
            /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å .hidden */
            transition: opacity 0.3s ease; /* –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ/–∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ (–µ—Å–ª–∏ —É–±–∏—Ä–∞—Ç—å/–¥–æ–±–∞–≤–ª—è—Ç—å –∫–ª–∞—Å—Å) */
        }

        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –æ–≤–µ—Ä–ª–µ–π –≤–∏–¥–∏–º (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º opacity)
        #alpha-list-overlay:not(.hidden) {
            opacity: 1;
            pointer-events: auto;
        } */

        .alpha-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-shrink: 0; /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–∂–∏–º–∞—Ç—å—Å—è */
            border-bottom: 1px solid rgba(255, 140, 0, 0.3); /* –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å */
            padding-bottom: 10px;
        }

        .alpha-list-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 16px; /* –ß—É—Ç—å –º–µ–Ω—å—à–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
            color: #fff;
            text-shadow: 1px 1px 0 #000;
            margin: 0;
        }

        .alpha-list-close-btn {
            background: none;
            border: none;
            color: #ff8c00; /* –û—Ä–∞–Ω–∂–µ–≤—ã–π, –∫–∞–∫ –∫–Ω–æ–ø–∫–∞ –ù–∞–∑–∞–¥ */
            font-size: 32px; /* –ö—Ä—É–ø–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫ */
            font-weight: bold;
            cursor: pointer;
            padding: 0 5px;
            line-height: 1;
            transition: color 0.2s;
        }
        .alpha-list-close-btn:hover {
            color: #ffae42; /* –°–≤–µ—Ç–ª–µ–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }

        .alpha-list-content {
            flex-grow: 1; /* –ó–∞–Ω–∏–º–∞–µ—Ç –≤—Å—ë –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –º–µ—Å—Ç–æ */
            overflow-y: auto; /* –í–∫–ª—é—á–∞–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ */
            margin-right: -5px; /* –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —à–∏—Ä–∏–Ω—ã —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ —Å–ø—Ä–∞–≤–∞ */
            padding-right: 5px; /* –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —à–∏—Ä–∏–Ω—ã —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ —Å–ø—Ä–∞–≤–∞ */
             /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
             scrollbar-width: thin; /* Firefox */
             scrollbar-color: #ff8c00 #555; /* Firefox - —Ü–≤–µ—Ç –ø–æ–ª–∑—É–Ω–∫–∞ –∏ —Ç—Ä–µ–∫–∞ */
        }
        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ –¥–ª—è Webkit (Chrome, Safari) */
        .alpha-list-content::-webkit-scrollbar {
          width: 8px;
        }
        .alpha-list-content::-webkit-scrollbar-track {
          background: #373b59; /* –§–æ–Ω —Ç—Ä–µ–∫–∞ */
          border-radius: 4px;
        }
        .alpha-list-content::-webkit-scrollbar-thumb {
          background-color: #ff8c00; /* –¶–≤–µ—Ç –ø–æ–ª–∑—É–Ω–∫–∞ */
          border-radius: 4px;
          border: 2px solid #373b59; /* –û—Ç—Å—Ç—É–ø –ø–æ–ª–∑—É–Ω–∫–∞ –æ—Ç –∫—Ä–∞–µ–≤ —Ç—Ä–µ–∫–∞ */
        }


        .alpha-list-item {
            display: block; /* –ß—Ç–æ–±—ã –∑–∞–Ω–∏–º–∞–ª –≤—Å—é —à–∏—Ä–∏–Ω—É */
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 8px;
            background-color: rgba(255, 255, 255, 0.05);
            color: #eee; /* –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ç–µ–∫—Å—Ç */
            border: none;
            border-radius: 8px;
            text-align: left;
            cursor: pointer;
            font-size: 15px;
            transition: background-color 0.2s, color 0.2s;
            box-sizing: border-box;
            font-family: inherit; /* –ù–∞—Å–ª–µ–¥—É–µ–º —à—Ä–∏—Ñ—Ç –æ—Ç body */
            line-height: 1.4;
        }

        .alpha-list-item:hover {
            background-color: rgba(255, 140, 0, 0.2); /* –û—Ä–∞–Ω–∂–µ–≤—ã–π —Ñ–æ–Ω –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
            color: #fff; /* –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }

        /* –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª—å –¥–ª—è –∫–ª–∞—Å—Å–∞ .hidden, –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç */
        .hidden {
            display: none !important;
        }
        /* === –ö–û–ù–ï–¶ –°–¢–ò–õ–ï–ô –î–õ–Ø –°–ü–ò–°–ö–ê –ü–û –ê–õ–§–ê–í–ò–¢–£ === */

/* –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ - —Ñ–∏–∫—Å–∏—Ä—É–µ–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∑–≤–µ–∑–¥—ã */
#game-page-favorite-btn {
    position: static; 
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    font-size: 28px;
    margin: 15px auto;
    border-radius: 50%;
    transition: all 0.3s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    border: none;
    background: rgba(30, 30, 50, 0.3);
    z-index: 5;
    cursor: pointer;
    line-height: 0; /* –í–∞–∂–Ω–æ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è */
    padding-bottom: 3px; /* –°–º–µ—â–∞–µ–º –∑–≤–µ–∑–¥—É –Ω–µ–º–Ω–æ–≥–æ –≤–≤–µ—Ä—Ö */
}

/* –°—Ç–∏–ª—å –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –∑–≤–µ–∑–¥—ã (–¥–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ) */
#game-page-favorite-btn.add-favorite {
    color: rgba(255, 255, 255, 0.7);
    background: linear-gradient(45deg, rgba(20, 20, 40, 0.4), rgba(40, 40, 70, 0.5));
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
}

/* –°—Ç–∏–ª—å –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –∑–≤–µ–∑–¥—ã (—É–∂–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º) */
#game-page-favorite-btn.remove-favorite {
    color: #FFD700; /* –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç */
    background: linear-gradient(45deg, rgba(40, 0, 40, 0.3), rgba(80, 40, 0, 0.4));
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
}

/* –≠—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
#game-page-favorite-btn:hover {
    transform: scale(1.08);
    box-shadow: 0 6px 10px rgba(0, 0, 0, 0.4);
}

#game-page-favorite-btn.add-favorite:hover {
    color: #FFD700;
    background: linear-gradient(45deg, rgba(30, 0, 30, 0.4), rgba(70, 40, 0, 0.5));
}

#game-page-favorite-btn.remove-favorite:hover {
    color: #FFF;
    background: rgba(180, 0, 0, 0.4);
}

/* –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä—ã */
.game-page-title-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    margin-bottom: 15px;
}

.game-page-title-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    margin-bottom: 15px;
}

.game-page-genre {
    align-self: flex-end; /* –ñ–∞–Ω—Ä —Å–ø—Ä–∞–≤–∞ */
    margin-top: 5px;      /* –û—Ç—Å—Ç—É–ø –æ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è */
    margin-left: auto;    /* –ü—Ä–∏–∂–∏–º–∞–µ–º –∂–∞–Ω—Ä –≤–ø—Ä–∞–≤–æ */
}

/* –°—Ç–∏–ª—å –¥–ª—è –∑–≤–µ–∑–¥—ã –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º —Å–ø–∏—Å–∫–µ */
.alpha-list-item .favorite-indicator {
    display: inline-block;
    color: #FFD700; /* –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç */
    margin-right: 8px;
    font-size: 18px;
    vertical-align: middle;
    position: relative;
    top: -1px; /* –ù–µ–±–æ–ª—å—à–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è */
}

</style>
</head>
<body>
    <div class="retro-container" id="retro-container">
        <div class="header">
             <div class="logo"> <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSIjRkYwMDAwIiBkPSJNNTAsMTBjMjIuMSwwLDQwLDE3LjksNDAsNDBTNzIuMSw5MCw1MCw5MFMxMCw3Mi4xLDEwLDUwUzI3LjksMTAsNTAsMTB6Ii8+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTM1LDM1aDMwdjMwSDM1VjM1eiIvPjxjaXJjbGUgZmlsbD0iI0ZGRkZGRiIgY3g9IjI1IiBjeT0iMzUiIHI9IjUiLz48Y2lyY2xlIGZpbGw9IiNGRkZGRkYiIGN4PSI3NSIgY3k9IjM1IiByPSI1Ii8+PGNpcmNsZSBmaWxsPSIjRkZGRkZGIiBjeD0iNzUiIGN5PSI2NSIgcj0iNSIvPjxjaXJjbGUgZmlsbD0iI0ZGRkZGRiIgY3g9IjI1IiBjeT0iNjUiIHI9IjUiLz48L3N2Zz4=" alt="Logo" /> <div class="logo-text"> <h1>Dendy</h1> <p>–†–µ—Ç—Ä–æ-—ç–º—É–ª—è—Ç–æ—Ä</p> </div> </div>
             <div class="navigation"> <button class="nav-button" title="–ì–ª–∞–≤–Ω–∞—è" id="home-nav-button">üè†</button> <button class="nav-button" title="–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä">üéÆ</button> <button class="nav-button" title="–ò–∑–±—Ä–∞–Ω–Ω–æ–µ">‚≠ê</button> </div>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ª—é–±–∏–º—ã—Ö –∏–≥—Ä..." />
            <button class="search-button">üîç</button>
        </div>

        <div id="main-content">
            <div class="categories">
                <div class="category-card" id="top-games-btn"> <div class="category-icon">üèÜ</div> <h3 class="category-title">–¢–û–ü –ò–ì–†</h3> </div>
                <div class="category-card" id="alpha-sort-btn"> <div class="category-icon">üî§</div> <h3 class="category-title">–ü–û –ê–õ–§–ê–í–ò–¢–£</h3> </div>
                <div class="category-card" id="random-btn"> <div class="category-icon">üé≤</div> <h3 class="category-title">–°–õ–£–ß–ê–ô–ù–ê–Ø</h3> </div>
                <div class="category-card" id="popular-btn"> <div class="category-icon">üìä</div> <h3 class="category-title">–ü–û–ü–£–õ–Ø–†–ù–´–ï</h3> </div>
                <div class="category-card" id="recent-games-btn"> <div class="category-icon">üîÑ</div> <h3 class="category-title">–ù–ï–î–ê–í–ù–ò–ï</h3> </div>
                <div class="category-card" id="share-btn"> <div class="category-icon">üì±</div> <h3 class="category-title">–ü–û–î–ï–õ–ò–¢–¨–°–Ø</h3> </div>
            </div>

            <div class="retro-hits">
                <h2 class="retro-hits-title">8-BIT –•–ò–¢–´</h2>
                <div class="retro-games-grid" id="retro-games-grid"></div>
            </div>

            <div class="rom-upload">
                <h2 class="rom-upload-title">–ó–ê–ì–†–£–ó–ò–¢–¨ ROM</h2>
                <div class="upload-box" id="upload-box">
                    <input type="file" id="fileInput" accept=".nes,.fds,.unif,.unf" class="file-input">
                    <div class="upload-text"> <strong>–ó–∞–≥—Ä—É–∑–∏—Ç–µ ROM-—Ñ–∞–π–ª</strong> –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∑–¥–µ—Å—å </div>
                </div>
            </div>

            <div class="featured-games">
                 <div class="featured-card"> <div class="featured-content"> <h3 class="featured-title">–ü–†–û–î–û–õ–ñ–ò–¢–¨ –ò–ì–†–£</h3> <img src="data/img/next.png" alt="–ü–†–û–î–û–õ–ñ–ò–¢–¨ –ò–ì–†–£" class="featured-image"> </div> <button class="arrow-button">‚ûú</button> </div>
                 <div class="featured-card" id="catalog-btn"> <div class="featured-content"> <h3 class="featured-title">–ö–ê–¢–ê–õ–û–ì –ò–ì–†</h3> <img src="data/img/catalog.png" alt="Dendy –∫–∞—Ç–∞–ª–æ–≥" class="featured-image"> </div> <button class="arrow-button">‚ûú</button> </div>
            </div>

            <div class="news-banner">
                 <div class="news-content">
                     <div class="news-icon">üì∞</div>
                     <div class="news-text">
                         <h3 class="news-title">–ù–û–í–û–°–¢–ò –ò –û–ë–ù–û–í–õ–ï–ù–ò–Ø</h3>
                         <p class="news-description">–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∏ –Ω–æ–≤—ã–º–∏ –∏–≥—Ä–∞–º–∏ –≤ –Ω–∞—à–µ–º –∫–∞–Ω–∞–ª–µ!</p>
                     </div>
                     </div>
                 <button class="arrow-button">‚ûú</button> </div>
        </div> 
        
        <div id="search-results-area" class="hidden"></div>

        <div id="game-page-area" class="hidden">
        </div>
        <div id="display" class="hidden"> <div id="game"></div> </div>

    </div> 
    <button id="backButton">&#10229;</button>
    <button id="reloadEmulatorButton">‚Üª</button>

    <div id="orientationMessage"> <button id="startPlayButton">–ù–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å</button> <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"> <path d="M17 2H7C5.9 2 5 2.9 5 4v16c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"></path> <path d="M12 18h.01"></path> </svg> <h2 style="margin: 15px 0;">–î–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞</h2> <p style="font-size: 16px; margin: 0 0 20px 0;">–ü–æ–≤–µ—Ä–Ω–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ</p> </div>
    <div id="loadingState" class="loading-state"> <div class="loading-spinner"></div> <p>–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —ç–º—É–ª—è—Ç–æ—Ä–∞...</p> </div>
    <div id="loadingIndicator" class="loading-indicator"></div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ -->
    <div id="alpha-list-overlay" class="hidden">
        <div class="alpha-list-header">
            <h2 class="alpha-list-title">–ü–æ–∏—Å–∫ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É</h2>
            <button class="alpha-list-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
        </div>
        <div class="alpha-list-content">
            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –∏–≥—Ä –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É -->
        </div>
    </div>

<script>

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∞–ø–∫–∏ EJS
window.EJS_pathtodata = "./data/"; // –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å —è–¥—Ä–∞–º–∏

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–±—Ä–∞–Ω–Ω—ã–º–∏ –∏–≥—Ä–∞–º–∏
const favoritesManager = {
    // –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∏–≥—Ä
    getFavorites: function() {
        try {
            return JSON.parse(localStorage.getItem('favoriteGames') || '[]');
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∏–≥—Ä:", e);
            return [];
        }
    },

    // –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ (–∏—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
    originalAddToFavorites: function(game) {
        try {
            const favorites = this.getFavorites();
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –∏–≥—Ä—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º
            if (!favorites.some(g => g.id === game.id)) {
                favorites.push({
                    id: game.id,
                    title: game.title,
                    romUrl: game.romUrl || `roms/catalog/${game.filename}`,
                    genre: game.genre || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
                });
                localStorage.setItem('favoriteGames', JSON.stringify(favorites));
                return true;
            }
            return false;
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ:", e);
            return false;
        }
    },

     // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ (–¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)
     addToFavorites: function(game) {
        const result = this.originalAddToFavorites(game); // –í—ã–∑—ã–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
        if (result && game && game.id) { // –ï—Å–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ
            // –°–æ–∑–¥–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            const favoriteEvent = new CustomEvent('favoriteAdded', {
                detail: { gameId: game.id, gameTitle: game.title }
            });
            document.dispatchEvent(favoriteEvent); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ
            console.log("AchievementSystem: favoriteAdded event dispatched for", game.id); // –û—Ç–ª–∞–¥–∫–∞
        }
        return result;
     },

    // –£–¥–∞–ª–∏—Ç—å –∏–≥—Ä—É –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
    removeFromFavorites: function(gameId) {
        try {
            let favorites = this.getFavorites();
            favorites = favorites.filter(g => g.id !== gameId);
            localStorage.setItem('favoriteGames', JSON.stringify(favorites));
            return true;
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:", e);
            return false;
        }
    },

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –∏–≥—Ä–∞ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º
    isInFavorites: function(gameId) {
        try {
            const favorites = this.getFavorites();
            return favorites.some(g => g.id === gameId);
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:", e);
            return false;
        }
    }
};

// --- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ---
const enableDebug = false;
const enableThreads = false;
const defaultCore = "nes";
const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
window.libraryGames = []; // –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∏–∂–µ
window.fullCatalogGames = []; // –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∏–∂–µ
window.orientationShown = false;
window.currentRomUrl = null;
window.currentGameName = null;
window.isEmulatorActive = false;
let exitDialogReturnTarget = null; // –ö—É–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –≤—ã—Ö–æ–¥–∞

// --- –ì–õ–û–ë–ê–õ–¨–ù–û –î–û–°–¢–£–ü–ù–´–ï –§–£–ù–ö–¶–ò–ò (–≤—ã–Ω–µ—Å–µ–Ω—ã –∏–∑ DOMContentLoaded) ---

// –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞—É–¥–∏–æ (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
function stopAllAudio() {
    console.log("Stopping all audio sources...");
    // 1. –ó–∞–∫—Ä—ã–≤–∞–µ–º AudioContext —ç–º—É–ª—è—Ç–æ—Ä–∞ (–±–æ–ª–µ–µ —Ç—â–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫)
    let audioContextPaths = [
        window.EJS_emulator?.audioContext,
        window.EJS_emulator?.Module?.audioContext,
        window.EJS_emulator?.core?.audioContext,
        window.EJS_webaudio?.audioContext,
        window.EJS_emulator?.sound?.audioContext,
        window?.EM_signalSystemHandlers?.audioContext,
        window.ejs_app?.audioContext
    ];
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—É—Ç–∏ –∫ AudioContext –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º –∏—Ö
    audioContextPaths.forEach(ctx => {
        if (ctx && typeof ctx.close === 'function') {
            try {
                ctx.close().catch(e => console.warn("Could not close AudioContext:", e));
                console.log("Successfully closed an AudioContext");
            } catch (e) {
                console.warn("Error closing AudioContext:", e);
            }
        }
    });
    // 2. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –∞—É–¥–∏–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
    document.querySelectorAll('audio, video').forEach(el => {
        try {
            if (!el.paused) {
                el.pause();
                console.log("Paused audio/video element");
            }
            // –£–¥–∞–ª—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
            el.src = '';
            el.removeAttribute('src');
        } catch (e) {
            console.warn("Error pausing media element:", e);
        }
    });
    // 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å–ª–∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –µ—Å—Ç—å –∞—É–¥–∏–æ–º–æ–¥—É–ª–∏ —ç–º—É–ª—è—Ç–æ—Ä–∞ –∏ –æ—Ç–∫–ª—é—á–∞–µ–º –∏—Ö
    if (window.EJS_emulator) {
        try {
            // –û—Ç–∫–ª—é—á–∞–µ–º –∑–≤—É–∫ –≤ —ç–º—É–ª—è—Ç–æ—Ä–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –º–µ—Ç–æ–¥
            if (typeof window.EJS_emulator.muteAudio === 'function') {
                window.EJS_emulator.muteAudio();
            }
            // –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —ç–º—É–ª—è—Ç–æ—Ä—ã –∏–º–µ—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–≤—É–∫–æ–º
            if (window.EJS_emulator.setVolume) {
                window.EJS_emulator.setVolume(0);
            }
        } catch (e) {
            console.warn("Error muting emulator audio:", e);
        }
    }

    // 4. –ö–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –Ω–µ–º–æ–π AudioContext
    try {
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        if (AudioContext) {
            const silentContext = new AudioContext();
            // –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º –µ–≥–æ
            silentContext.close().catch(e => console.log("Silent context close error:", e));
        }
    } catch (e) {
        console.warn("Failed to create silent audio context:", e);
    }

    console.log("All audio stopping procedures completed");
}

// –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç–º—É–ª—è—Ç–æ—Ä–∞
function stopEmulator() {
    // 1. –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∞—É–¥–∏–æ-–∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
    stopAllAudio();
    // 2. –®—Ç–∞—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç–º—É–ª—è—Ç–æ—Ä–∞
    if (typeof EJS_terminate === 'function') {
        try {
            EJS_terminate();
            console.log("EJS_terminate called.");
        } catch (e) {
            console.error("Error calling EJS_terminate:", e);
        }
    } else {
        console.log("EJS_terminate function not found.");
    }

    // 3. –£–¥–∞–ª—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã Canvas –∏ WebGL-–∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
    try {
        const gameDiv = document.getElementById("game");
        if (gameDiv) {
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ canvas –≤–Ω—É—Ç—Ä–∏ game-div
            const canvases = gameDiv.querySelectorAll('canvas');
            canvases.forEach(canvas => {
                // –£–Ω–∏—á—Ç–æ–∂–∞–µ–º WebGL –∫–æ–Ω—Ç–µ–∫—Å—Ç –µ—Å–ª–∏ –µ—Å—Ç—å
                const gl = canvas.getContext('webgl') || canvas.getContext('webgl2');
                if (gl) {
                    gl.getExtension('WEBGL_lose_context')?.loseContext();
                }
                // –û—á–∏—â–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ canvas
                const ctx = canvas.getContext('2d');
                if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);
            });
            // –û—á–∏—â–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            gameDiv.innerHTML = "";
        }
    } catch (err) {
        console.error("Error cleaning up WebGL contexts:", err);
    }

    // 4. –£–¥–∞–ª—è–µ–º —Å–∫—Ä–∏–ø—Ç —ç–º—É–ª—è—Ç–æ—Ä–∞
    const emulatorScript = document.getElementById("emulatorScript");
    if (emulatorScript) emulatorScript.remove();

    window.isEmulatorActive = false; // –ü–µ—Ä–µ–º–µ—Å—Ç–∏–ª —Å—é–¥–∞, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
    console.log("Emulator stopped completely.");
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
function showMainContent() {
    const searchResultsArea = document.getElementById('search-results-area');
    const mainContent = document.getElementById('main-content');
    const display = document.getElementById('display');
    const backButton = document.getElementById('backButton');
    const reloadEmulatorButton = document.getElementById('reloadEmulatorButton');
    const alphaListOverlay = document.getElementById('alpha-list-overlay');
    const searchInput = document.querySelector('.search-input');
    const initialRetroGamesGrid = document.getElementById('retro-games-grid'); // –î–æ–±–∞–≤–ª–µ–Ω–æ

    searchResultsArea.classList.add('hidden');
    document.getElementById('game-page-area').classList.add('hidden');
    if (alphaListOverlay) alphaListOverlay.classList.add('hidden');

    document.body.style.overflow = ''; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª
    display.classList.add('hidden'); // –°–∫—Ä—ã–≤–∞–µ–º —ç–º—É–ª—è—Ç–æ—Ä
    backButton.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ù–∞–∑–∞–¥ —ç–º—É–ª—è—Ç–æ—Ä–∞
    reloadEmulatorButton.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —ç–º—É–ª—è—Ç–æ—Ä–∞

    mainContent.classList.remove('hidden');
    if (searchInput) searchInput.value = ''; // –û—á–∏—â–∞–µ–º –ø–æ–∏—Å–∫

    // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è renderGamesGrid –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–µ –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç
    // –ü–æ–∫–∞ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ renderGamesGrid –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞
    if (typeof renderGamesGrid === 'function' && initialRetroGamesGrid) {
         renderGamesGrid(window.libraryGames, initialRetroGamesGrid); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ö–∏—Ç—ã (–æ–±–Ω–æ–≤–ª—è–µ–º –∑–≤–µ–∑–¥—ã)
    } else {
        console.warn("renderGamesGrid –∏–ª–∏ initialRetroGamesGrid –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è showMainContent");
    }
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–µ–∫—Ü–∏–∏ (–ù–µ–¥–∞–≤–Ω–∏–µ, –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ, –¢–û–ü, –ö–∞—Ç–∞–ª–æ–≥)
function showGameListSection(gamesList, sectionTitle) {
     const searchResultsArea = document.getElementById('search-results-area');
     const mainContent = document.getElementById('main-content');

     searchResultsArea.innerHTML = ''; // –û—á–∏—â–∞–µ–º
     const titleElement = document.createElement('h2');
     titleElement.className = 'search-results-title';
     titleElement.textContent = sectionTitle;
     searchResultsArea.appendChild(titleElement);

     const backToMainButton = document.createElement('button');
     backToMainButton.className = 'back-to-main-button';
     backToMainButton.textContent = '‚Äπ –ù–∞–∑–∞–¥';
     backToMainButton.onclick = showMainContent; // –¢–µ–ø–µ—Ä—å showMainContent –¥–æ—Å—Ç—É–ø–Ω–∞
     searchResultsArea.appendChild(backToMainButton);

     const resultsGrid = document.createElement('div');
     resultsGrid.className = 'retro-games-grid';
     searchResultsArea.appendChild(resultsGrid);

     // –ù—É–∂–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ renderGamesGrid –∏ renderCatalogGrid –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –∏—Ö
     // –ü–æ–∫–∞ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –æ–Ω–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã
     if (sectionTitle.toLowerCase().includes("–∫–∞—Ç–∞–ª–æ–≥")) {
        if (typeof renderCatalogGrid === 'function') {
            renderCatalogGrid(gamesList, resultsGrid);
        } else {
             console.warn("renderCatalogGrid –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è showGameListSection");
        }
     } else {
        if (typeof renderGamesGrid === 'function') {
            renderGamesGrid(gamesList, resultsGrid);
        } else {
             console.warn("renderGamesGrid –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è showGameListSection");
        }
     }

     mainContent.classList.add('hidden'); // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
     searchResultsArea.classList.remove('hidden'); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é
     window.scrollTo(0, 0); // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞
function showCatalog(catalogData, catalogTitle) {
    showGameListSection(catalogData, catalogTitle);
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∏–≥—Ä
function showPopularGames() {
    // –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ popularGamesList
    if (window.popularGamesList) {
        showGameListSection(window.popularGamesList, '–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–≥—Ä—ã');
    } else {
        console.warn("popularGamesList –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è showPopularGames");
    }
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¢–û–ü –∏–≥—Ä
function showTopGames() {
    // –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ topGamesList
    if (window.topGamesList) {
        showGameListSection(window.topGamesList, '–¢–û–ü –ò–ì–†');
    } else {
         console.warn("topGamesList –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è showTopGames");
    }
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∏–≥—Ä
function showFavorites() {
    const favorites = favoritesManager.getFavorites();
    showGameListSection(favorites, '–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã');
}


// --- –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ –≤—ã—Ö–æ–¥–∞ ---
function initExitGameDialog() {
    const dialog = document.getElementById('exit-game-dialog');
    const yesButton = document.getElementById('exit-dialog-yes');
    const noButton = document.getElementById('exit-dialog-no');
    const display = document.getElementById('display'); // –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ display
    const backButton = document.getElementById('backButton'); // –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø
    const reloadEmulatorButton = document.getElementById('reloadEmulatorButton'); // –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø

    if (!dialog || !yesButton || !noButton || !display || !backButton || !reloadEmulatorButton) {
        console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞.");
        return;
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–î–∞"
    yesButton.addEventListener('click', () => {
        console.log("–ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ –î–ê");
        hideExitDialog();

        if (window.isEmulatorActive) {
            console.log("–≠–º—É–ª—è—Ç–æ—Ä –∞–∫—Ç–∏–≤–µ–Ω, –ø—ã—Ç–∞—é—Å—å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å...");
            stopEmulator(); // –í—ã–∑—ã–≤–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
            console.log("stopEmulator() –≤—ã–∑–≤–∞–Ω (–∏–ª–∏ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è)");
            display.classList.add('hidden');
            backButton.style.display = 'none';
            reloadEmulatorButton.style.display = 'none';
            window.currentRomUrl = null;
            window.currentGameName = null;
            window.orientationShown = false;
            // isEmulatorActive —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ stopEmulator
            document.body.classList.remove('fullscreen-mode');
            console.log("–°–æ—Å—Ç–æ—è–Ω–∏–µ —ç–º—É–ª—è—Ç–æ—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–æ");
        } else {
            console.log("–≠–º—É–ª—è—Ç–æ—Ä –ù–ï –∞–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –î–ê (?)");
        }

        console.log("–ü–µ—Ä–µ—Ö–æ–∂—É –∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏, target:", exitDialogReturnTarget);
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        switch(exitDialogReturnTarget) {
            case 'home':
                showMainContent(); // –í—ã–∑—ã–≤–∞–µ–º –≥–ª–æ–±. —Ñ—É–Ω–∫—Ü–∏—é
                break;
            case 'catalog':
                 // –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ fullCatalogGames
                if(window.fullCatalogGames) {
                    showCatalog(window.fullCatalogGames, "–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä"); // –í—ã–∑—ã–≤–∞–µ–º –≥–ª–æ–±. —Ñ—É–Ω–∫—Ü–∏—é
                } else {
                     console.warn("window.fullCatalogGames –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤–æ–∑–≤—Ä–∞—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é");
                     showMainContent();
                }
                break;
            case 'favorites':
                showFavorites(); // –í—ã–∑—ã–≤–∞–µ–º –≥–ª–æ–±. —Ñ—É–Ω–∫—Ü–∏—é
                break;
            default:
                showMainContent(); // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
        }

        document.body.style.overflow = ''; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª
        window.scrollTo(0, 0); // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–µ—Ç"
    noButton.addEventListener('click', () => {
        hideExitDialog();
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —Ñ–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    dialog.addEventListener('click', (event) => {
        if (event.target === dialog) {
            hideExitDialog();
        }
    });
    console.log("Exit game dialog initialized");
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –¥–∏–∞–ª–æ–≥–∞
function showExitDialog(returnTarget) {
    const dialog = document.getElementById('exit-game-dialog');
    if (!dialog) return;

    exitDialogReturnTarget = returnTarget; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫—É–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏
    dialog.classList.remove('hidden');
    document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –¥–∏–∞–ª–æ–≥–∞
function hideExitDialog() {
    const dialog = document.getElementById('exit-game-dialog');
    if (!dialog) return;

    dialog.classList.add('hidden');
    document.body.style.overflow = ''; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª –µ—Å–ª–∏ –Ω–µ –≤ —ç–º—É–ª—è—Ç–æ—Ä–µ
    if (window.isEmulatorActive) {
        document.body.style.overflow = 'hidden'; // –û—Å—Ç–∞–≤–ª—è–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –µ—Å–ª–∏ —ç–º—É–ª—è—Ç–æ—Ä –∞–∫—Ç–∏–≤–µ–Ω
    }
}

// –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
function updateNavigationHandlers() {
    const homeNavButton = document.getElementById('home-nav-button');
    const catalogNavButton = document.querySelector('.navigation .nav-button[title="–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä"]');
    const favoritesNavButton = document.querySelector('.navigation .nav-button[title="–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"]');

    if (homeNavButton) {
        // –ó–∞–º–µ–Ω—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
        const newHomeButton = homeNavButton.cloneNode(true);
        homeNavButton.parentNode.replaceChild(newHomeButton, homeNavButton);

        newHomeButton.addEventListener('click', () => {
            if (window.isEmulatorActive) {
                showExitDialog('home');
            } else {
                showMainContent(); // –í—ã–∑—ã–≤–∞–µ–º –≥–ª–æ–±. —Ñ—É–Ω–∫—Ü–∏—é
            }
        });
    }

    if (catalogNavButton) {
        // –ó–∞–º–µ–Ω—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
        const newCatalogButton = catalogNavButton.cloneNode(true);
        catalogNavButton.parentNode.replaceChild(newCatalogButton, catalogNavButton);

        newCatalogButton.addEventListener('click', () => {
            if (window.isEmulatorActive) {
                showExitDialog('catalog');
            } else {
                // –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ fullCatalogGames
                if(window.fullCatalogGames) {
                     showCatalog(window.fullCatalogGames, "–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä"); // –í—ã–∑—ã–≤–∞–µ–º –≥–ª–æ–±. —Ñ—É–Ω–∫—Ü–∏—é
                } else {
                     console.warn("window.fullCatalogGames –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∫–∞—Ç–∞–ª–æ–≥–∞, –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é");
                     showMainContent();
                }
            }
        });
    }

    if (favoritesNavButton) {
        // –ó–∞–º–µ–Ω—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
        const newFavoritesButton = favoritesNavButton.cloneNode(true);
        favoritesNavButton.parentNode.replaceChild(newFavoritesButton, favoritesNavButton);

        newFavoritesButton.addEventListener('click', () => {
            if (window.isEmulatorActive) {
                showExitDialog('favorites');
            } else {
                showFavorites(); // –í—ã–∑—ã–≤–∞–µ–º –≥–ª–æ–±. —Ñ—É–Ω–∫—Ü–∏—é
            }
        });
    }

    console.log("Navigation handlers updated");
}


// --- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–π –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM ---
document.addEventListener('DOMContentLoaded', function() {
    // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    const fileInput = document.getElementById('fileInput');
    const uploadBox = document.getElementById('upload-box');
    const display = document.getElementById('display');
    const backButton = document.getElementById('backButton');
    const reloadEmulatorButton = document.getElementById('reloadEmulatorButton');
    const startPlayButton = document.getElementById('startPlayButton');
    const orientationMessage = document.getElementById('orientationMessage');
    const loadingState = document.getElementById('loadingState');
    const mainContent = document.getElementById('main-content');
    const initialRetroGamesGrid = document.getElementById('retro-games-grid');
    const searchInput = document.querySelector('.search-input');
    const searchButton = document.querySelector('.search-button');
    const searchResultsArea = document.getElementById('search-results-area');
    const recentGamesButton = document.getElementById('recent-games-btn');
    const homeNavButton = document.getElementById('home-nav-button'); // –ù—É–∂–µ–Ω –¥–ª—è showMainContent –∏ updateNavigationHandlers
    const shareButton = document.getElementById('share-btn');
    const alphaSortButton = document.getElementById('alpha-sort-btn');
    const catalogButton = document.getElementById('catalog-btn'); // –î–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–∞—Ç–∞–ª–æ–≥–∞
    const popularButton = document.getElementById('popular-btn');
    const randomButton = document.getElementById('random-btn');
    const catalogNavButton = document.querySelector('.navigation .nav-button[title="–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä"]'); // –î–ª—è –≤–µ—Ä—Ö–Ω–µ–π –∫–Ω–æ–ø–∫–∏
    const topGamesButton = document.getElementById('top-games-btn');
    const favoritesNavButton = document.querySelector('.navigation .nav-button[title="–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"]'); // –î–ª—è –≤–µ—Ä—Ö–Ω–µ–π –∫–Ω–æ–ø–∫–∏

    // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
    const alphaListOverlay = document.getElementById('alpha-list-overlay');
    const alphaListContent = alphaListOverlay ? alphaListOverlay.querySelector('.alpha-list-content') : null;
    const alphaListCloseBtn = alphaListOverlay ? alphaListOverlay.querySelector('.alpha-list-close-btn') : null;

    // –°–ø–∏—Å–æ–∫ –∏–≥—Ä –¥–ª—è "8-BIT –•–ò–¢–´"
    const initialLibraryGames = [
        { id: "mario", title: "Super Mario Bros", romUrl: "roms/Mario.nes" },
        { id: "contra", title: "Contra", romUrl: "roms/Contra.nes" },
        { id: "battle_city", title: "Battle City", romUrl: "roms/Battle City.nes" },
        { id: "duck_hunt", title: "Duck Hunt", romUrl: "roms/Duck Hunt.nes" },
        { id: "tetris", title: "Tetris", romUrl: "roms/Tetris.nes" },
        { id: "ninja_gaiden", title: "Ninja Gaiden", romUrl: "roms/Ninja Gaiden.nes" }
    ];

    const generateId = (filename) => {
        let namePart = filename.split('.').slice(0, -1).join('.');
        namePart = namePart.replace(/^(onlain-igrok\.rf_\d+_|onlain-igrok\.rf_|487_)/, '');
        return namePart.toLowerCase().replace(/[^a-z0-9_]/g, '_').replace(/_+/g, '_').replace(/^_|_$/g, '');
    };

    const gameDetailsData = {
         "Super Mario Bros": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä", description: "–ö–ª–∞—Å—Å–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä–æ–≤. –ü–æ–º–æ–≥–∏ –ú–∞—Ä–∏–æ —Å–ø–∞—Å—Ç–∏ –ø—Ä–∏–Ω—Ü–µ—Å—Å—É, –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—è –≤—Ä–∞–≥–æ–≤ –∏ –ª–æ–≤—É—à–∫–∏ –≤ –≤–æ–ª—à–µ–±–Ω–æ–º –º–∏—Ä–µ."},
         "Contra": { genre: "–≠–∫—à–µ–Ω", description: "–í–∑—Ä—ã–≤–Ω–æ–π –±–æ–µ–≤–∏–∫. –ü—Ä–æ–π–¥–∏ –æ–≥–æ–Ω—å –∏ –≤–æ–¥—É –≤ —Ä–æ–ª–∏ —ç–ª–∏—Ç–Ω–æ–≥–æ –±–æ–π—Ü–∞, —Å—Ä–∞–∂–∞—è—Å—å —Å –ø—Ä–∏—à–µ–ª—å—Ü–∞–º–∏ –∏ —Ä–æ–±–æ—Ç–∞–º–∏."},
         "Battle City": { genre: "–ê—Ä–∫–∞–¥–∞", description: "–ó–∞—â–∏—Ç–∏ —Å–≤–æ—é –±–∞–∑—É. –£–ø—Ä–∞–≤–ª—è–π —Ç–∞–Ω–∫–æ–º, —É–Ω–∏—á—Ç–æ–∂–∞–π –≤—Ä–∞–≥–æ–≤ –∏ —Å—Ç—Ä–æ–π —É–∫—Ä–µ–ø–ª–µ–Ω–∏—è –Ω–∞ –ø—É—Ç–∏ –∫ –ø–æ–±–µ–¥–µ."},
         "Duck Hunt": { genre: "–®—É—Ç–µ—Ä (Light Gun)", description: "–û—Ö–æ—Ç–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è. –ü—Ä–∏—Ü–µ–ª—å—Å—è –∏ —Å—Ç—Ä–µ–ª—è–π –ø–æ —É—Ç–∫–∞–º —Å –ø–æ–º–æ—â—å—é —Å–≤–µ—Ç–æ–≤–æ–≥–æ –ø–∏—Å—Ç–æ–ª–µ—Ç–∞."},
         "Tetris": { genre: "–ü–∞–∑–ª", description: "–ì–æ–ª–æ–≤–æ–ª–æ–º–∫–∞ –Ω–∞ –≤–µ–∫–∞. –°–æ—Å—Ç–∞–≤–ª—è–π –ª–∏–Ω–∏–∏ –∏–∑ –ø–∞–¥–∞—é—â–∏—Ö —Ñ–∏–≥—É—Ä –∏ –Ω–µ –¥–∞–π —ç–∫—Ä–∞–Ω—É –∑–∞–ø–æ–ª–Ω–∏—Ç—å—Å—è."},
         "Ninja Gaiden": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–°—Ç–∞–Ω—å —Ç–µ–Ω—å—é. –£–ø—Ä–∞–≤–ª—è–π –Ω–∏–Ω–¥–∑—è –†—é –∏ –ø–æ–±–µ–∂–¥–∞–π –≤—Ä–∞–≥–æ–≤ –≤ –Ω–∞—Å—ã—â–µ–Ω–Ω–æ–º —ç–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä–µ —Å —Å—é–∂–µ—Ç–æ–º."},
         "Teenage Mutant Ninja Turtles III: The Manhattan Project": { genre: "–≠–∫—à–µ–Ω", description: "–ß–µ—Ä–µ–ø–∞—Ö–∏ —Å–Ω–æ–≤–∞ –≤ –¥–µ–ª–µ! –°–ø–∞—Å–∏ –ù—å—é-–ô–æ—Ä–∫ –æ—Ç –∑–ª–æ–¥–µ—è –®—Ä–µ–¥–¥–µ—Ä–∞ –∏ –µ–≥–æ –∞—Ä–º–∏–∏. –ò–≥—Ä–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤ —Å –¥–∏–Ω–∞–º–∏—á–Ω—ã–º –≥–µ–π–º–ø–ª–µ–µ–º, —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ –≤—Ä–∞–≥–∞–º–∏ –∏ –±–æ—Å—Å–∞–º–∏."},
         "Battletoads & Double Dragon": { genre: "–≠–∫—à–µ–Ω", description: "–ö—Ä—É—Ç–æ–π –∫—Ä–æ—Å—Å–æ–≤–µ—Ä –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã—Ö –≥–µ—Ä–æ–µ–≤! –°—Ä–∞–∂–∞–π—Å—è –ø—Ä–æ—Ç–∏–≤ –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –∑–ª–æ–¥–µ–µ–≤, –∏—Å–ø–æ–ª—å–∑—É—è –º–æ—â–Ω—ã–µ —É–¥–∞—Ä—ã –∏ –∫–æ–º–±–æ. –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π –∏ —è—Ä–∫–∞—è –≥—Ä–∞—Ñ–∏–∫–∞."},
         "Battletoads (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–≠–∫—à–µ–Ω", description: "–ó–Ω–∞–º–µ–Ω–∏—Ç—ã–µ –±–æ–µ–≤—ã–µ –∂–∞–±—ã –∏–¥—É—Ç –Ω–∞ –±–æ–π —Å–æ –∑–ª–æ–º! –≠–∫—à–µ–Ω —Å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏, —Å–ª–æ–∂–Ω—ã–º–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞–º–∏ –∏ –Ω–∞–ø—Ä—è–∂—ë–Ω–Ω—ã–º –≥–µ–π–º–ø–ª–µ–µ–º. –ò–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è –∏–≥—Ä—ã –≤–¥–≤–æ—ë–º."},
         "Bucky O'Hare": { genre: "–≠–∫—à–µ–Ω", description: "–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –∫—Ä–æ–ª–∏–∫ –ë–∞–∫–∏ –∏ –µ–≥–æ –∫–æ–º–∞–Ω–¥–∞ –≤ –æ–ø–∞—Å–Ω–æ–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–∏! –°–ª–æ–∂–Ω—ã–µ —É—Ä–æ–≤–Ω–∏, —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –≥–µ—Ä–æ–∏ –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π —Å—é–∂–µ—Ç –¥–µ–ª–∞—é—Ç –∏–≥—Ä—É –∫—É–ª—å—Ç–æ–≤–æ–π."},
         "Captain America and the Avengers": { genre: "–≠–∫—à–µ–Ω", description: "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ –∫–æ–º–∞–Ω–¥–µ –ú—Å—Ç–∏—Ç–µ–ª–µ–π –∏ —Å–ø–∞—Å–∏ –º–∏—Ä –æ—Ç —Å—É–ø–µ—Ä–∑–ª–æ–¥–µ–µ–≤. –ò–≥—Ä–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ –∞–∫—Ç–∏–≤–Ω—ã–º —ç–∫—à–µ–Ω–æ–º."},
         "Contra Force": { genre: "–≠–∫—à–µ–Ω", description: "–ó–Ω–∞–º–µ–Ω–∏—Ç–∞—è —Å–µ—Ä–∏—è Contra –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è! –£–Ω–∏—á—Ç–æ–∂–∞–π –≤—Ä–∞–≥–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã –æ—Ä—É–∂–∏—è –∏ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–π –¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–∞–Ω–¥—ã –±–æ–π—Ü–æ–≤."},
         "Jackal": { genre: "–≠–∫—à–µ–Ω", description: "–í–æ–µ–Ω–Ω—ã–π —ç–∫—à–µ–Ω, –≥–¥–µ —Ç—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å –¥–∂–∏–ø–æ–º –∏ —Å–ø–∞—Å–∞–µ—à—å –∑–∞–ª–æ–∂–Ω–∏–∫–æ–≤. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Ä–∞–≥–æ–≤ –∏ –Ω–µ–ø—Ä–æ—Å—Ç—ã–µ –º–∏—Å—Å–∏–∏ –¥–µ–ª–∞—é—Ç –∏–≥—Ä—É —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π –∏ –¥–∏–Ω–∞–º–∏—á–Ω–æ–π."},
         "Monster in My Pocket": { genre: "–≠–∫—à–µ–Ω", description: "–°—Ä–∞–∂–µ–Ω–∏—è –º–∏–Ω–∏–∞—Ç—é—Ä–Ω—ã—Ö –º–æ–Ω—Å—Ç—Ä–æ–≤ –≤ –æ–±—ã—á–Ω–æ–º –¥–æ–º–µ! –î–∏–Ω–∞–º–∏—á–Ω—ã–π —ç–∫—à–µ–Ω —Å —è—Ä–∫–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º —É—Ä–æ–≤–Ω–µ–π."},
         "RoboCop": { genre: "–≠–∫—à–µ–Ω", description: "–ó–Ω–∞–º–µ–Ω–∏—Ç—ã–π —Ä–æ–±–æ—Ç-–ø–æ–ª–∏—Ü–µ–π—Å–∫–∏–π –±–æ—Ä–µ—Ç—Å—è —Å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é. –°—É—Ä–æ–≤—ã–µ —Å—Ä–∞–∂–µ–Ω–∏—è, –∂–µ—Å—Ç–æ–∫–∏–µ –≤—Ä–∞–≥–∏ –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏."},
         "RoboCop 2": { genre: "–≠–∫—à–µ–Ω", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –±–æ—Ä—å–±—ã –†–æ–±–æ–∫–æ–ø–∞ —Å –ø—Ä–µ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é. –ù–æ–≤—ã–µ –≤—Ä–∞–≥–∏ –∏ —É—Ä–æ–≤–Ω–∏."},
         "RoboCop 3": { genre: "–≠–∫—à–µ–Ω", description: "–†–æ–±–æ–∫–æ–ø —Å–Ω–æ–≤–∞ –Ω–∞ —Å—Ç—Ä–∞–∂–µ –∑–∞–∫–æ–Ω–∞. –¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å —Å–∞–≥–∏ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π –∏ –≥–µ–π–º–ø–ª–µ–µ–º."},
         "Shadow of the Ninja": { genre: "–≠–∫—à–µ–Ω", description: "–≠–∫—à–µ–Ω –æ –±–µ—Å—Å—Ç—Ä–∞—à–Ω—ã—Ö –Ω–∏–Ω–¥–∑—è, —Å—Ä–∞–∂–∞—é—â–∏—Ö—Å—è –ø—Ä–æ—Ç–∏–≤ —Å–∏–ª –∑–ª–∞. –û—Ç–ª–∏—á–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞, –ø–ª–∞–≤–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–µ —É—Ä–æ–≤–Ω–∏."},
         "Silkworm": { genre: "–≠–∫—à–µ–Ω", description: "–î–∏–Ω–∞–º–∏—á–Ω—ã–π —ç–∫—à–µ–Ω —Å –≤–µ—Ä—Ç–æ–ª—ë—Ç–æ–º –∏ –¥–∂–∏–ø–æ–º, —Å—Ä–∞–∂–∞—é—â–∏–º–∏—Å—è –ø—Ä–æ—Ç–∏–≤ –±–µ—Å—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤. –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤."},
         "Super C (Super Contra)": { genre: "–≠–∫—à–µ–Ω", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–π Contra —Å –µ—â—ë –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤—Ä–∞–≥–æ–≤, –æ—Ä—É–∂–∏—è –∏ —ç–ø–∏—á–Ω—ã—Ö –±–æ—Å—Å–æ–≤."},
         "Tokkyuu Shirei Solbrain": { genre: "–≠–∫—à–µ–Ω", description: "–Ø–ø–æ–Ω—Å–∫–∏–π —Å—É–ø–µ—Ä–≥–µ—Ä–æ–π —Å–ø–∞—Å–∞–µ—Ç –≥–æ—Ä–æ–¥ –æ—Ç –∑–ª–æ–¥–µ–µ–≤. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —ç–∫—à–µ–Ω –≤ –ª—É—á—à–∏—Ö —Ç—Ä–∞–¥–∏—Ü–∏—è—Ö —è–ø–æ–Ω—Å–∫–∏—Ö –±–æ–µ–≤–∏–∫–æ–≤."},
         "S.C.A.T.: Special Cybernetic Attack Team": { genre: "–≠–∫—à–µ–Ω", description: "–õ–µ—Ç–∞—é—â–∏–π —ç–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä (Final Mission)."},
         "Alien 3": { genre: "–≠–∫—à–µ–Ω", description: "–≠–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä –ø–æ –º–æ—Ç–∏–≤–∞–º —Ñ–∏–ª—å–º–∞ –ß—É–∂–æ–π 3. –°–ª–æ–∂–Ω—ã–µ –ª–∞–±–∏—Ä–∏–Ω—Ç—ã –∏ –æ–ø–∞—Å–Ω—ã–µ –∫—Å–µ–Ω–æ–º–æ—Ä—Ñ—ã."},
         "Adventure Island": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í–µ—Å—ë–ª—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –ø–∞—Ä–Ω—è –≤ —à–∞–ø–æ—á–∫–µ, —Å—Ä–∞–∂–∞—é—â–µ–≥–æ—Å—è —Å –º–æ–Ω—Å—Ç—Ä–∞–º–∏ –Ω–∞ –æ—Å—Ç—Ä–æ–≤–µ. –ü—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –º–Ω–æ–≥–æ —É—Ä–æ–≤–Ω–µ–π –∏ —è—Ä–∫–∞—è –≥—Ä–∞—Ñ–∏–∫–∞."},
         "Adventure Island II": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ –æ—Å—Ç—Ä–æ–≤–µ —Å –Ω–æ–≤—ã–º–∏ –¥–∏–Ω–æ–∑–∞–≤—Ä–∞–º–∏-–ø–æ–º–æ—â–Ω–∏–∫–∞–º–∏."},
         "Adventure Island III": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å —Å –µ—â—ë –±–æ–ª—å—à–∏–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º —É—Ä–æ–≤–Ω–µ–π –∏ –≤—Ä–∞–≥–æ–≤."},
         "Adventure Island IV": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ß–µ—Ç–≤—ë—Ä—Ç–∞—è —á–∞—Å—Ç—å, –≤—ã–ø—É—â–µ–Ω–Ω–∞—è —Ç–æ–ª—å–∫–æ –≤ –Ø–ø–æ–Ω–∏–∏, —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ RPG."},
         "Chip 'n Dale: Rescue Rangers (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ß–∏–ø –∏ –î–µ–π–ª –≤ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö! –£–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π, –∫–æ–º–∞–Ω–¥–Ω–∞—è –∏–≥—Ä–∞ –∏ –º–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω—è—Ö."},
         "Chip 'n Dale: Rescue Rangers 2 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Shedevr)": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π —Å–ø–∞—Å–∞—Ç–µ–ª–µ–π —Å –Ω–æ–≤—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏."},
         "Darkwing Duck": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ß—ë—Ä–Ω—ã–π –ø–ª–∞—â –≤—ã—Ö–æ–¥–∏—Ç –Ω–∞ –∑–∞—â–∏—Ç—É –≥–æ—Ä–æ–¥–∞ –æ—Ç –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤. –Ø—Ä–∫–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏ —É–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ."},
         "Duck Tales": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–î—è–¥—é—à–∫–∞ –°–∫—Ä—É–¥–∂ –∏ –æ—Ö–æ—Ç–∞ –∑–∞ —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É. –ö—Ä–∞—Å–∏–≤—ã–µ —É—Ä–æ–≤–Ω–∏, —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–µ–∫—Ä–µ—Ç–æ–≤."},
         "DuckTales 2": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ—Ö–æ—Ç—ã –°–∫—Ä—É–¥–∂–∞ –∑–∞ —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏ —Å –Ω–æ–≤—ã–º–∏ –ª–æ–∫–∞—Ü–∏—è–º–∏."},
         "Felix the Cat": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í–µ—Å—ë–ª–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –∫–æ—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –§–µ–ª–∏–∫—Å–∞, —á—Ç–æ–±—ã –ø—Ä–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –≤—Å–µ —É—Ä–æ–≤–Ω–∏."},
         "Prince of Persia (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∞, –ø–æ–ª–Ω—ã–π –ª–æ–≤—É—à–µ–∫ –∏ –æ–ø–∞—Å–Ω–æ—Å—Ç–µ–π. –û—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –∑–∞–≥–∞–¥–∫–∞–º–∏."},
         "TaleSpin": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ë–∞–ª–ª—É –∏ –µ–≥–æ –≤–æ–∑–¥—É—à–Ω—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è. –ü–æ–ª—ë—Ç—ã, —Å—Ä–∞–∂–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –º–∏—Å—Å–∏–∏ –≤ –º–∏—Ä–µ –º—É–ª—å—Ç—Å–µ—Ä–∏–∞–ª–∞."},
         "The Flintstones: The Rescue of Dino & Hoppy": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–§–ª–∏–Ω—Å—Ç–æ—É–Ω—ã –≤ –¥–æ–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö. –í–µ—Å—ë–ª—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏ –∏ —É—Ä–æ–≤–Ω–∏."},
         "The Flintstones: Surprise at Dinosaur Peak": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π –§–ª–∏–Ω—Å—Ç–æ—É–Ω–æ–≤ —Å –Ω–æ–≤—ã–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏."},
         "Tiny Toon Adventures": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ó–∞–±–∞–≤–Ω—ã–µ –º—É–ª—å—Ç–≥–µ—Ä–æ–∏ Tiny Toon –≤ –≤–µ—Å—ë–ª—ã—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö. –Ø—Ä–∫–∏–π –º–∏—Ä, —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏ –ø—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ."},
         "Tiny Toon Adventures 2: Trouble in Wackyland": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π Tiny Toon –≤ –ø–∞—Ä–∫–µ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π Wackyland."},
         "Tom and Jerry (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", description: "–í–µ—Å—ë–ª–æ–µ –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è–Ω–∏–µ –¢–æ–º–∞ –∏ –î–∂–µ—Ä—Ä–∏. –ü—Ä–æ–π–¥–∏—Ç–µ –≤—Å–µ —É—Ä–æ–≤–Ω–∏, –∏–∑–±–µ–≥–∞—è –ª–æ–≤—É—à–µ–∫ –∏ –≤—Ä–∞–≥–æ–≤."},
         "Batman": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ì–æ—Ç—ç–º –≤ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏! –£–ø—Ä–∞–≤–ª—è–π –ë—ç—Ç–º–µ–Ω–æ–º, –ø—Ä–æ—Ö–æ–¥–∏ —Å–ª–æ–∂–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏ —Å—Ä–∞–∂–∞–π—Å—è —Å –∫—É–ª—å—Ç–æ–≤—ã–º–∏ –∑–ª–æ–¥–µ—è–º–∏."},
         "Batman Returns": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ë–∏—Ç–≤–∞ –ë—ç—Ç–º–µ–Ω–∞ –ø—Ä–æ—Ç–∏–≤ –ü–∏–Ω–≥–≤–∏–Ω–∞ –∏ –ñ–µ–Ω—â–∏–Ω—ã-–∫–æ—à–∫–∏ –ø–æ –º–æ—Ç–∏–≤–∞–º —Ñ–∏–ª—å–º–∞."},
         "Castlevania": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è —Å–µ–º—å–∏ –ë–µ–ª—å–º–æ–Ω—Ç–æ–≤, —Å—Ä–∞–∂–∞—é—â–∏—Ö—Å—è —Å –î—Ä–∞–∫—É–ª–æ–π. –ú—Ä–∞—á–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞, —Å–ª–æ–∂–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏ –∫—É–ª—å—Ç–æ–≤—ã–π —Å–∞—É–Ω–¥—Ç—Ä–µ–∫."},
         "Castlevania II: Simon's Quest": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ RPG –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º –º–∏—Ä–∞."},
         "Castlevania III: Dracula's Curse": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ü—Ä–∏–∫–≤–µ–ª —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–º–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏."},
         "Mega Man": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–°–µ—Ä–∏—è –∏–≥—Ä –ø—Ä–æ –æ—Ç–≤–∞–∂–Ω–æ–≥–æ —Ä–æ–±–æ—Ç–∞. –°—Ä–∞–∂–∞–π—Å—è —Å –±–æ—Å—Å–∞–º–∏, —É–ª—É—á—à–∞–π –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–æ—Ö–æ–¥–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–µ —É—Ä–æ–≤–Ω–∏."},
         "Mega Man 2": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π –ú–µ–≥–∞–º–µ–Ω–∞ —Å –Ω–æ–≤—ã–º–∏ –±–æ—Å—Å–∞–º–∏ –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏."},
         "Mega Man 3": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ú–µ–≥–∞–º–µ–Ω 3 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –†–∞—à–∞ - –≤–µ—Ä–Ω–æ–≥–æ –ø—Å–∞-–ø–æ–º–æ—â–Ω–∏–∫–∞."},
         "Mega Man 4": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ù–æ–≤—ã–π –∑–ª–æ–¥–µ–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Ä—è–∂–∞—Ç—å –≤—ã—Å—Ç—Ä–µ–ª –ú–µ–≥–∞ –ë–∞—Å—Ç–µ—Ä–∞."},
         "Mega Man 5": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ë—Ä–∞—Ç –ú–µ–≥–∞–º–µ–Ω–∞ - –ü—Ä–æ—Ç–æ–º–µ–Ω - –ø–æ—Ö–∏—â–∞–µ—Ç –¥–æ–∫—Ç–æ—Ä–∞ –õ–∞–π—Ç–∞."},
         "Mega Man 6": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ú–µ–≥–∞–º–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã –†–∞—à–∞ –¥–ª—è –ø–æ–ª—ë—Ç–∞ –∏ –º–æ—â–Ω–æ–≥–æ —É–¥–∞—Ä–∞."},
         "Teenage Mutant Ninja Turtles (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ü–µ—Ä–≤–∞—è –∏–≥—Ä–∞ –ø—Ä–æ —á–µ—Ä–µ–ø–∞—à–µ–∫ –Ω–∞ NES. –°–ª–æ–∂–Ω—ã–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä —Å –≤–∏–¥–æ–º —Å–±–æ–∫—É –∏ —Å–≤–µ—Ä—Ö—É."},
         "Teenage Mutant Ninja Turtles II: The Arcade Game": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä/–≠–∫—à–µ–Ω", description: "–ü–æ—Ä—Ç –∞—Ä–∫–∞–¥–Ω–æ–π –∏–≥—Ä—ã –≤ –∂–∞–Ω—Ä–µ Beat 'em up. –°—Ä–∞–∂–∞–π—Å—è —Å –∫–ª–∞–Ω–æ–º –§—É—Ç –≤–¥–≤–æ—ë–º!"},
         "Teenage Mutant Ninja Turtles: Tournament Fighters": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–§–∞–π—Ç–∏–Ω–≥ –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π —á–µ—Ä–µ–ø–∞—à–µ–∫-–Ω–∏–Ω–¥–∑—è —Å —Ä–∞–∑–Ω—ã–º–∏ –±–æ–π—Ü–∞–º–∏ –∏ –∞—Ä–µ–Ω–∞–º–∏."},
         "Super Mario Bros.": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä, —Å–ø–∞—Å—à–∏–π –∏–Ω–¥—É—Å—Ç—Ä–∏—é –≤–∏–¥–µ–æ–∏–≥—Ä."},
         "Super Mario Bros. 2 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä", description: "–ù–µ–æ–±—ã—á–Ω–∞—è —á–∞—Å—Ç—å —Å–µ—Ä–∏–∏ —Å –≤—ã–±–æ—Ä–æ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –º–µ—Ö–∞–Ω–∏–∫–æ–π –≤—ã–¥–µ—Ä–≥–∏–≤–∞–Ω–∏—è –æ–≤–æ—â–µ–π."},
         "Super Mario Bros. 3 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç 2R Team)": { genre: "–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä", description: "–û–¥–Ω–∞ –∏–∑ –ª—É—á—à–∏—Ö –∏–≥—Ä –Ω–∞ NES. –û–≥—Ä–æ–º–Ω—ã–π –º–∏—Ä, –º–Ω–æ–∂–µ—Å—Ç–≤–æ –±–æ–Ω—É—Å–æ–≤ –∏ —Å–µ–∫—Ä–µ—Ç–æ–≤."},
         "Mario Bros.": { genre: "–ê—Ä–∫–∞–¥–∞", description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∞—Ä–∫–∞–¥–∞, –≥–¥–µ –ú–∞—Ä–∏–æ –∏ –õ—É–∏–¥–∂–∏ —Å—Ä–∞–∂–∞—é—Ç—Å—è —Å –≤—Ä–µ–¥–∏—Ç–µ–ª—è–º–∏ –≤ –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏–∏."},
         "Final Fantasy": { genre: "RPG", description: "–ö—É–ª—å—Ç–æ–≤–∞—è —Å–µ—Ä–∏—è —Ä–æ–ª–µ–≤—ã—Ö –∏–≥—Ä —Å –≥–ª—É–±–æ–∫–∏–º —Å—é–∂–µ—Ç–æ–º, –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –±–æ—è."},
         "Final Fantasy II": { genre: "RPG", description: "–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å —Å —É–Ω–∏–∫–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–æ–∫–∞—á–∫–∏, –∑–∞–≤–∏—Å—è—â–µ–π –æ—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π."},
         "Final Fantasy III": { genre: "RPG", description: "–¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å —Å —Ä–∞–∑–≤–∏—Ç–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–π (–¥–∂–æ–±)."},
         "Best of the Best: Championship Karate": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–ö–∞—Ä–∞—Ç–µ-—á–µ–º–ø–∏–æ–Ω–∞—Ç, –≥–¥–µ —Ç—ã –ø—Ä–æ—Ö–æ–¥–∏—à—å –ø—É—Ç—å –æ—Ç –Ω–æ–≤–∏—á–∫–∞ –¥–æ —á–µ–º–ø–∏–æ–Ω–∞. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–µ—Ö–Ω–∏–∫ –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –±–æ–∏."},
         "Mighty Final Fight": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–ß–∏–±–∏-–≤–µ—Ä—Å–∏—è –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–≥–æ Beat 'em up Final Fight —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–∫–∞—á–∫–∏."},
         "Double Dragon": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Beat 'em up. –ë—Ä–∞—Ç—å—è –ë–∏–ª–ª–∏ –∏ –î–∂–∏–º–º–∏ –õ–∏ —Å–ø–∞—Å–∞—é—Ç –ú—ç—Ä–∏–∞–Ω."},
         "Double Dragon II: The Revenge": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ Beat 'em up —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∏—ë–º–∞–º–∏ –∏ —É–ª—É—á—à–µ–Ω–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π."},
         "Double Dragon III: The Sacred Stones": { genre: "–§–∞–π—Ç–∏–Ω–≥", description: "–¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å Beat 'em up —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–∫—É–ø–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∏ –Ω–æ–≤—ã–º–∏ –±–æ–π—Ü–∞–º–∏."},
         "Bomberman": { genre: "–ê—Ä–∫–∞–¥–∞/–ü–∞–∑–ª", description: "–ü–æ–¥—Ä—ã–≤–∞–π —Å—Ç–µ–Ω—ã, —É–Ω–∏—á—Ç–æ–∂–∞–π –≤—Ä–∞–≥–æ–≤ –∏ –Ω–∞–π–¥–∏ –≤—ã—Ö–æ–¥ –∏–∑ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞. –ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∞—è –∞—Ä–∫–∞–¥–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–≥—Ä–æ–∫–æ–≤."},
         "Bomberman II": { genre: "–ê—Ä–∫–∞–¥–∞/–ü–∞–∑–ª", description: "–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ Bomberman —Å –Ω–æ–≤—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏, –≤–∫–ª—é—á–∞—è –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä."},
         "Dr. Mario (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Multisoft)": { genre: "–ü–∞–∑–ª", description: "–ó–∞—Ç—è–≥–∏–≤–∞—é—â–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞ —Å —É—á–∞—Å—Ç–∏–µ–º –ú–∞—Ä–∏–æ, –≥–¥–µ –Ω—É–∂–Ω–æ –æ—á–∏—â–∞—Ç—å —ç–∫—Ä–∞–Ω –æ—Ç –≤–∏—Ä—É—Å–æ–≤."},
         "Pac-Man": { genre: "–ê—Ä–∫–∞–¥–∞", description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∞—Ä–∫–∞–¥–∞, –≥–¥–µ –Ω—É–∂–Ω–æ —Å—ä–µ—Å—Ç—å –≤—Å–µ —Ç–æ—á–∫–∏ –∏ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–∏–∑—Ä–∞–∫–æ–≤."},
         "Lode Runner (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Multisoft)": { genre: "–ê—Ä–∫–∞–¥–∞/–ü–∞–∑–ª", description: "–£–º–Ω–∞—è –∞—Ä–∫–∞–¥–∞, –≥–¥–µ –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –∑–æ–ª–æ—Ç–æ, –∏–∑–±–µ–≥–∞—è –≤—Ä–∞–≥–æ–≤ –∏ –ª–æ–≤—É—à–µ–∫."},
         "Blades of Steel": { genre: "–°–ø–æ—Ä—Ç", description: "–î–∏–Ω–∞–º–∏—á–Ω—ã–π —Ö–æ–∫–∫–µ–π —Å –¥—Ä–∞–∫–∞–º–∏ –∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω—ã–º–∏ –º–∞—Ç—á–∞–º–∏."},
    };

     const initialFullCatalogGames = [
         { filename: "teenage-manhattan.nes", title: "Teenage Mutant Ninja Turtles III: The Manhattan Project" },
         { filename: "487_Tank_1990.nes", title: "Battle City" }, // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
         { filename: "adventure_islan.nes", title: "Adventure Island" },
         { filename: "adventure_islan2.nes", title: "Adventure Island II" },
         { filename: "adventure_islan3.nes", title: "Adventure Island III" },
         { filename: "adventure_islan4.nes", title: "Adventure Island IV" },
         { filename: "Alien 3.nes", title: "Alien 3" },
         { filename: "Batman Returns.nes", title: "Batman Returns" },
         { filename: "Batman.nes", title: "Batman" },
         { filename: "Battletoads and Double Dragon.nes", title: "Battletoads & Double Dragon" }, // –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏–µ
         { filename: "battletoads-rus_onlain-igrok.rf_.nes", title: "Battletoads (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" },
         { filename: "Best of the Best - Championship Karate.nes", title: "Best of the Best: Championship Karate" },
         { filename: "Blades_of_Steel.nes", title: "Blades of Steel" }, // –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏–µ
         { filename: "Bomberman (U) [T-Rus] [!].nes", title: "Bomberman" },
         { filename: "Bomberman2.nes", title: "Bomberman II" },
         { filename: "Bucky O'Hare.nes", title: "Bucky O'Hare" },
         { filename: "Captain America and the Avengers.nes", title: "Captain America and the Avengers" },
         { filename: "Castlevania 2 Simon's Quest.nes", title: "Castlevania II: Simon's Quest" },
         { filename: "Castlevania 3 - Dracula's Curse.nes", title: "Castlevania III: Dracula's Curse" },
         { filename: "Castlevania.nes", title: "Castlevania" },
         { filename: "Chip n Dale Rescue Rangers 2 (U) [T-Rus] [!] by Shedevr.nes", title: "Chip 'n Dale: Rescue Rangers 2 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Shedevr)" },
         { filename: "chip-n-dale-rescue-rangers-[rus].nes", title: "Chip 'n Dale: Rescue Rangers (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" },
         { filename: "Contra Force.nes", title: "Contra Force" },
         { filename: "Darkwing_Duck-U-.nes", title: "Darkwing Duck" },
         { filename: "Double Dragon II - The Revenge.nes", title: "Double Dragon II: The Revenge" },
         { filename: "Double Dragon III - The Sacred Stones.nes", title: "Double Dragon III: The Sacred Stones" },
         { filename: "Double Dragon.nes", title: "Double Dragon" },
         { filename: "Dr. Mario (U) [!p] [T-Rus] by Multisoft.nes", title: "Dr. Mario (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Multisoft)" },
         { filename: "onlain-igrok.rf_23573.nes", title: "Duck Tales" }, // –ò—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ
         { filename: "Duck Tales 2.nes", title: "DuckTales 2" },
         { filename: "Felix the Cat.nes", title: "Felix the Cat" },
         { filename: "Final Fantasy 2.nes", title: "Final Fantasy II" },
         { filename: "Final Fantasy 3.nes", title: "Final Fantasy III" },
         { filename: "Final Fantasy.nes", title: "Final Fantasy" },
         { filename: "Final Mission.nes", title: "S.C.A.T.: Special Cybernetic Attack Team" }, // –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
         { filename: "Jackal.nes", title: "Jackal" },
         { filename: "Lode Runner (U) [T-Rus] by Multisoft.nes", title: "Lode Runner (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Multisoft)" },
         { filename: "Mario Bros.nes", title: "Mario Bros." },
         { filename: "Mega Man5.nes", title: "Mega Man 5" },
         { filename: "Megaman6.nes", title: "Mega Man 6" },
         { filename: "Mega_Man.nes", title: "Mega Man" },
         { filename: "Mega_Man2.nes", title: "Mega Man 2" },
         { filename: "Mega_Man3.nes", title: "Mega Man 3" },
         { filename: "Mega_Man4.nes", title: "Mega Man 4" },
         { filename: "Mighty Final Fight.nes", title: "Mighty Final Fight" },
         { filename: "Monster In My Pocket.nes", title: "Monster in My Pocket" },
         { filename: "Pac-Man.nes", title: "Pac-Man" },
         { filename: "prince-of-persia-rus_onlain-igrok.rf_.nes", title: "Prince of Persia (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" },
         { filename: "Robocop-2.nes", title: "RoboCop 2" },
         { filename: "Robocop-3.nes", title: "RoboCop 3" },
         { filename: "RoboCop.nes", title: "RoboCop" },
         { filename: "shadow of the ninja.nes", title: "Shadow of the Ninja" },
         { filename: "Silkworm.nes", title: "Silkworm" },
         { filename: "Super Contra.nes", title: "Super C (Super Contra)" }, // –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
         { filename: "super-mario-bros.-2-rus.nes", title: "Super Mario Bros. 2 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" },
         { filename: "super-mario-bros.-3-e-t-rus-by-2r-team-2r-team.nes", title: "Super Mario Bros. 3 (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç 2R Team)" },
         { filename: "TaleSpin.nes", title: "TaleSpin" },
         { filename: "teenage-mutant-ninja-turtles-ii-the-arcade-game.nes", title: "Teenage Mutant Ninja Turtles II: The Arcade Game" },
         { filename: "teenage-mutant-ninja-turtles-rus.nes", title: "Teenage Mutant Ninja Turtles (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" },
         { filename: "teenage-mutant-ninja-turtles-tournament-fighters.nes", title: "Teenage Mutant Ninja Turtles: Tournament Fighters" },
         { filename: "The Flintstones - The Rescue of Dino & Hoppy.nes", title: "The Flintstones: The Rescue of Dino & Hoppy" },
         { filename: "The Flintstones 2 - The Surprise at Dinosaur Peak.nes", title: "The Flintstones: Surprise at Dinosaur Peak" }, // –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ
         { filename: "Tiny Toon Adventures 2.nes", title: "Tiny Toon Adventures 2: Trouble in Wackyland" },
         { filename: "Tiny_Toon_Adventures-U-.nes", title: "Tiny Toon Adventures" },
         { filename: "Tokkyuu Shirei - Solbrain.nes", title: "Tokkyuu Shirei Solbrain" },
         { filename: "tom-jerry-u-p1trus_onlain-igrok.rf_.nes", title: "Tom and Jerry (–†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)" }
     ].map(game => ({
         ...game,
         id: generateId(game.filename) // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID
     }));

    // –û–±–æ–≥–∞—â–∞–µ–º –æ–±–∞ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ gameDetailsData
    const enrichGameData = (gameList) => {
        return gameList.map(game => {
            const details = gameDetailsData[game.title] || {};
            // –û—Å–æ–±—ã–π —Å–ª—É—á–∞–π –¥–ª—è Battle City / Tank 1990
            if (game.id === 'tank_1990') {
                 const detailsBC = gameDetailsData["Battle City"] || {};
                 return { ...game, title: "Battle City", genre: detailsBC.genre || '–ê—Ä–∫–∞–¥–∞', description: detailsBC.description || '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —Ç–∞–Ω–∫–æ–≤–∞—è –±–∞—Ç–∞–ª–∏—è.' };
            }
             // –û—Å–æ–±—ã–π —Å–ª—É—á–∞–π –¥–ª—è S.C.A.T. / Final Mission
            if (game.id === 'final_mission') {
                const detailsSCAT = gameDetailsData["S.C.A.T.: Special Cybernetic Attack Team"] || {};
                 return { ...game, title: "S.C.A.T.", genre: detailsSCAT.genre || '–≠–∫—à–µ–Ω', description: detailsSCAT.description || '–õ–µ—Ç–∞—é—â–∏–π —ç–∫—à–µ–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä.' };
            }
            // –û—Å–æ–±—ã–π —Å–ª—É—á–∞–π –¥–ª—è Super C / Super Contra
            if (game.id === 'super_contra') {
                const detailsSuperC = gameDetailsData["Super C (Super Contra)"] || {};
                return { ...game, title: "Super C", genre: detailsSuperC.genre || '–≠–∫—à–µ–Ω', description: detailsSuperC.description || '–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–π Contra.' };
            }
            return {
                ...game,
                genre: details.genre || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                description: details.description || '–û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —ç—Ç–æ–π –∏–≥—Ä—ã –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ.',
                romUrl: game.romUrl || `roms/catalog/${game.filename}` // –î–æ–±–∞–≤–ª—è–µ–º romUrl –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞
            };
        });
    };

    window.libraryGames = enrichGameData(initialLibraryGames);
    window.fullCatalogGames = enrichGameData(initialFullCatalogGames);

    // --- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏ –¢–û–ü –∏–≥—Ä—ã ---
    const popularGameIds = [ 'battletoads_double_dragon', 'teenage_manhattan', 'tiny_toon_adventures_u', 'chip_n_dale_rescue_rangers_rus', 'dr_mario_u_p_t_rus_by_multisoft', 'mega_man', 'pac_man'];
    const topGameIds = [ 'battletoads_double_dragon', 'chip_n_dale_rescue_rangers_rus', 'felix_the_cat', 'mario_bros', 'tank_1990', 'teenage_mutant_ninja_turtles_rus', 'teenage_mutant_ninja_turtles_ii_the_arcade_game', 'tom_jerry_u_p1trus_onlain_igrok_rf', 'robocop'];

    // –°–¥–µ–ª–∞–µ–º —ç—Ç–∏ —Å–ø–∏—Å–∫–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏, —á—Ç–æ–±—ã –æ–Ω–∏ –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã showPopularGames/showTopGames
    window.findGameDataById = (id) => window.libraryGames.find(g => g.id === id) || window.fullCatalogGames.find(g => g.id === id);
    window.popularGamesList = popularGameIds.map(window.findGameDataById).filter(Boolean);
    window.topGamesList = topGameIds.map(window.findGameDataById).filter(Boolean);

    const imageMap = {
        // ID –∏–∑ libraryGames
        "mario": "mario.webp",
        "contra": "contra.webp",
        "battle_city": "battlecity.webp",
        "duck_hunt": "duckhunt.webp",
        "tetris": "tetris.webp",
        "ninja_gaiden": "ninja.webp",
        // ID –∏–∑ fullCatalogGames (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ —á–µ—Ä–µ–∑ generateId)
        "teenage_manhattan": "manhattan.webp",
        "tank_1990": "battlecity.webp",
        "adventure_islan": "adventure_island1.webp",
        "adventure_islan2": "adventure_islan2.webp",
        "adventure_islan3": "adventure_islan3.webp",
        "adventure_islan4": "adventure_islan4.webp",
        "alien_3": "Alien_3.webp",
        "batman_returns": "Batman_Returns.webp",
        "batman": "Batman.webp",
        "battletoads_double_dragon": "BattletoadsDoubleDragon.webp",
        "battletoads_rus": "Battletoadsrus.webp",
        "best_of_the_best_championship_karate": "BBCKarate.webp",
        "blades_of_steel": "BladesofSteel.webp",
        "bomberman_u_t_rus": "Bomberman.webp",
        "bomberman2": "Bomberman2.webp",
        "bucky_o_hare": "BuckyOHare.webp",
        "captain_america_and_the_avengers": "CaptainAmerica.webp",
        "castlevania_2_simon_s_quest": "Castlevania2.webp",
        "castlevania_3_dracula_s_curse": "Castlevania3.webp",
        "castlevania": "Castlevania.webp",
        "chip_n_dale_rescue_rangers_2_u_t_rus_by_shedevr": "Chip2.webp",
        "chip_n_dale_rescue_rangers_rus": "chipr.webp",
        "contra_force": "contra_force.webp",
        "darkwing_duck_u": "darkwing_duck_u.webp",
        "double_dragon_ii_the_revenge": "double_dragon_revenge.webp",
        "double_dragon_iii_the_sacred_stones": "DoubleDragonSacred.webp",
        "double_dragon": "DoubleDragon.webp",
        "dr_mario_u_p_t_rus_by_multisoft": "dr_mario.webp",
        "duck_tales": "dt.webp",
        "duck_tales_2": "DuckTales2.webp",
        "felix_the_cat": "felix_the_cat.webp",
        "final_fantasy_2": "final_fantasy_2.webp",
        "final_fantasy_3": "final_fantasy_3.webp",
        "final_fantasy": "final_fantasy.webp",
        "final_mission": "final_mission.webp",
        "jackal": "Jackal.webp",
        "lode_runner_u_t_rus_by_multisoft": "lode_runner.webp",
        "mario_bros": "mario_bros.webp",
        "mega_man5": "mega_man5.webp",
        "megaman6": "megaman6.webp",
        "mega_man": "mega_man.webp",
        "mega_man2": "Mega_Man2.webp",
        "mega_man3": "Mega_Man3.webp",
        "mega_man4": "Mega_Man4.webp",
        "mighty_final_fight": "mighty_final_fight.webp",
        "monster_in_my_pocket": "monster_in_my_pocket.webp",
        "pac_man": "pac_man.webp",
        "prince_of_persia_rus": "prince_of_persia.webp",
        "robocop_2": "robocop_2.webp",
        "robocop_3": "robocop_3.webp",
        "robocop": "robocop.webp",
        "shadow_of_the_ninja": "shadow_of_the_ninja.webp",
        "silkworm": "silkworm.webp",
        "super_contra": "super_contra.webp",
        "super_mario_bros_2_rus": "super_mario_bros_2_rus.webp",
        "super_mario_bros_3_e_t_rus_by_2r_team_2r_team": "super_mario_bros_3.webp",
        "talespin": "talespin.webp",
        "teenage_mutant_ninja_turtles_ii_the_arcade_game": "teenagemutantarcade.webp",
        "teenage_mutant_ninja_turtles_rus": "teenagemutant.webp",
        "teenage_mutant_ninja_turtles_tournament_fighters": "teenagemutantfighters.webp",
        "the_flintstones_the_rescue_of_dino_hoppy": "Flintstones.webp",
        "the_flintstones_2_the_surprise_at_dinosaur_peak": "Flintstones2.webp",
        "tiny_toon_adventures_2": "tiny_toon_adventures_2.webp",
        "tiny_toon_adventures_u": "tiny_toon_adventures.webp",
        "tokkyuu_shirei_solbrain": "tokkyuu_shirei_solbrain.webp",
        "tom_jerry_u_p1trus_onlain_igrok_rf": "tom_jerry.webp"
    };
    const imgBasePath = "data/img/games/";
    const catalogImgBasePath = "data/img/catalog/";

    // --- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–æ—Å—Ç–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ DOMContentLoaded) ---

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–µ—Ç–∫–∏ –∏–≥—Ä
    // –°–¥–µ–ª–∞–µ–º –µ–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π, —á—Ç–æ–±—ã –±—ã–ª–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑ showMainContent –∏ showGameListSection
    window.renderGamesGrid = function (gamesToRender, targetGridElement) {
        if (!targetGridElement) {
             console.error("Target grid element is missing for renderGamesGrid");
             return;
        }
        targetGridElement.innerHTML = '';
        if (!gamesToRender || gamesToRender.length === 0) {
            targetGridElement.innerHTML = '<p style="color: #aaa; grid-column: 1 / -1; text-align: center; margin-top: 20px;">–ò–≥—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>';
            return;
        }
        gamesToRender.forEach(game => {
            if (!game || !game.id || !game.title || !game.romUrl) {
                console.warn("–ü—Ä–æ–ø—É—Å–∫ –∏–≥—Ä—ã (renderGamesGrid) —Å –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:", game);
                return;
            }
            const gameCard = document.createElement('div');
            gameCard.className = 'retro-game-card';

            let imagePath = imageMap[game.id] ? (imgBasePath + imageMap[game.id]) : `${catalogImgBasePath}${game.id}.webp`;
            const fallbackImage = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';
            const imageErrorHandler = `this.onerror=null; this.src='${catalogImgBasePath}${game.id}.webp'; this.onerror=function(){this.onerror=null; this.src='${fallbackImage}';}`;

            const isInFavorites = favoritesManager.isInFavorites(game.id);
            const favoriteButtonClass = isInFavorites ? 'remove-favorite' : 'add-favorite';
            const favoriteButtonText = isInFavorites ? '‚òÖ' : '‚òÜ';

            gameCard.innerHTML = `
                <div class="favorite-button ${favoriteButtonClass}" data-game-id="${game.id}">${favoriteButtonText}</div>
                <img src="${imagePath}" alt="${game.title}" class="retro-game-image" onerror="${imageErrorHandler}">
                <div class="retro-game-title">${game.title}</div>
            `;

            // –ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä—ã
            gameCard.addEventListener('click', (e) => {
                if (e.target.classList.contains('favorite-button') || e.target.closest('.favorite-button')) {
                    return; // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
                }
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–º—ã–∫–∞–Ω–∏–µ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç game
                // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è findGameDataById –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
                const clickedGame = window.findGameDataById(game.id);
                if (clickedGame) {
                   showGamePage(clickedGame); // showGamePage —Ç–æ–∂–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞
                } else {
                   console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã:", game.id);
                }
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
            const favoriteButton = gameCard.querySelector('.favorite-button');
            if (favoriteButton) {
                favoriteButton.addEventListener('click', (e) => {
                    e.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä—ã
                    const gameId = e.target.dataset.gameId;
                    // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è findGameDataById –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
                    const gameToAdd = window.findGameDataById(gameId);
                    if (!gameToAdd) return;

                    if (favoritesManager.isInFavorites(gameId)) {
                        if (favoritesManager.removeFromFavorites(gameId)) {
                            e.target.classList.remove('remove-favorite');
                            e.target.classList.add('add-favorite');
                            e.target.textContent = '‚òÜ';
                        }
                    } else {
                        if (favoritesManager.addToFavorites(gameToAdd)) {
                            e.target.classList.remove('add-favorite');
                            e.target.classList.add('remove-favorite');
                            e.target.textContent = '‚òÖ';
                        }
                    }
                     // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥ –∫–Ω–æ–ø–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–≥—Ä—ã, –µ—Å–ª–∏ –æ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –¥–ª—è —ç—Ç–æ–π –∏–≥—Ä—ã
                    const gamePageFavButton = document.querySelector(`#game-page-favorite-btn[data-game-id="${gameId}"]`);
                    if(gamePageFavButton) {
                        const isNowFavorite = favoritesManager.isInFavorites(gameId);
                        gamePageFavButton.className = `favorite-button ${isNowFavorite ? 'remove-favorite' : 'add-favorite'}`;
                        gamePageFavButton.textContent = isNowFavorite ? '‚òÖ' : '‚òÜ';
                    }
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–≤–µ–∑–¥–æ—á–∫—É –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º —Å–ø–∏—Å–∫–µ
                    const alphaListItem = document.querySelector(`.alpha-list-item[data-game-id="${gameId}"] .favorite-indicator`);
                    if(alphaListItem) {
                       alphaListItem.style.display = favoritesManager.isInFavorites(gameId) ? 'inline-block' : 'none';
                    }
                });
            }

            targetGridElement.appendChild(gameCard);
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∫–∞—Ç–∞–ª–æ–≥–∞
    // –°–¥–µ–ª–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–π
    window.renderCatalogGrid = function (catalogData, targetGridElement) {
         const gamesWithRomUrl = catalogData.map(g => ({
             ...g,
             romUrl: g.romUrl || `roms/catalog/${g.filename}`
         }));
         // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è renderGamesGrid –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
         if (typeof window.renderGamesGrid === 'function') {
             window.renderGamesGrid(gamesWithRomUrl, targetGridElement);
         } else {
              console.warn("renderGamesGrid –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è renderCatalogGrid");
         }
     }

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä—ã
    // –û—Å—Ç–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–π, —Ç.–∫. –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
    function showGamePage(game) {
        const gamePageArea = document.getElementById('game-page-area');
        if (!game || !game.id || !gamePageArea) {
            console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä—ã:", game);
            return;
        }

        // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è findGameDataById –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
        let fullGameData = window.findGameDataById(game.id);
        if (!fullGameData) {
            fullGameData = game; // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏
        }

        const romPath = fullGameData.romUrl || `roms/catalog/${fullGameData.filename}`;
         if (!romPath) {
             console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å ROM path –¥–ª—è –∏–≥—Ä—ã:", fullGameData.title);
             alert("–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª –∏–≥—Ä—ã.");
             return;
         }

        let imagePath = imageMap[fullGameData.id] ? (imgBasePath + imageMap[fullGameData.id]) : `${catalogImgBasePath}${fullGameData.id}.webp`;
        const fallbackImage = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';
        const imageErrorHandler = `this.onerror=null; this.src='${catalogImgBasePath}${fullGameData.id}.webp'; this.onerror=function(){this.onerror=null; this.src='${fallbackImage}';}`;

        const isInFavorites = favoritesManager.isInFavorites(fullGameData.id);
        const favoriteButtonClass = isInFavorites ? 'remove-favorite' : 'add-favorite';
        const favoriteButtonText = isInFavorites ? '‚òÖ' : '‚òÜ';

        gamePageArea.innerHTML = `
            <div class="game-page-container">
                <div class="game-page-header">
                    <button class="game-page-back-button" id="game-page-back-btn" title="–ù–∞–∑–∞–¥">&#10094;</button>
                    <span class="game-page-genre">${fullGameData.genre || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</span>
                </div>

                <div class="game-page-title-container">
                     <h2 class="game-page-title">${fullGameData.title}</h2>
                     <div class="favorite-button ${favoriteButtonClass}" id="game-page-favorite-btn" data-game-id="${fullGameData.id}" title="${isInFavorites ? '–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : '–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ'}">${favoriteButtonText}</div>
                </div>

                <img src="${imagePath}" alt="${fullGameData.title}" class="game-page-logo" onerror="${imageErrorHandler}">

                <div class="game-page-screenshots">
                     <p>(–ó–¥–µ—Å—å –±—É–¥—É—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã)</p>
                </div>

                <div class="game-page-description">
                     ${fullGameData.description || '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.'}
                </div>

                <button class="game-page-play-button" id="game-page-play-btn">–ò–ì–†–ê–¢–¨</button>
            </div>
        `;

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–≥—Ä—ã
        const playButton = gamePageArea.querySelector('#game-page-play-btn');
        const backCatalogButton = gamePageArea.querySelector('#game-page-back-btn');
        const favoriteButton = gamePageArea.querySelector('#game-page-favorite-btn');

        if (playButton) {
            playButton.onclick = () => {
                gamePageArea.classList.add('hidden');
                // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è loadGameFromUrl
                if (typeof loadGameFromUrl === 'function') {
                    loadGameFromUrl(romPath, fullGameData.title);
                } else {
                    console.error("–§—É–Ω–∫—Ü–∏—è loadGameFromUrl –Ω–µ –Ω–∞–π–¥–µ–Ω–∞");
                }
            };
        }

        if (backCatalogButton) {
            backCatalogButton.onclick = () => {
                gamePageArea.classList.add('hidden');
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –≤–∏–¥—É
                if (!mainContent.classList.contains('hidden')) {
                     // –£–∂–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
                } else if (!searchResultsArea.classList.contains('hidden')) {
                     searchResultsArea.classList.remove('hidden'); // –í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É
                } else if (alphaListOverlay && !alphaListOverlay.classList.contains('hidden')){
                     alphaListOverlay.classList.remove('hidden'); // –í–æ–∑–≤—Ä–∞—Ç –∫ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º—É —Å–ø–∏—Å–∫—É
                     document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª –¥–ª—è –æ–≤–µ—Ä–ª–µ—è
                } else {
                     showMainContent(); // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ –≥–ª–∞–≤–Ω—É—é (–≥–ª–æ–±–∞–ª—å–Ω–∞—è)
                }
                window.scrollTo(0, 0); // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö
            };
        }

         // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–≥—Ä—ã
         if (favoriteButton) {
            favoriteButton.onclick = () => {
                const gameId = favoriteButton.dataset.gameId;
                if (favoritesManager.isInFavorites(gameId)) {
                    if (favoritesManager.removeFromFavorites(gameId)) {
                        favoriteButton.classList.remove('remove-favorite');
                        favoriteButton.classList.add('add-favorite');
                        favoriteButton.textContent = '‚òÜ';
                        favoriteButton.title = '–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ';
                    }
                } else {
                    // –ü–µ—Ä–µ–¥–∞–µ–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    if (favoritesManager.addToFavorites(fullGameData)) {
                        favoriteButton.classList.remove('add-favorite');
                        favoriteButton.classList.add('remove-favorite');
                        favoriteButton.textContent = '‚òÖ';
                        favoriteButton.title = '–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ';
                    }
                }
                 // –û–±–Ω–æ–≤–ª—è–µ–º –∑–≤–µ–∑–¥–æ—á–∫–∏ –≤ —Å–ø–∏—Å–∫–∞—Ö –∏–≥—Ä, –µ—Å–ª–∏ –æ–Ω–∏ –≤–∏–¥–∏–º—ã
                 document.querySelectorAll(`.favorite-button[data-game-id="${gameId}"]`).forEach(btn => {
                     if (btn !== favoriteButton) {
                         const isNowFavorite = favoritesManager.isInFavorites(gameId);
                         btn.className = `favorite-button ${isNowFavorite ? 'remove-favorite' : 'add-favorite'}`;
                         btn.textContent = isNowFavorite ? '‚òÖ' : '‚òÜ';
                     }
                 });
                 // –û–±–Ω–æ–≤–ª—è–µ–º –∑–≤–µ–∑–¥–æ—á–∫—É –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º —Å–ø–∏—Å–∫–µ
                 const alphaListItem = document.querySelector(`.alpha-list-item[data-game-id="${gameId}"] .favorite-indicator`);
                 if(alphaListItem) {
                    alphaListItem.style.display = favoritesManager.isInFavorites(gameId) ? 'inline-block' : 'none';
                 }
            };
         }

         // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä—ã, —Å–∫—Ä—ã–≤–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω–æ–µ
         mainContent.classList.add('hidden');
         searchResultsArea.classList.add('hidden');
         display.classList.add('hidden');
         if (alphaListOverlay) alphaListOverlay.classList.add('hidden');

         document.body.style.overflow = ''; // –†–∞–∑—Ä–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä—ã
         gamePageArea.classList.remove('hidden');
         window.scrollTo(0, 0); // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö

         // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–≥—Ä—ã –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
         const gameViewedEvent = new CustomEvent('gameViewed', {
            detail: { gameId: fullGameData.id, gameTitle: fullGameData.title }
         });
         document.dispatchEvent(gameViewedEvent);
         console.log("AchievementSystem: gameViewed event dispatched for", fullGameData.id);
    }

    // –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞
    function performSearch() {
        const searchTerm = searchInput.value.toLowerCase().trim();
        if (!searchTerm) return;

        const allGames = [...window.libraryGames, ...window.fullCatalogGames];
        const uniqueGames = allGames.reduce((acc, current) => {
             if (!acc.find(item => item.id === current.id)) {
                 acc.push(current);
             }
             return acc;
         }, []);

        const filteredGames = uniqueGames.filter(game =>
            game.title.toLowerCase().includes(searchTerm)
        );

        searchResultsArea.innerHTML = ''; // –û—á–∏—â–∞–µ–º
        const titleElement = document.createElement('h2');
        titleElement.className = 'search-results-title';
        titleElement.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: "${searchInput.value}"`;
        searchResultsArea.appendChild(titleElement);

        const backToMainButton = document.createElement('button');
        backToMainButton.className = 'back-to-main-button';
        backToMainButton.textContent = '‚Äπ –ù–∞–∑–∞–¥';
        backToMainButton.onclick = showMainContent; // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
        searchResultsArea.appendChild(backToMainButton);

        const resultsGrid = document.createElement('div');
        resultsGrid.className = 'retro-games-grid';
        searchResultsArea.appendChild(resultsGrid);

        // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è renderGamesGrid (—Ç–µ–ø–µ—Ä—å –≥–ª–æ–±–∞–ª—å–Ω–∞—è)
        if (typeof window.renderGamesGrid === 'function') {
            window.renderGamesGrid(filteredGames, resultsGrid);
        } else {
            console.warn("renderGamesGrid –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –¥–ª—è performSearch");
        }

        mainContent.classList.add('hidden'); // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        searchResultsArea.classList.remove('hidden'); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        window.scrollTo(0, 0); // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö
    }

     // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä
    function showRecentGames() {
         try {
             const recentGames = JSON.parse(localStorage.getItem('recentGamesList') || '[]');
             showGameListSection(recentGames, '–ù–µ–¥–∞–≤–Ω–∏–µ –∏–≥—Ä—ã'); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
         } catch (e) {
             console.error("–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä:", e);
             alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä.");
         }
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã –ø–æ URL
    function loadGameFromUrl(romUrl, gameName) {
        stopEmulator(); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
        loadGame(romUrl, gameName, defaultCore); // –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    }

    // –ò—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã (–¥–ª—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è)
     function originalLoadGameFromUrl(romUrl, gameName) {
         loadGame(romUrl, gameName, defaultCore); // –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
     }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ DND, –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
    function handleRomFile(file) {
        const fileName = file.name;
        const parts = fileName.split(".");
        const extension = parts.length > 1 ? parts.pop().toLowerCase() : '';
        const gameName = parts.join(".");
        if (["fds", "nes", "unif", "unf"].includes(extension)) {
            loadGame(file, gameName, defaultCore); // –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
        } else {
            alert("–≠—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è...");
        }
    }

    uploadBox.addEventListener('dragover', function(e) {
        e.preventDefault();
        this.setAttribute("drag", true);
    });
    uploadBox.addEventListener('dragleave', function() {
        this.removeAttribute("drag");
    });
    uploadBox.addEventListener('drop', function(e) {
        e.preventDefault();
        this.removeAttribute("drag");
        if (e.dataTransfer.files.length > 0) {
            handleRomFile(e.dataTransfer.files[0]);
        }
    });
    fileInput.addEventListener('change', function() {
        if (this.files.length > 0) {
            handleRomFile(this.files[0]);
        }
    });


    // --- –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò –ò–ì–†–´ ---
    function loadGame(romFile, gameName, core) {
        stopEmulator(); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

        // --- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ID –∏–≥—Ä—ã ---
        let gameId = null;
        let gameDataToStore = null;

        if (typeof romFile === 'string') { // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω URL
            gameDataToStore = window.libraryGames.find(g => g.romUrl === romFile);
            if (!gameDataToStore) {
                 gameDataToStore = window.fullCatalogGames.find(g => g.romUrl === romFile || `roms/catalog/${g.filename}` === romFile);
            }
            if (!gameDataToStore && romFile.startsWith('roms/catalog/')) {
                const filename = romFile.split('/').pop();
                gameDataToStore = window.fullCatalogGames.find(g => g.filename === filename);
            }
            if (gameDataToStore) gameId = gameDataToStore.id;
        } else if (romFile instanceof File) { // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –æ–±—ä–µ–∫—Ç File
            gameDataToStore = window.libraryGames.find(g => g.title === gameName) || window.fullCatalogGames.find(g => g.title === gameName);
            if (gameDataToStore) {
                 gameId = gameDataToStore.id;
            } else {
                 console.log("–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–∞—è –∏–≥—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ —Å–ø–∏—Å–∫–∞—Ö, ID –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π.");
                 gameId = null;
            }
        }
        console.log(`Attempting to load game: Name='${gameName}', ID='${gameId}'`);

        window.currentlyLoadingGameId = gameId;

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –Ω–µ–¥–∞–≤–Ω–∏–µ
        if (gameDataToStore && gameDataToStore.id) {
            try {
                 const MAX_RECENT_GAMES = 9;
                 let recentGames = JSON.parse(localStorage.getItem('recentGamesList') || '[]');
                recentGames = recentGames.filter(g => g.id !== gameDataToStore.id);

                let recentRomUrl = '';
                if (typeof romFile === 'string') {
                    recentRomUrl = romFile;
                } else {
                    recentRomUrl = gameDataToStore.romUrl;
                }

                 if (recentRomUrl) {
                     recentGames.unshift({
                         id: gameDataToStore.id,
                         title: gameDataToStore.title,
                         romUrl: recentRomUrl,
                         genre: gameDataToStore.genre
                     });
                     recentGames = recentGames.slice(0, MAX_RECENT_GAMES);
                     localStorage.setItem('recentGamesList', JSON.stringify(recentGames));
                 }
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä:", e);
            }
        } else if (gameId === null && typeof romFile === 'object') {
             console.log("–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∫–∞–∫ —Ñ–∞–π–ª –∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ, –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–µ–¥–∞–≤–Ω–∏–µ.");
        }

        // --- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–∞–ø—É—Å–∫—É —ç–º—É–ª—è—Ç–æ—Ä–∞ ---
        window.currentRomUrl = romFile;
        window.currentGameName = gameName;
        window.orientationShown = false; // –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
        window.isEmulatorActive = true; // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

        mainContent.classList.add('hidden');
        searchResultsArea.classList.add('hidden');
        document.getElementById('game-page-area').classList.add('hidden');
        if (alphaListOverlay) alphaListOverlay.classList.add('hidden');
        document.body.style.overflow = 'hidden'; // –ó–∞–ø—Ä–µ—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É

        display.classList.remove('hidden');
        backButton.style.display = 'flex';
        reloadEmulatorButton.style.display = 'flex';

        if (isMobile) {
            enableFullscreen(); // –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
        }

        // --- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ EJS ---
        window.EJS_player = "#game";
        window.EJS_gameName = gameName;
        window.EJS_biosUrl = "";
        window.EJS_gameUrl = romFile;
        window.EJS_core = 'nes';
        window.EJS_pathtodata = "data/";
        window.EJS_startOnLoaded = true;
        window.EJS_DEBUG_XX = enableDebug;
        window.EJS_disableDatabases = true;
        window.EJS_threads = enableThreads;
        window.EJS_language = "ru-RU";
        window.EJS_Buttons = {
            playPause: true, restart: true, mute: false, settings: false, fullscreen: true,
            saveState: false, loadState: false, screenRecord: false, gamepad: false, cheat: false,
            volume: true, saveSavFiles: false, loadSavFiles: false, quickSave: false, quickLoad: false,
            screenshot: false, cacheManager: false, exitEmulation: false, fastForward: false, rewind: false
         };

        window.EJS_onGameStart = function() {
            const startedGameId = window.currentlyLoadingGameId;
            console.log('EJS_onGameStart triggered. Game ID:', startedGameId);

            // –î–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            const gameStartedEvent = new CustomEvent('gameStarted', {
                 detail: { gameId: startedGameId }
            });
            document.dispatchEvent(gameStartedEvent);

            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.expand();
            }
            setTimeout(fixCanvasScaling, 1000); // –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

            document.querySelectorAll('.ejs_menu_button, .ejs_context_menu li').forEach(el => {
               const text = el.innerText.trim().toLowerCase();
               if (text === 'fast' || text === 'slow') {
                 el.remove();
               }
            });
            window.currentlyLoadingGameId = null;
        };

        // --- –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–∫—Ä–∏–ø—Ç —ç–º—É–ª—è—Ç–æ—Ä–∞ ---
        const script = document.createElement("script");
        script.id = "emulatorScript";
        script.src = "data/loader.js";
        const oldScript = document.getElementById('emulatorScript');
        if (oldScript) {
            oldScript.remove();
        }
        document.body.appendChild(script);
    } // --- –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ loadGame ---


    // --- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç–º—É–ª—è—Ç–æ—Ä–æ–º, UI ---
    function checkOrientation() {
         if (!window.isEmulatorActive || window.orientationShown || !isMobile) {
             orientationMessage.style.display = 'none';
             return;
         }
         const isLandscape = window.innerWidth > window.innerHeight;
         orientationMessage.style.display = isLandscape ? 'none' : 'flex';
     }

    function fixCanvasScaling() {
        const canvas = document.querySelector('#game canvas');
        if (canvas) {
            canvas.style.imageRendering = 'pixelated';
            canvas.style.width = '';
            canvas.style.height = '';
            const gameDiv = document.getElementById('game');
            if(gameDiv) {
                gameDiv.style.display = 'none';
                void gameDiv.offsetWidth; // –¢—Ä—é–∫ –¥–ª—è —Ä–µ—Ñ–ª–æ—É
                gameDiv.style.display = '';
            }
            console.log("Attempted to fix canvas scaling.");
        } else {
             console.log("Canvas not found for scaling fix.");
        }
    }

    function enableFullscreen() {
         document.body.classList.add('fullscreen-mode');
         console.log("Fullscreen mode enabled.");
         setTimeout(checkOrientation, 100);
         setTimeout(fixCanvasScaling, 200);
     }

    function reloadEmulator() {
        if (window.currentRomUrl && window.currentGameName) {
            console.log("Reloading emulator for:", window.currentGameName);
            loadGame(window.currentRomUrl, window.currentGameName, defaultCore); // –í—ã–∑–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
        } else {
            console.log("Cannot reload emulator: current game data missing.");
            loadingState.style.display = 'none';
        }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
    function initTelegramWebApp() {
        if (window.Telegram && window.Telegram.WebApp) {
            const tg = window.Telegram.WebApp;
            tg.ready();
            console.log("Telegram Web App SDK initialized.");
            // tg.expand();
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –ù–∞–∑–∞–¥ Telegram (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
            // tg.BackButton.onClick(() => { /* ... */ });
            // –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –ù–∞–∑–∞–¥ Telegram
            // if (!mainContent.classList.contains('hidden') || window.isEmulatorActive) {
            //     tg.BackButton.show();
            // } else {
            //     tg.BackButton.hide();
            // }
        } else {
            console.log("Telegram Web App SDK not found.");
        }
    }

    // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π ---
    backButton.addEventListener('click', function() {
         stopEmulator(); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
         display.classList.add('hidden');
         backButton.style.display = 'none';
         reloadEmulatorButton.style.display = 'none';
         window.currentRomUrl = null;
         window.currentGameName = null;
         window.orientationShown = false;
         // window.isEmulatorActive = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ stopEmulator

         // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫—É–¥–∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è
         if (!searchResultsArea.classList.contains('hidden')) {
              searchResultsArea.classList.remove('hidden');
         } else if (alphaListOverlay && !alphaListOverlay.classList.contains('hidden')) {
              alphaListOverlay.classList.remove('hidden');
              document.body.style.overflow = 'hidden';
         } else {
              showMainContent(); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
         }
          document.body.style.overflow = ''; // –†–∞–∑—Ä–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª (–∫—Ä–æ–º–µ —Å–ª—É—á–∞—è —Å –æ–≤–µ—Ä–ª–µ–µ–º)
          if (alphaListOverlay && !alphaListOverlay.classList.contains('hidden')) {
              document.body.style.overflow = 'hidden';
          }

         document.body.classList.remove('fullscreen-mode');
         console.log("Fullscreen mode disabled by back button.");
         window.scrollTo(0, 0);
    });

    reloadEmulatorButton.addEventListener('click', function() {
        loadingState.style.display = 'flex';
        setTimeout(() => {
            reloadEmulator(); // –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
            setTimeout(() => {
                 loadingState.style.display = 'none';
            }, 1500);
        }, 500);
    });

    window.addEventListener('orientationchange', () => setTimeout(checkOrientation, 300));
    window.addEventListener('resize', () => {
        checkOrientation();
        if (window.isEmulatorActive) {
            setTimeout(fixCanvasScaling, 100);
        }
    });

    startPlayButton.addEventListener('click', (event) => {
        event.stopPropagation();
        window.orientationShown = true;
        orientationMessage.style.display = 'none';
    });
    orientationMessage.addEventListener('click', function() {
        window.orientationShown = true;
        this.style.display = 'none';
    });

    searchButton.addEventListener('click', performSearch);
    searchInput.addEventListener('keydown', (event) => {
        if (event.key === 'Enter') {
            event.preventDefault();
            performSearch();
        }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (–∫—Ä–æ–º–µ —Ç–µ—Ö, —á—Ç–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ updateNavigationHandlers)
    if (recentGamesButton) recentGamesButton.addEventListener('click', showRecentGames);
    if (catalogButton) catalogButton.addEventListener('click', () => showCatalog(window.fullCatalogGames, "–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä")); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è
    if (popularButton) popularButton.addEventListener('click', showPopularGames); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è
    if (topGamesButton) topGamesButton.addEventListener('click', showTopGames); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è

    if (shareButton) {
        shareButton.addEventListener('click', () => {
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initData) {
                 // !!! –ó–ê–ú–ï–ù–ò–¢–ï 'YourBotUsername' –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –∏–º—è –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ !!!
                 const botUrl = "https://t.me/YourBotUsername_bot"; // –ü—Ä–∏–º–µ—Ä
                const shareText = encodeURIComponent("–ó–∞—Ü–µ–Ω–∏ –∫—Ä—É—Ç–æ–π —ç–º—É–ª—è—Ç–æ—Ä –î–µ–Ω–¥–∏ –ø—Ä—è–º–æ –≤ –¢–µ–ª–µ–≥—Ä–∞–º!");
                const shareUrl = `https://t.me/share/url?url=${encodeURIComponent(botUrl)}&text=${shareText}`;
                window.Telegram.WebApp.openLink(shareUrl);
            } else {
                alert("–§—É–Ω–∫—Ü–∏—è '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è' —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram.");
            }
        });
    }

    if (randomButton) {
        randomButton.addEventListener('click', () => {
            if (window.fullCatalogGames && window.fullCatalogGames.length > 0) {
                const randomIndex = Math.floor(Math.random() * window.fullCatalogGames.length);
                const randomGame = window.fullCatalogGames[randomIndex];
                 const romPath = randomGame.romUrl || `roms/catalog/${randomGame.filename}`;
                  if (romPath) {
                     loadGameFromUrl(romPath, randomGame.title); // –õ–æ–∫–∞–ª—å–Ω–∞—è
                 } else {
                     console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å romUrl –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–π –∏–≥—Ä—ã:", randomGame);
                     alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Å–ª—É—á–∞–π–Ω–æ–π –∏–≥—Ä—ã.");
                 }
            } else {
                 alert("–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä –ø—É—Å—Ç!");
            }
        });
    }

    // --- –ê–ª—Ñ–∞–≤–∏—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫ ---
    if (alphaSortButton && alphaListOverlay && alphaListContent && alphaListCloseBtn && window.fullCatalogGames) {
         alphaSortButton.addEventListener('click', () => {
             const sortedCatalog = [...window.fullCatalogGames].sort((a, b) =>
                 a.title.localeCompare(b.title, 'ru', { sensitivity: 'base' })
             );
             alphaListContent.innerHTML = '';
             sortedCatalog.forEach(game => {
                 if (!game || !game.id || !game.title) {
                      console.warn("–ü—Ä–æ–ø—É—Å–∫ –∏–≥—Ä—ã (–∞–ª—Ñ–∞–≤–∏—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫) —Å –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:", game);
                      return;
                 }
                 const listItem = document.createElement('button');
                 listItem.className = 'alpha-list-item';
                 listItem.dataset.gameId = game.id;
                 const isInFavorites = favoritesManager.isInFavorites(game.id);
                 listItem.innerHTML = `
                      ${isInFavorites ? '<span class="favorite-indicator">‚òÖ</span>' : ''}
                      ${game.title}
                 `;
                 const starIndicator = listItem.querySelector('.favorite-indicator');
                 if (starIndicator && !isInFavorites) {
                     starIndicator.style.display = 'none';
                 }

                 listItem.addEventListener('click', () => {
                      // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è findGameDataById (–≥–ª–æ–±–∞–ª—å–Ω–∞—è)
                      const selectedGame = window.findGameDataById(listItem.dataset.gameId);
                      if (selectedGame) {
                           showGamePage(selectedGame); // –õ–æ–∫–∞–ª—å–Ω–∞—è
                           alphaListOverlay.classList.add('hidden');
                           document.body.style.overflow = '';
                      } else {
                           console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã —Å ID:", listItem.dataset.gameId);
                           alert("–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∏–≥—Ä—ã.");
                      }
                 });
                 alphaListContent.appendChild(listItem);
             });
             alphaListOverlay.classList.remove('hidden');
             document.body.style.overflow = 'hidden';
             mainContent.classList.add('hidden');
             searchResultsArea.classList.add('hidden');
             display.classList.add('hidden');
             document.getElementById('game-page-area').classList.add('hidden');
         });

        alphaListCloseBtn.addEventListener('click', () => {
            alphaListOverlay.classList.add('hidden');
            document.body.style.overflow = '';
            showMainContent(); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è
        });
         alphaListOverlay.addEventListener('click', (event) => {
             if (event.target === alphaListOverlay) {
                 alphaListOverlay.classList.add('hidden');
                 document.body.style.overflow = '';
                 showMainContent(); // –ì–ª–æ–±–∞–ª—å–Ω–∞—è
             }
         });
    } else {
        console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–ª—Ñ–∞–≤–∏—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫: —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –∏–ª–∏ –∫–∞—Ç–∞–ª–æ–≥ –ø—É—Å—Ç.");
        if (alphaSortButton) {
             alphaSortButton.disabled = true;
             alphaSortButton.style.opacity = '0.5';
             alphaSortButton.style.cursor = 'not-allowed';
        }
    }
    // --- –ö–æ–Ω–µ—Ü –ê–ª—Ñ–∞–≤–∏—Ç–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ ---

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ---
    // –ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è renderGamesGrid (—Ç–µ–ø–µ—Ä—å –≥–ª–æ–±–∞–ª—å–Ω–∞—è)
    if (typeof window.renderGamesGrid === 'function' && initialRetroGamesGrid) {
         window.renderGamesGrid(window.libraryGames, initialRetroGamesGrid); // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ "8-BIT –•–ò–¢–´"
    } else {
         console.warn("renderGamesGrid –∏–ª–∏ initialRetroGamesGrid –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –æ—Ç—Ä–∏—Å–æ–≤–∫–∏");
    }
    initTelegramWebApp(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SDK –¢–µ–ª–µ–≥—Ä–∞–º

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è featured-card (–∫—Ä–æ–º–µ –∫–∞—Ç–∞–ª–æ–≥–∞)
    document.querySelectorAll('.featured-card:not(#catalog-btn)').forEach(card => {
        card.addEventListener('click', function() {
            const title = this.querySelector('.featured-title').textContent;
            if (title === "–ü–†–û–î–û–õ–ñ–ò–¢–¨ –ò–ì–†–£") {
                 try {
                    const recentGames = JSON.parse(localStorage.getItem('recentGamesList') || '[]');
                     if (recentGames.length > 0) {
                        const lastGame = recentGames[0];
                        console.log("–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏–≥—Ä—É:", lastGame.title);
                        loadGameFromUrl(lastGame.romUrl, lastGame.title); // –õ–æ–∫–∞–ª—å–Ω–∞—è
                    } else {
                        alert("–ù–µ—Ç –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è.");
                    }
                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ–¥–∞–≤–Ω–∏—Ö –∏–≥—Ä –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è:", e);
                    alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∏–≥—Ä—É.");
                }
            }
        });
    });

     // –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å –∑–∞ DOM –¥–ª—è —Ñ–∏–∫—Å–∞ –∫–∞–Ω–≤–∞—Å–∞
     const observer = new MutationObserver((mutations) => {
         mutations.forEach((mutation) => {
             if (mutation.addedNodes && mutation.addedNodes.length > 0) {
                 for (let i = 0; i < mutation.addedNodes.length; i++) {
                     const node = mutation.addedNodes[i];
                     if (node.nodeName === 'CANVAS' || (node.querySelector && node.querySelector('canvas'))) {
                         console.log("Canvas added to DOM, attempting resize fix.");
                         setTimeout(fixCanvasScaling, 50); // –õ–æ–∫–∞–ª—å–Ω–∞—è
                         break;
                     }
                 }
             }
         });
     });
     // –ù–∞—á–∏–Ω–∞–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –∏–≥—Ä—ã
     const gameContainer = document.getElementById('game');
     if (gameContainer) {
        observer.observe(gameContainer, { childList: true, subtree: true });
     } else {
        console.error("–ù–µ –Ω–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä #game –¥–ª—è MutationObserver");
     }

}); // --- –ö–æ–Ω–µ—Ü DOMContentLoaded ---


// --- –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (–∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –±—ã–ª, —Ç.–∫. –æ–Ω —É–∂–µ —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –∏–ª–∏ –≤ —Å–≤–æ–µ–º DOMContentLoaded) ---
class AchievementSystem {
    constructor() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–≤—É–∫, –Ω–æ –Ω–µ –ø—ã—Ç–∞–µ–º—Å—è –µ–≥–æ —Å—Ä–∞–∑—É –∑–∞–≥—Ä—É–∑–∏—Ç—å
        this.achievementSound = null;
        this.soundInitialized = false;
        // –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        this.achievements = [
             { id: 'first_game', icon: 'üéÆ', title: '–ü–µ—Ä–≤–∞—è –∏–≥—Ä–∞', description: '–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª—é–±—É—é –∏–≥—Ä—É –≤–ø–µ—Ä–≤—ã–µ', secret: false, game: null, condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'game_master', icon: 'üëë', title: '–ò–≥—Ä–æ–≤–æ–π –º–∞—Å—Ç–µ—Ä', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ 10 —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä', secret: false, game: null, condition: null, progress: { current: 0, max: 10 } },
             { id: 'collector', icon: '‚≠ê', title: '–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä', description: '–î–æ–±–∞–≤—å—Ç–µ 5 –∏–≥—Ä –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ', secret: false, game: null, condition: null, progress: { current: 0, max: 5 } },
             { id: 'mario_fan', icon: 'üçÑ', title: '–§–∞–Ω–∞—Ç –ú–∞—Ä–∏–æ', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –ø—Ä–æ –ú–∞—Ä–∏–æ', secret: false, game: ['mario', 'super_mario_bros_2_rus', 'super_mario_bros_3_e_t_rus_by_2r_team_2r_team', 'mario_bros'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'contra_commando', icon: 'üî´', title: '–ö–æ–º–º–∞–Ω–¥–æ', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –∏–∑ —Å–µ—Ä–∏–∏ Contra', secret: false, game: ['contra', 'contra_force', 'super_contra'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'ninja_warrior', icon: 'ü•∑', title: '–ù–∏–Ω–¥–∑—è-–≤–æ–∏–Ω', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –æ –Ω–∏–Ω–¥–∑—è', secret: false, game: ['ninja_gaiden', 'shadow_of_the_ninja'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'tank_commander', icon: 'üèÜ', title: '–¢–∞–Ω–∫–æ–≤—ã–π –∫–æ–º–∞–Ω–¥–∏—Ä', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ Battle City', secret: false, game: ['battle_city', 'tank_1990'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'megaman_hero', icon: 'ü§ñ', title: '–ì–µ—Ä–æ–π –ú–µ–≥–∞–º–µ–Ω', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –ª—é–±—É—é –∏–≥—Ä—É –ø—Ä–æ –ú–µ–≥–∞–º–µ–Ω–∞', secret: false, game: ['mega_man', 'mega_man2', 'mega_man3', 'mega_man4', 'mega_man5', 'megaman6'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'turtles_fan', icon: 'üê¢', title: '–§–∞–Ω–∞—Ç —á–µ—Ä–µ–ø–∞—à–µ–∫', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –∏–∑ —Å–µ—Ä–∏–∏ TMNT', secret: false, game: ['teenage_mutant_ninja_turtles_rus', 'teenage_mutant_ninja_turtles_ii_the_arcade_game', 'teenage_mutant_ninja_turtles_tournament_fighters', 'teenage_manhattan'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'disney_adventurer', icon: 'ü¶Ü', title: '–î–∏—Å–Ω–µ–π-–ø—Ä–∏–∫–ª—é—á–µ–Ω–µ—Ü', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –ø–æ –º—É–ª—å—Ç—Ñ–∏–ª—å–º—É Disney', secret: false, game: ['duck_tales', 'duck_tales_2', 'chip_n_dale_rescue_rangers_rus', 'chip_n_dale_rescue_rangers_2_u_t_rus_by_shedevr', 'darkwing_duck_u', 'talespin'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'night_gamer', icon: 'üåô', title: '–ù–æ—á–Ω–æ–π –≥–µ–π–º–µ—Ä', description: '–ò–≥—Ä–∞–π—Ç–µ –º–µ–∂–¥—É 23:00 –∏ 5:00', secret: true, game: null, condition: () => { const hour = new Date().getHours(); return hour >= 23 || hour < 5; }, progress: { current: 0, max: 1 } },
             { id: 'explorer', icon: 'üîç', title: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å', description: '–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏—è 20 —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä', secret: false, game: null, condition: null, progress: { current: 0, max: 20 } }, // –ò–∑–º–µ–Ω–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ
             { id: 'early_bird', icon: 'üê¶', title: '–†–∞–Ω–Ω—è—è –ø—Ç–∞—à–∫–∞', description: '–ò–≥—Ä–∞–π—Ç–µ –º–µ–∂–¥—É 5:00 –∏ 8:00 —É—Ç—Ä–∞', secret: true, game: null, condition: () => { const hour = new Date().getHours(); return hour >= 5 && hour < 8; }, progress: { current: 0, max: 1 } },
             { id: 'weekend_warrior', icon: 'üé≠', title: '–í—ã—Ö–æ–¥–Ω–æ–π –≤–æ–∏–Ω', description: '–ò–≥—Ä–∞–π—Ç–µ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏', secret: false, game: null, condition: () => { const day = new Date().getDay(); return day === 0 || day === 6; }, progress: { current: 0, max: 1 } },
             { id: 'tetris_champion', icon: 'üß©', title: '–ú–∞—Å—Ç–µ—Ä –±–ª–æ–∫–æ–≤', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ Tetris', secret: false, game: ['tetris'], condition: () => true, progress: { current: 0, max: 1 } }
        ];
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∑–≤—É–∫–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        document.addEventListener('click', () => {
            if (!this.soundInitialized) {
                try {
                    this.achievementSound = new Audio('data/sound/achievement.mp3');
                    this.achievementSound.volume = 0.7;
                    this.soundInitialized = true;
                    console.log("Achievement sound initialized on user interaction.");
                 } catch (e) {
                     console.error("Failed to initialize achievement sound:", e);
                 }
            }
        }, { once: true }); // –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑

        this.unlockedAchievements = this.loadUnlockedAchievements();
        this.viewedGames = this.loadViewedGames();
        this.playedGames = this.loadPlayedGames();
        this.newAchievements = this.loadNewAchievements();
        this.container = document.getElementById('achievements-container');
        this.menu = document.getElementById('achievements-menu');
        this.menuContent = document.getElementById('achievements-content');
        this.statsCompleted = document.getElementById('stats-completed');
        this.statsTotal = document.getElementById('stats-total');
        this.statsPercentage = document.getElementById('stats-percentage');

        this.initEvents();
        this.renderAchievementsMenu();
        this.updateNotificationBadge();
        this.checkInitialProgress();
        console.log("AchievementSystem initialized.");
    }

    loadData(key, defaultValue) { try { const saved = localStorage.getItem(key); return saved ? JSON.parse(saved) : defaultValue; } catch (e) { console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ${key}:`, e); return defaultValue; } }
    saveData(key, data) { try { localStorage.setItem(key, JSON.stringify(data)); } catch (e) { console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ ${key}:`, e); } }
    loadUnlockedAchievements() { return this.loadData('unlockedAchievements', {}); }
    saveUnlockedAchievements() { this.saveData('unlockedAchievements', this.unlockedAchievements); }
    loadViewedGames() { return this.loadData('viewedGames', []); }
    saveViewedGames() { this.saveData('viewedGames', this.viewedGames); }
    loadPlayedGames() { return this.loadData('playedGames', []); }
    savePlayedGames() { this.saveData('playedGames', this.playedGames); }
    loadNewAchievements() { return this.loadData('newAchievements', []); }
    saveNewAchievements() { this.saveData('newAchievements', this.newAchievements); }

    updateNotificationBadge() {
        const achievementsButton = document.querySelector('.navigation .nav-button[title="–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è"]');
        if (!achievementsButton) return;
        let badge = achievementsButton.querySelector('.achievements-notification');
        if (this.newAchievements.length > 0) {
            if (!badge) {
                badge = document.createElement('div');
                badge.className = 'achievements-notification';
                achievementsButton.appendChild(badge);
            }
            badge.textContent = this.newAchievements.length;
            requestAnimationFrame(() => { badge.classList.add('active'); });
        } else if (badge) {
            badge.classList.remove('active');
        }
    }

    initEvents() {
         const closeButton = document.getElementById('achievements-close');
         if (closeButton) {
            closeButton.addEventListener('click', () => this.hideAchievementsMenu());
         } else {
             console.error("–ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!");
         }

         const navigation = document.querySelector('.navigation');
         let achievementsButton = document.querySelector('.nav-button[title="–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è"]');
         if (navigation && !achievementsButton) {
             achievementsButton = document.createElement('button');
             achievementsButton.className = 'nav-button';
             achievementsButton.title = '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è';
             achievementsButton.innerHTML = 'üèÖ';
             navigation.appendChild(achievementsButton);
             console.log("–ö–Ω–æ–ø–∫–∞ '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è' –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é.");
         }
         if (achievementsButton) {
             achievementsButton.addEventListener('click', () => this.showAchievementsMenu());
         } else {
             console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∫–Ω–æ–ø–∫—É '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è'.");
         }

        document.addEventListener('gameStarted', (e) => {
            if (e.detail && e.detail.gameId !== undefined) {
                 console.log("Event 'gameStarted' received with id:", e.detail.gameId);
                 this.onGameStarted(e.detail.gameId);
            } else {
                 console.warn("Event 'gameStarted' received without gameId in detail.");
                 this.onGameStarted(null);
            }
        });
        document.addEventListener('gameViewed', (e) => {
            if (e.detail && e.detail.gameId) {
                 console.log("Event 'gameViewed' received with id:", e.detail.gameId);
                 this.onGameViewed(e.detail.gameId);
            } else {
                 console.warn("Event 'gameViewed' received without gameId in detail.");
            }
        });
        document.addEventListener('favoriteAdded', (e) => {
             console.log("Event 'favoriteAdded' received.");
             this.checkCollectorAchievement();
        });
        this.checkTimeBasedAchievements();
        setInterval(() => { this.checkTimeBasedAchievements(); }, 60000);
    }

     checkInitialProgress() {
         this.checkCollectorAchievement();
         this.checkGameMasterAchievement();
         this.checkExplorerAchievement();
         console.log("Initial achievement progress checked.");
     }

    onGameStarted(gameId) {
        console.log("AchievementSystem: onGameStarted processing for gameId:", gameId);
        const firstGameAch = this.achievements.find(a => a.id === 'first_game');
        if (firstGameAch && !this.isUnlocked('first_game')) {
             this.unlockAchievement('first_game');
        }

        if (gameId) {
            this.achievements.forEach(achievement => {
                if (achievement.game && Array.isArray(achievement.game) && !this.isUnlocked(achievement.id) && achievement.game.includes(gameId)) {
                    if (typeof achievement.condition === 'function' && achievement.condition()) {
                        console.log(`AchievementSystem: Unlocking specific achievement: ${achievement.id} for game ${gameId}`);
                        if(achievement.progress.max === 1) {
                             this.unlockAchievement(achievement.id);
                        }
                    }
                }
            });
            const playedSet = new Set(this.playedGames);
            if (!playedSet.has(gameId)) {
                this.playedGames.push(gameId);
                this.savePlayedGames();
                console.log(`AchievementSystem: Added ${gameId} to played games. Total unique: ${this.playedGames.length}`);
                this.checkGameMasterAchievement();
            }
        } else {
            console.log("AchievementSystem: gameId is null, skipping game-specific checks and played games update.");
        }

        this.checkTimeBasedAchievements();
        this.renderAchievementsMenu();
    }

    onGameViewed(gameId) {
         console.log("AchievementSystem: onGameViewed processing for gameId:", gameId);
         if (!gameId) return;
         const viewedSet = new Set(this.viewedGames);
         if (!viewedSet.has(gameId)) {
            this.viewedGames.push(gameId);
            this.saveViewedGames();
            console.log(`AchievementSystem: Added ${gameId} to viewed games. Total unique: ${this.viewedGames.length}`);
            this.checkExplorerAchievement();
            this.renderAchievementsMenu();
         }
    }

     isUnlocked(achievementId) { return this.unlockedAchievements[achievementId] ? true : false; }

    checkGameMasterAchievement() {
        const achievement = this.achievements.find(a => a.id === 'game_master');
        if (achievement && !this.isUnlocked(achievement.id)) {
            achievement.progress.current = Math.min(this.playedGames.length, achievement.progress.max);
            console.log(`AchievementSystem: Game Master progress: ${achievement.progress.current}/${achievement.progress.max}`);
            if (achievement.progress.current >= achievement.progress.max) {
                this.unlockAchievement('game_master');
            }
            this.updateAchievementProgressDisplay('game_master');
        } else if (achievement && this.isUnlocked(achievement.id)) {
             achievement.progress.current = achievement.progress.max;
             this.updateAchievementProgressDisplay('game_master');
        }
    }

    checkCollectorAchievement() {
         const achievement = this.achievements.find(a => a.id === 'collector');
         if (achievement && !this.isUnlocked(achievement.id)) {
             const favorites = favoritesManager.getFavorites();
             achievement.progress.current = Math.min(favorites.length, achievement.progress.max);
             console.log(`AchievementSystem: Collector progress: ${achievement.progress.current}/${achievement.progress.max}`);
             if (achievement.progress.current >= achievement.progress.max) {
                 this.unlockAchievement('collector');
             }
             this.updateAchievementProgressDisplay('collector');
         } else if (achievement && this.isUnlocked(achievement.id)) {
             achievement.progress.current = achievement.progress.max;
             this.updateAchievementProgressDisplay('collector');
         }
    }

    checkExplorerAchievement() {
         const achievement = this.achievements.find(a => a.id === 'explorer');
         if (achievement && !this.isUnlocked(achievement.id)) {
             const uniqueViewedCount = new Set(this.viewedGames).size;
             achievement.progress.current = Math.min(uniqueViewedCount, achievement.progress.max);
             console.log(`AchievementSystem: Explorer progress: ${achievement.progress.current}/${achievement.progress.max}`);
             if (achievement.progress.current >= achievement.progress.max) {
                 this.unlockAchievement('explorer');
             }
             this.updateAchievementProgressDisplay('explorer');
         } else if (achievement && this.isUnlocked(achievement.id)) {
             achievement.progress.current = achievement.progress.max;
             this.updateAchievementProgressDisplay('explorer');
         }
    }

    checkTimeBasedAchievements() {
        this.achievements.forEach(achievement => {
            if (['night_gamer', 'early_bird', 'weekend_warrior'].includes(achievement.id) && !this.isUnlocked(achievement.id)) {
                if (typeof achievement.condition === 'function' && achievement.condition()) {
                    console.log(`AchievementSystem: Condition met for time-based achievement: ${achievement.id}`);
                     this.unlockAchievement(achievement.id);
                }
            }
        });
    }

    unlockAchievement(achievementId) {
        if (this.isUnlocked(achievementId)) { return; }
        const achievement = this.achievements.find(a => a.id === achievementId);
        if (!achievement) { console.error(`–ü–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${achievementId}`); return; }

        console.log(`AchievementSystem: Unlocking achievement '${achievement.title}' (${achievementId})`);
        const unlockTime = new Date().toISOString();
        this.unlockedAchievements[achievementId] = { unlocked: true, unlockTime: unlockTime };
        achievement.progress.current = achievement.progress.max;
         if (!this.newAchievements.includes(achievementId)) { this.newAchievements.push(achievementId); }

        this.saveUnlockedAchievements();
        this.saveNewAchievements();
        this.updateNotificationBadge();
        this.showAchievementPopup(achievement);
        this.renderAchievementsMenu();
    }

    updateAchievementProgressDisplay(achievementId) {
        const achievement = this.achievements.find(a => a.id === achievementId);
        if (!achievement || !this.menuContent) return;
        const card = this.menuContent.querySelector(`.achievement-card[data-id="${achievementId}"]`);
        if (card) {
            const progressBar = card.querySelector('.achievement-progress-bar');
            const progressContainer = card.querySelector('.achievement-progress');
            if (progressBar && progressContainer) {
                 const isAchUnlocked = this.isUnlocked(achievementId);
                 if (!isAchUnlocked && achievement.progress.max > 1) {
                     const percent = achievement.progress.max > 0 ? (achievement.progress.current / achievement.progress.max) * 100 : 0;
                     progressBar.style.width = `${percent}%`;
                     progressContainer.style.display = 'block';
                 } else {
                     progressBar.style.width = '0%';
                     progressContainer.style.display = 'none';
                 }
            }
             const dateElement = card.querySelector('.achievement-date');
             if (dateElement) {
                 const isAchUnlocked = this.isUnlocked(achievementId);
                 if(isAchUnlocked && this.unlockedAchievements[achievementId]?.unlockTime) {
                     const unlockDate = new Date(this.unlockedAchievements[achievementId].unlockTime);
                     const unlockDateStr = unlockDate.toLocaleDateString() + ' ' + unlockDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                     dateElement.textContent = '–ü–æ–ª—É—á–µ–Ω–æ: ' + unlockDateStr;
                     dateElement.style.display = 'block';
                 } else {
                     dateElement.style.display = 'none';
                 }
             }
        }
    }

    showAchievementPopup(achievement) {
        if (this.achievementSound && this.soundInitialized) {
            try {
                this.achievementSound.currentTime = 0;
                this.achievementSound.play().catch(error => { console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:', error); });
            } catch (e) { console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –∑–≤—É–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:', e); }
        }
         if (!this.container) { console.error("–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω!"); return; }

        const popup = document.createElement('div');
        popup.className = 'achievement-popup';
        popup.innerHTML = `
            <div class="achievement-icon">${achievement.icon}</div>
            <div class="achievement-content">
                <div class="achievement-title">${achievement.title}</div>
                <div class="achievement-description">${achievement.description}</div>
            </div>
        `;
        this.container.appendChild(popup);

        requestAnimationFrame(() => {
            popup.classList.add('show');
            setTimeout(() => {
                popup.classList.remove('show');
                popup.addEventListener('transitionend', () => {
                     // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º, —Ç.–∫. –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –±—ã—Å—Ç—Ä–æ –∑–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é
                     if (popup.parentNode === this.container) {
                         try { this.container.removeChild(popup); } catch(e) {/*–∏–≥–Ω–æ—Ä*/}
                     }
                }, { once: true });
            }, 4000);
        });
    }

    showAchievementsMenu() {
         if (!this.menu) { console.error("–≠–ª–µ–º–µ–Ω—Ç –º–µ–Ω—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω!"); return; }
        this.renderAchievementsMenu();
        this.menu.classList.add('active');
        document.body.style.overflow = 'hidden';
        this.newAchievements = [];
        this.saveNewAchievements();
        this.updateNotificationBadge();
        console.log("Achievements menu shown.");
    }

    hideAchievementsMenu() {
         if (!this.menu) return;
         this.menu.classList.remove('active');
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç–º—É–ª—è—Ç–æ—Ä –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω
        if (!window.isEmulatorActive) {
             document.body.style.overflow = '';
        }
        console.log("Achievements menu hidden.");
    }

    renderAchievementsMenu() {
         if (!this.menuContent || !this.statsCompleted || !this.statsTotal || !this.statsPercentage) { return; }

         const sortedAchievements = [...this.achievements].sort((a, b) => {
             const unlockedA = this.isUnlocked(a.id);
             const unlockedB = this.isUnlocked(b.id);
             if (unlockedA && !unlockedB) return -1;
             if (!unlockedA && unlockedB) return 1;
             if (unlockedA && unlockedB) {
                 const timeA = new Date(this.unlockedAchievements[a.id]?.unlockTime || 0).getTime();
                 const timeB = new Date(this.unlockedAchievements[b.id]?.unlockTime || 0).getTime();
                 return timeB - timeA;
             }
             return 0; // –∏–ª–∏ a.title.localeCompare(b.title);
         });

        this.menuContent.innerHTML = '';
        sortedAchievements.forEach(achievement => {
            const isAchUnlocked = this.isUnlocked(achievement.id);
            let title = achievement.title, description = achievement.description, icon = achievement.icon;
            if (achievement.secret && !isAchUnlocked) { title = "???"; description = "–°–µ–∫—Ä–µ—Ç–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ"; icon = '‚ùì'; }

            const card = document.createElement('div');
            card.className = `achievement-card ${isAchUnlocked ? 'unlocked' : ''} ${achievement.secret ? 'secret' : ''}`;
            card.dataset.id = achievement.id;
            const current = achievement.progress.current;
            const max = achievement.progress.max;
            const percent = max > 0 ? (current / max) * 100 : (isAchUnlocked ? 100 : 0);
            const unlockDate = isAchUnlocked ? new Date(this.unlockedAchievements[achievement.id]?.unlockTime || Date.now()) : null;
            const unlockDateStr = unlockDate ? unlockDate.toLocaleDateString() + ' ' + unlockDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '';

            card.innerHTML = `
                <div class="achievement-icon">${icon}</div>
                <div class="achievement-content">
                    <div class="achievement-title">${title}</div>
                    <div class="achievement-description">${description}</div>
                    <div class="achievement-date" style="display: ${isAchUnlocked ? 'block' : 'none'}">${isAchUnlocked ? '–ü–æ–ª—É—á–µ–Ω–æ: ' + unlockDateStr : ''}</div>
                    <div class="achievement-progress" style="display: ${!isAchUnlocked && max > 1 ? 'block' : 'none'}">
                        <div class="achievement-progress-bar" style="width: ${percent}%"></div>
                    </div>
                </div>
            `;
            this.menuContent.appendChild(card);
        });

        const unlockedCount = Object.keys(this.unlockedAchievements).length;
        const totalCount = this.achievements.length;
        const percentage = totalCount > 0 ? Math.floor((unlockedCount / totalCount) * 100) : 0;
        this.statsCompleted.textContent = unlockedCount;
        this.statsTotal.textContent = totalCount;
        this.statsPercentage.textContent = `${percentage}%`;
    }

} // --- –ö–æ–Ω–µ—Ü –∫–ª–∞—Å—Å–∞ AchievementSystem ---

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    // –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
    window.achievementSystem = new AchievementSystem();
     if (window.achievementSystem) {
         window.achievementSystem.checkInitialProgress();
     } else {
         console.error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç achievementSystem!");
     }
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∏–∞–ª–æ–≥ –≤—ã—Ö–æ–¥–∞ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
        initExitGameDialog(); // –¢–µ–ø–µ—Ä—å –æ–Ω —Å–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ stopEmulator –∏ show... —Ñ—É–Ω–∫—Ü–∏–∏
        updateNavigationHandlers();
    }, 500); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏
});

</script>

<style>
/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */
.achievements-container {
    position: fixed;
    top: 5px; /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
    right: 15px; /* –û—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ */
    z-index: 2000; /* –ü–æ–≤–µ—Ä—Ö –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
    display: flex;
    flex-direction: column; /* –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –¥—Ä—É–≥ –ø–æ–¥ –¥—Ä—É–≥–æ–º */
    gap: 10px; /* –û—Ç—Å—Ç—É–ø –º–µ–∂–¥—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ */
    pointer-events: none; /* –ù–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∫–ª–∏–∫–∏ –º—ã—à–∏ */
    max-width: 280px; /* –ú–∞–∫—Å —à–∏—Ä–∏–Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
}

/* –°—Ç–∏–ª—å –¥–ª—è –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è */
.achievement-popup {
    background: linear-gradient(135deg, #1e2033, #373b59); /* –ì—Ä–∞–¥–∏–µ–Ω—Ç —Ñ–æ–Ω–∞ */
    border: 2px solid #ff8c00; /* –û—Ä–∞–Ω–∂–µ–≤–∞—è —Ä–∞–º–∫–∞ */
    border-radius: 12px; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ */
    padding: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5); /* –¢–µ–Ω—å */
    display: flex;
    align-items: center; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É */
    gap: 10px; /* –û—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –∏–∫–æ–Ω–∫–æ–π –∏ —Ç–µ–∫—Å—Ç–æ–º */
    transform: translateX(120%); /* –ù–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∑–∞ —ç–∫—Ä–∞–Ω–æ–º */
    opacity: 0; /* –ù–∞—á–∞–ª—å–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å */
    transition: transform 0.5s ease, opacity 0.5s ease; /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
    pointer-events: auto; /* –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) */
    max-width: 100%;
}

.achievement-popup.show {
    transform: translateX(0); /* –ö–æ–Ω–µ—á–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ */
    opacity: 1; /* –ü–æ–ª–Ω–∞—è –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å */
}

.achievement-popup .achievement-icon {
    width: 40px;
    height: 40px;
    min-width: 40px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä */
    background: linear-gradient(135deg, #ff0080, #ff8c00); /* –Ø—Ä–∫–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç */
    border-radius: 50%; /* –ö—Ä—É–≥–ª–∞—è –∏–∫–æ–Ω–∫–∞ */
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px; /* –†–∞–∑–º–µ—Ä —ç–º–æ–¥–∑–∏ */
    color: white;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); /* –¢–µ–Ω—å –¥–ª—è —Ç–µ–∫—Å—Ç–∞ */
}

.achievement-popup .achievement-content {
    flex: 1; /* –ó–∞–Ω–∏–º–∞–µ—Ç –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –º–µ—Å—Ç–æ */
}

.achievement-popup .achievement-title {
    font-family: 'Press Start 2P', cursive; /* –ü–∏–∫—Å–µ–ª—å–Ω—ã–π —à—Ä–∏—Ñ—Ç */
    font-size: 12px;
    color: #fff;
    margin: 0 0 5px 0; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
    text-shadow: 1px 1px 0 #000; /* –¢–µ–Ω—å */
    line-height: 1.2;
}

.achievement-popup .achievement-description {
    font-size: 11px;
    color: #ddd; /* –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π */
    margin: 0;
    line-height: 1.2;
    opacity: 0.9; /* –ù–µ–º–Ω–æ–≥–æ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ */
}

/* –ê–Ω–∏–º–∞—Ü–∏—è —Å–≤–µ—á–µ–Ω–∏—è –¥–ª—è –∏–∫–æ–Ω–∫–∏ */
@keyframes glow {
    0% { box-shadow: 0 0 5px rgba(255, 140, 0, 0.7); }
    50% { box-shadow: 0 0 15px rgba(255, 140, 0, 0.9); }
    100% { box-shadow: 0 0 5px rgba(255, 140, 0, 0.7); }
}

/* –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–≤–µ—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏–∫–æ–Ω–∫–∞–º */
.achievement-icon.unlocked-icon-glow {
    animation: glow 2s infinite;
}
.achievement-popup .achievement-icon {
     animation: glow 2s infinite; /* –°–≤–µ—á–µ–Ω–∏–µ –¥–ª—è –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –æ–∫–Ω–∞ */
}

/* –ú–µ–Ω—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */
.achievements-menu {
    position: fixed; /* –ü–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(30, 32, 51, 0.97); /* –ü–æ—á—Ç–∏ –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
    z-index: 3000; /* –í—ã—à–µ –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ */
    display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
    flex-direction: column;
    overflow: hidden; /* –ß—Ç–æ–±—ã –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–∫—Ä–æ–ª–ª —Ä–∞–±–æ—Ç–∞–ª */
    overscroll-behavior: contain; /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª body –ø–æ–¥ –º–µ–Ω—é */
}

.achievements-menu.active {
    display: flex; /* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é */
}

.achievements-header {
    display: flex;
    justify-content: space-between; /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–ª–µ–≤–∞, –∫–Ω–æ–ø–∫–∞ —Å–ø—Ä–∞–≤–∞ */
    align-items: center;
    padding: 15px;
    background: linear-gradient(90deg, #ff0080, #ff8c00); /* –ì—Ä–∞–¥–∏–µ–Ω—Ç —à–∞–ø–∫–∏ */
    border-bottom: 2px solid rgba(255, 255, 255, 0.1); /* –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å */
    flex-shrink: 0; /* –®–∞–ø–∫–∞ –Ω–µ —Å–∂–∏–º–∞–µ—Ç—Å—è */
}

.achievements-title {
    font-family: 'Press Start 2P', cursive;
    color: white;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    margin: 0;
    font-size: 16px;
}

.achievements-close {
    background: none;
    border: none;
    color: white;
    font-size: 28px; /* –†–∞–∑–º–µ—Ä –∫—Ä–µ—Å—Ç–∏–∫–∞ */
    font-weight: bold;
    cursor: pointer;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    transition: background-color 0.2s;
}

.achievements-close:hover {
    background-color: rgba(0, 0, 0, 0.2); /* –§–æ–Ω –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
}

.achievements-stats {
    padding: 15px;
    background-color: rgba(0, 0, 0, 0.2); /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
    display: flex;
    justify-content: space-around;
    align-items: center;
    flex-shrink: 0; /* –ë–ª–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–µ —Å–∂–∏–º–∞–µ—Ç—Å—è */
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.stats-item {
    text-align: center;
    min-width: 80px;
}

.stats-value {
    font-family: 'Press Start 2P', cursive;
    font-size: 18px;
    color: #ff8c00; /* –û—Ä–∞–Ω–∂–µ–≤—ã–π —Ü–≤–µ—Ç */
    margin: 0 0 5px 0;
}

.stats-label {
    font-size: 12px;
    color: #ddd;
    margin: 0;
}

.achievements-content {
    flex: 1; /* –ó–∞–Ω–∏–º–∞–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –º–µ—Å—Ç–æ */
    overflow-y: auto; /* –í–∫–ª—é—á–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    padding: 15px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ */
    gap: 15px; /* –û—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ */
    align-content: start; /* –ö–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å–≤–µ—Ä—Ö—É */
     /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
     scrollbar-width: thin; /* Firefox */
     scrollbar-color: #ff8c00 #555; /* Firefox - —Ü–≤–µ—Ç –ø–æ–ª–∑—É–Ω–∫–∞ –∏ —Ç—Ä–µ–∫–∞ */
}
.achievements-content::-webkit-scrollbar {
  width: 8px;
}
.achievements-content::-webkit-scrollbar-track {
  background: #373b59; /* –§–æ–Ω —Ç—Ä–µ–∫–∞ */
  border-radius: 4px;
}
.achievements-content::-webkit-scrollbar-thumb {
  background-color: #ff8c00; /* –¶–≤–µ—Ç –ø–æ–ª–∑—É–Ω–∫–∞ */
  border-radius: 4px;
  border: 2px solid #373b59; /* –û—Ç—Å—Ç—É–ø –ø–æ–ª–∑—É–Ω–∫–∞ –æ—Ç –∫—Ä–∞–µ–≤ —Ç—Ä–µ–∫–∞ */
}


.achievement-card {
    background: linear-gradient(135deg, #2a2d45, #373b59); /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω */
    border-radius: 12px;
    padding: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1); /* –°–ª–µ–≥–∫–∞ –≤–∏–¥–∏–º–∞—è —Ä–∞–º–∫–∞ */
    transition: transform 0.2s, box-shadow 0.2s;
}

.achievement-card:hover {
    transform: translateY(-3px); /* –ù–µ–±–æ–ª—å—à–æ–π –ø–æ–¥—ä–µ–º –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); /* –¢–µ–Ω—å –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
}

.achievement-card .achievement-icon {
    filter: grayscale(100%); /* –ß–µ—Ä–Ω–æ-–±–µ–ª–∞—è –∏–∫–æ–Ω–∫–∞ –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö */
    animation: none; /* –£–±–∏—Ä–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é */
    opacity: 0.5; /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è */
}

.achievement-card.unlocked .achievement-icon {
    filter: none; /* –¶–≤–µ—Ç–Ω–∞—è –∏–∫–æ–Ω–∫–∞ */
    opacity: 1; /* –ù–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è */
    /* animation: glow 2s infinite; –£–±–∏—Ä–∞–µ–º –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –∏–∑ –º–µ–Ω—é */
}
/* –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–µ—á–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É */
.achievement-card.unlocked:hover .achievement-icon {
     animation: glow 2s infinite;
}


.achievement-card.unlocked {
    background: linear-gradient(135deg, #3a3d55, #474b69); /* –ß—É—Ç—å —Å–≤–µ—Ç–ª–µ–µ —Ñ–æ–Ω –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö */
    border: 1px solid rgba(255, 140, 0, 0.3); /* –û—Ä–∞–Ω–∂–µ–≤–∞—è —Ä–∞–º–∫–∞ */
}

.achievement-card .achievement-content {
    flex: 1;
}

.achievement-card .achievement-title {
    font-size: 13px;
    margin-bottom: 5px;
    color: #ccc; /* –°–µ—Ä—ã–π –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö */
}
.achievement-card.unlocked .achievement-title {
     color: #fff; /* –ë–µ–ª—ã–π –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö */
}


.achievement-card .achievement-description {
    font-size: 11px;
    color: #888; /* –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö */
}
.achievement-card.unlocked .achievement-description {
     color: #ddd; /* –°–≤–µ—Ç–ª–µ–µ –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö */
}

.achievement-card .achievement-date {
    font-size: 10px;
    color: #777;
    margin-top: 5px;
    display: none; /* –°–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
}

.achievement-card.unlocked .achievement-date {
    display: block; /* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞—Ç—É –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö */
    color: #ffae42; /* –°–≤–µ—Ç–ª–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –¥–∞—Ç—ã */
}

.achievement-card .achievement-progress {
    width: 100%;
    height: 5px;
    background-color: rgba(255, 255, 255, 0.1); /* –§–æ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ */
    border-radius: 3px;
    margin-top: 5px;
    overflow: hidden;
    display: none; /* –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
}
/* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω */
.achievement-card:not(.unlocked) .achievement-progress {
     display: block;
}


.achievement-card .achievement-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #ff0080, #ff8c00); /* –ì—Ä–∞–¥–∏–µ–Ω—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
    width: 0%; /* –ù–∞—á–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
    transition: width 0.3s ease;
    border-radius: 3px;
}

/* –î–ª—è —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */
.achievement-card.secret:not(.unlocked) .achievement-title {
    color: #aaa; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –¥–ª—è —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ */
}
.achievement-card.secret:not(.unlocked) .achievement-description {
     color: #777;
}
.achievement-card.secret:not(.unlocked) .achievement-icon {
     opacity: 0.3;
}


/* –ö–Ω–æ–ø–∫–∞ "–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è" –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
.nav-button[title="–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è"] {
    position: relative; /* –î–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–∫–∞ */
}

.achievements-notification {
    position: absolute;
    top: -5px; /* –ü–æ–ª–æ–∂–µ–Ω–∏–µ –∑–Ω–∞—á–∫–∞ */
    right: -5px;
    background-color: #ff0080; /* –Ø—Ä–∫–∏–π —Ü–≤–µ—Ç */
    color: white;
    font-size: 10px; /* –†–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞ */
    width: 16px; /* –†–∞–∑–º–µ—Ä –∑–Ω–∞—á–∫–∞ */
    height: 16px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    opacity: 0; /* –°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
    transform: scale(0); /* –°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
    transition: transform 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28), opacity 0.3s; /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
    pointer-events: none;
    border: 1px solid rgba(0,0,0,0.3); /* –¢–æ–Ω–∫–∞—è —Ä–∞–º–∫–∞ */
}

.achievements-notification.active {
    opacity: 1; /* –ü–æ–∫–∞–∑–∞—Ç—å */
    transform: scale(1); /* –ü–æ–∫–∞–∑–∞—Ç—å */
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
@media (max-width: 600px) {
    .achievements-content {
        grid-template-columns: 1fr; /* –û–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ */
    }

    .achievements-stats {
        flex-wrap: wrap; /* –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        gap: 10px;
        padding: 10px;
    }
     .stats-item {
        min-width: 70px; /* –£–º–µ–Ω—å—à–∞–µ–º –º–∏–Ω. —à–∏—Ä–∏–Ω—É */
    }
     .stats-value {
        font-size: 16px;
    }
     .stats-label {
        font-size: 11px;
    }


    .achievement-popup {
        max-width: 250px; /* –£–º–µ–Ω—å—à–∞–µ–º —à–∏—Ä–∏–Ω—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        padding: 8px;
        gap: 8px;
    }
    .achievement-popup .achievement-icon {
        width: 35px;
        height: 35px;
        min-width: 35px;
        font-size: 18px;
    }
    .achievement-popup .achievement-title {
         font-size: 11px;
    }
    .achievement-popup .achievement-description {
         font-size: 10px;
    }

}

/* –°—Ç–∏–ª–∏ –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞ */
.exit-dialog {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 3000;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.3s ease;
    opacity: 1;
}

.exit-dialog.hidden {
    opacity: 0;
    pointer-events: none;
}

.exit-dialog-content {
    background: linear-gradient(135deg, rgba(40, 44, 52, 0.95), rgba(30, 32, 51, 0.9));
    border: 2px solid rgba(255, 140, 0, 0.7);
    border-radius: 16px;
    padding: 25px;
    width: 80%;
    max-width: 300px;
    text-align: center;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    transform: scale(1);
    transition: transform 0.2s ease;
}

.exit-dialog.hidden .exit-dialog-content {
    transform: scale(0.8);
}

.exit-dialog-title {
    font-family: 'Press Start 2P', cursive;
    color: #fff;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
    margin: 0 0 25px 0;
    font-size: 18px;
    line-height: 1.4;
}

.exit-dialog-buttons {
    display: flex;
    justify-content: center;
    gap: 15px;
}

.exit-dialog-button {
    font-family: 'Press Start 2P', cursive;
    font-size: 14px;
    padding: 12px 25px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    text-transform: uppercase;
    color: white;
    transition: all 0.2s ease;
}

.exit-dialog-yes {
    background: linear-gradient(to bottom, #ff0080, #ff4000);
    box-shadow: 0 3px 5px rgba(255, 0, 0, 0.3);
}

.exit-dialog-no {
    background: linear-gradient(to bottom, #373b59, #1e2033);
    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3);
}

.exit-dialog-yes:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 8px rgba(255, 0, 0, 0.4);
}

.exit-dialog-no:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 8px rgba(0, 0, 0, 0.4);
}

.exit-dialog-yes:active, .exit-dialog-no:active {
    transform: translateY(1px);
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ */
@media (max-width: 480px) {
    .exit-dialog-title {
        font-size: 16px;
        margin-bottom: 20px;
    }
    
    .exit-dialog-button {
        font-size: 12px;
        padding: 10px 20px;
    }
    
    .exit-dialog-content {
        padding: 20px;
    }
}

</style>

<div class="achievements-container" id="achievements-container"></div> <div class="achievements-menu" id="achievements-menu"> <div class="achievements-header">
        <h2 class="achievements-title">–î–û–°–¢–ò–ñ–ï–ù–ò–Ø</h2>
        <button class="achievements-close" id="achievements-close" title="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
    </div>
    <div class="achievements-stats">
        <div class="stats-item">
            <div class="stats-value" id="stats-completed">0</div>
            <div class="stats-label">–ü–æ–ª—É—á–µ–Ω–æ</div>
        </div>
        <div class="stats-item">
            <div class="stats-value" id="stats-total">0</div>
            <div class="stats-label">–í—Å–µ–≥–æ</div>
        </div>
        <div class="stats-item">
            <div class="stats-value" id="stats-percentage">0%</div>
            <div class="stats-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
        </div>
    </div>
    <div class="achievements-content" id="achievements-content">
        </div>
</div>

<script>
// –ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
class AchievementSystem {
    constructor() {

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–≤—É–∫, –Ω–æ –Ω–µ –ø—ã—Ç–∞–µ–º—Å—è –µ–≥–æ —Å—Ä–∞–∑—É –∑–∞–≥—Ä—É–∑–∏—Ç—å
this.achievementSound = null;
this.soundInitialized = false;

        // –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        this.achievements = [
             { id: 'first_game', icon: 'üéÆ', title: '–ü–µ—Ä–≤–∞—è –∏–≥—Ä–∞', description: '–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª—é–±—É—é –∏–≥—Ä—É –≤–ø–µ—Ä–≤—ã–µ', secret: false, game: null, condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'game_master', icon: 'üëë', title: '–ò–≥—Ä–æ–≤–æ–π –º–∞—Å—Ç–µ—Ä', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ 10 —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä', secret: false, game: null, condition: null, progress: { current: 0, max: 10 } },
             { id: 'collector', icon: '‚≠ê', title: '–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä', description: '–î–æ–±–∞–≤—å—Ç–µ 5 –∏–≥—Ä –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ', secret: false, game: null, condition: null, progress: { current: 0, max: 5 } },
             { id: 'mario_fan', icon: 'üçÑ', title: '–§–∞–Ω–∞—Ç –ú–∞—Ä–∏–æ', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –ø—Ä–æ –ú–∞—Ä–∏–æ', secret: false, game: ['mario', 'super_mario_bros_2_rus', 'super_mario_bros_3_e_t_rus_by_2r_team_2r_team', 'mario_bros'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'contra_commando', icon: 'üî´', title: '–ö–æ–º–º–∞–Ω–¥–æ', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –∏–∑ —Å–µ—Ä–∏–∏ Contra', secret: false, game: ['contra', 'contra_force', 'super_contra'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'ninja_warrior', icon: 'ü•∑', title: '–ù–∏–Ω–¥–∑—è-–≤–æ–∏–Ω', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –æ –Ω–∏–Ω–¥–∑—è', secret: false, game: ['ninja_gaiden', 'shadow_of_the_ninja'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'tank_commander', icon: 'üèÜ', title: '–¢–∞–Ω–∫–æ–≤—ã–π –∫–æ–º–∞–Ω–¥–∏—Ä', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ Battle City', secret: false, game: ['battle_city', 'tank_1990'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'megaman_hero', icon: 'ü§ñ', title: '–ì–µ—Ä–æ–π –ú–µ–≥–∞–º–µ–Ω', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –ª—é–±—É—é –∏–≥—Ä—É –ø—Ä–æ –ú–µ–≥–∞–º–µ–Ω–∞', secret: false, game: ['mega_man', 'mega_man2', 'mega_man3', 'mega_man4', 'mega_man5', 'megaman6'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'turtles_fan', icon: 'üê¢', title: '–§–∞–Ω–∞—Ç —á–µ—Ä–µ–ø–∞—à–µ–∫', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –∏–∑ —Å–µ—Ä–∏–∏ TMNT', secret: false, game: ['teenage_mutant_ninja_turtles_rus', 'teenage_mutant_ninja_turtles_ii_the_arcade_game', 'teenage_mutant_ninja_turtles_tournament_fighters', 'teenage_manhattan'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'disney_adventurer', icon: 'ü¶Ü', title: '–î–∏—Å–Ω–µ–π-–ø—Ä–∏–∫–ª—é—á–µ–Ω–µ—Ü', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—É –ø–æ –º—É–ª—å—Ç—Ñ–∏–ª—å–º—É Disney', secret: false, game: ['duck_tales', 'duck_tales_2', 'chip_n_dale_rescue_rangers_rus', 'chip_n_dale_rescue_rangers_2_u_t_rus_by_shedevr', 'darkwing_duck_u', 'talespin'], condition: () => true, progress: { current: 0, max: 1 } },
             { id: 'night_gamer', icon: 'üåô', title: '–ù–æ—á–Ω–æ–π –≥–µ–π–º–µ—Ä', description: '–ò–≥—Ä–∞–π—Ç–µ –º–µ–∂–¥—É 23:00 –∏ 5:00', secret: true, game: null, condition: () => { const hour = new Date().getHours(); return hour >= 23 || hour < 5; }, progress: { current: 0, max: 1 } },
             { id: 'explorer', icon: 'üîç', title: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å', description: '–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏—è 20 —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä', secret: false, game: null, condition: null, progress: { current: 0, max: 20 } }, // –ò–∑–º–µ–Ω–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ
             { id: 'early_bird', icon: 'üê¶', title: '–†–∞–Ω–Ω—è—è –ø—Ç–∞—à–∫–∞', description: '–ò–≥—Ä–∞–π—Ç–µ –º–µ–∂–¥—É 5:00 –∏ 8:00 —É—Ç—Ä–∞', secret: true, game: null, condition: () => { const hour = new Date().getHours(); return hour >= 5 && hour < 8; }, progress: { current: 0, max: 1 } },
             { id: 'weekend_warrior', icon: 'üé≠', title: '–í—ã—Ö–æ–¥–Ω–æ–π –≤–æ–∏–Ω', description: '–ò–≥—Ä–∞–π—Ç–µ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏', secret: false, game: null, condition: () => { const day = new Date().getDay(); return day === 0 || day === 6; }, progress: { current: 0, max: 1 } },
             { id: 'tetris_champion', icon: 'üß©', title: '–ú–∞—Å—Ç–µ—Ä –±–ª–æ–∫–æ–≤', description: '–°—ã–≥—Ä–∞–π—Ç–µ –≤ Tetris', secret: false, game: ['tetris'], condition: () => true, progress: { current: 0, max: 1 } }
        ];

// –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∑–≤—É–∫–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
document.addEventListener('click', () => {
    if (!this.soundInitialized) {
        this.achievementSound = new Audio('data/sound/achievement.mp3');
        this.achievementSound.volume = 0.7;
        this.soundInitialized = true;
    }
}, { once: true }); // –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑

        // –°—Ç–∞—Ç—É—Å—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ { achievementId: { unlocked: true, unlockTime: 'ISOString' } }
        this.unlockedAchievements = this.loadUnlockedAchievements();
        // –°–ø–∏—Å–æ–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö –∏–≥—Ä (–¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è Explorer) [gameId1, gameId2, ...]
        this.viewedGames = this.loadViewedGames();
        // –°–ø–∏—Å–æ–∫ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∏–≥—Ä (–¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è Game Master) [gameId1, gameId2, ...]
        this.playedGames = this.loadPlayedGames();
        // –ù–æ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–Ω–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –≤ –º–µ–Ω—é) [achId1, achId2, ...]
        this.newAchievements = this.loadNewAchievements();

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        this.container = document.getElementById('achievements-container');
        this.menu = document.getElementById('achievements-menu');
        this.menuContent = document.getElementById('achievements-content');
        this.statsCompleted = document.getElementById('stats-completed');
        this.statsTotal = document.getElementById('stats-total');
        this.statsPercentage = document.getElementById('stats-percentage');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        this.initEvents();
        this.renderAchievementsMenu(); // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–µ–Ω—é
        this.updateNotificationBadge(); // –ü–æ–∫–∞–∑–∞—Ç—å –∑–Ω–∞—á–æ–∫, –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–≤—ã–µ
        this.checkInitialProgress(); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
         console.log("AchievementSystem initialized."); // –û—Ç–ª–∞–¥–∫–∞
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
    loadData(key, defaultValue) {
        try {
            const saved = localStorage.getItem(key);
            return saved ? JSON.parse(saved) : defaultValue;
        } catch (e) {
            console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ${key}:`, e);
            return defaultValue;
        }
    }
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
    saveData(key, data) {
        try {
            localStorage.setItem(key, JSON.stringify(data));
        } catch (e) {
            console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ ${key}:`, e);
             // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± –æ—à–∏–±–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
             // alert("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π. –í–æ–∑–º–æ–∂–Ω–æ, –ø–∞–º—è—Ç—å –±—Ä–∞—É–∑–µ—Ä–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞.");
        }
    }

    loadUnlockedAchievements() { return this.loadData('unlockedAchievements', {}); }
    saveUnlockedAchievements() { this.saveData('unlockedAchievements', this.unlockedAchievements); }
    loadViewedGames() { return this.loadData('viewedGames', []); }
    saveViewedGames() { this.saveData('viewedGames', this.viewedGames); }
    loadPlayedGames() { return this.loadData('playedGames', []); }
    savePlayedGames() { this.saveData('playedGames', this.playedGames); }
    loadNewAchievements() { return this.loadData('newAchievements', []); }
    saveNewAchievements() { this.saveData('newAchievements', this.newAchievements); }


    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
    updateNotificationBadge() {
        const achievementsButton = document.querySelector('.navigation .nav-button[title="–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è"]');
        if (!achievementsButton) return; // –í—ã—Ö–æ–¥–∏–º, –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∏ –Ω–µ—Ç

        let badge = achievementsButton.querySelector('.achievements-notification');

        if (this.newAchievements.length > 0) {
            if (!badge) { // –ï—Å–ª–∏ –±–µ–π–¥–∂–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º –µ–≥–æ
                badge = document.createElement('div');
                badge.className = 'achievements-notification';
                achievementsButton.appendChild(badge);
            }
            badge.textContent = this.newAchievements.length;
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º requestAnimationFrame –¥–ª—è –ø–ª–∞–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
            requestAnimationFrame(() => {
                 badge.classList.add('active');
            });
        } else if (badge) { // –ï—Å–ª–∏ –±–µ–π–¥–∂ –µ—Å—Ç—å, –Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–µ—Ç
            badge.classList.remove('active');
             // –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –±–µ–π–¥–∂ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
             // setTimeout(() => badge.remove(), 300);
        }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
    initEvents() {
         // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é
         const closeButton = document.getElementById('achievements-close');
         if (closeButton) {
            closeButton.addEventListener('click', () => this.hideAchievementsMenu());
         } else {
             console.error("–ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!");
         }


         // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é, –µ—Å–ª–∏ –µ—ë –µ—â—ë –Ω–µ—Ç
         const navigation = document.querySelector('.navigation');
         let achievementsButton = document.querySelector('.nav-button[title="–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è"]'); // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ

         if (navigation && !achievementsButton) {
             achievementsButton = document.createElement('button');
             achievementsButton.className = 'nav-button';
             achievementsButton.title = '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è';
             achievementsButton.innerHTML = 'üèÖ'; // –ò–∫–æ–Ω–∫–∞
             navigation.appendChild(achievementsButton);
             console.log("–ö–Ω–æ–ø–∫–∞ '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è' –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é.");
         }
         // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∞ —É–∂–µ –±—ã–ª–∞)
         if (achievementsButton) {
             achievementsButton.addEventListener('click', () => this.showAchievementsMenu());
         } else {
             console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∫–Ω–æ–ø–∫—É '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è'.");
         }


        // –°–ª—É—à–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
        document.addEventListener('gameStarted', (e) => {
            if (e.detail && e.detail.gameId !== undefined) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ gameId (–º–æ–∂–µ—Ç –±—ã—Ç—å null)
                 console.log("Event 'gameStarted' received with id:", e.detail.gameId);
                 this.onGameStarted(e.detail.gameId);
            } else {
                 console.warn("Event 'gameStarted' received without gameId in detail.");
                 // –í—ã–∑—ã–≤–∞–µ–º onGameStarted —Å null, —á—Ç–æ–±—ã —Å—Ä–∞–±–æ—Ç–∞–ª–æ 'first_game'
                 this.onGameStarted(null);
            }
        });
        document.addEventListener('gameViewed', (e) => {
            if (e.detail && e.detail.gameId) {
                 console.log("Event 'gameViewed' received with id:", e.detail.gameId);
                 this.onGameViewed(e.detail.gameId);
            } else {
                 console.warn("Event 'gameViewed' received without gameId in detail.");
            }
        });
        document.addEventListener('favoriteAdded', (e) => {
             console.log("Event 'favoriteAdded' received.");
             this.checkCollectorAchievement(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–∞
        });

        // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏
        this.checkTimeBasedAchievements(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ä–∞–∑—É
        setInterval(() => {
            this.checkTimeBasedAchievements();
        }, 60000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
    }

     // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
     checkInitialProgress() {
         this.checkCollectorAchievement();
         this.checkGameMasterAchievement();
         this.checkExplorerAchievement();
         console.log("Initial achievement progress checked.");
     }


    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã
    onGameStarted(gameId) {
        console.log("AchievementSystem: onGameStarted processing for gameId:", gameId);

        // 1. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º "–ü–µ—Ä–≤–∞—è –∏–≥—Ä–∞"
        // –î–ª—è —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ –Ω—É–∂–µ–Ω, –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º
        const firstGameAch = this.achievements.find(a => a.id === 'first_game');
        if (firstGameAch && !this.isUnlocked('first_game')) {
             this.unlockAchievement('first_game');
        }

        // 2. –ï—Å–ª–∏ ID –∏–≥—Ä—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        if (gameId) {
            this.achievements.forEach(achievement => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ –∏–≥—Ä–µ, –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∏ –∏–≥—Ä–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç
                if (achievement.game && Array.isArray(achievement.game) && !this.isUnlocked(achievement.id) && achievement.game.includes(gameId)) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏–µ (–æ–±—ã—á–Ω–æ () => true –¥–ª—è game-specific)
                    if (typeof achievement.condition === 'function' && achievement.condition()) {
                        console.log(`AchievementSystem: Unlocking specific achievement: ${achievement.id} for game ${gameId}`);
                        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–ª–∏ —Å—Ä–∞–∑—É —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º
                        if(achievement.progress.max === 1) {
                             this.unlockAchievement(achievement.id);
                        } else {
                             // –õ–æ–≥–∏–∫–∞ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ (–∑–¥–µ—Å—å –Ω–µ—Ç —Ç–∞–∫–∏—Ö)
                        }
                    }
                }
            });

            // 3. –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä—É –≤ —Å–ø–∏—Å–æ–∫ *—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö* –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö
            const playedSet = new Set(this.playedGames); // –ò—Å–ø–æ–ª—å–∑—É–µ–º Set –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
            if (!playedSet.has(gameId)) {
                this.playedGames.push(gameId);
                this.savePlayedGames();
                console.log(`AchievementSystem: Added ${gameId} to played games. Total unique: ${this.playedGames.length}`);
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–ò–≥—Ä–æ–≤–æ–π –º–∞—Å—Ç–µ—Ä" –ü–û–°–õ–ï –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
                this.checkGameMasterAchievement();
            }
        } else {
            console.log("AchievementSystem: gameId is null, skipping game-specific checks and played games update.");
        }

        // 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –≤—Ä–µ–º–µ–Ω–∏
        this.checkTimeBasedAchievements();

        // 5. –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–Ω–¥–µ—Ä –º–µ–Ω—é, —á—Ç–æ–±—ã –æ—Ç—Ä–∞–∑–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        this.renderAchievementsMenu();
    }


    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–≥—Ä—ã
    onGameViewed(gameId) {
         console.log("AchievementSystem: onGameViewed processing for gameId:", gameId);
         if (!gameId) return;

        // –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä—É –≤ —Å–ø–∏—Å–æ–∫ *—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö* –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö
         const viewedSet = new Set(this.viewedGames);
         if (!viewedSet.has(gameId)) {
            this.viewedGames.push(gameId);
            this.saveViewedGames();
             console.log(`AchievementSystem: Added ${gameId} to viewed games. Total unique: ${this.viewedGames.length}`);
             // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å"
            this.checkExplorerAchievement();
             // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–Ω–¥–µ—Ä –º–µ–Ω—é
             this.renderAchievementsMenu();
        }
    }

     // –ü—Ä–æ–≤–µ—Ä–∫–∞, —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –ª–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
     isUnlocked(achievementId) {
         return this.unlockedAchievements[achievementId] ? true : false;
     }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "–ò–≥—Ä–æ–≤–æ–π –º–∞—Å—Ç–µ—Ä"
    checkGameMasterAchievement() {
        const achievement = this.achievements.find(a => a.id === 'game_master');
        if (achievement && !this.isUnlocked(achievement.id)) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–≥—Ä
            achievement.progress.current = Math.min(this.playedGames.length, achievement.progress.max);
            console.log(`AchievementSystem: Game Master progress: ${achievement.progress.current}/${achievement.progress.max}`);
            if (achievement.progress.current >= achievement.progress.max) {
                this.unlockAchievement('game_master');
            }
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ –º–µ–Ω—é (–¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ)
            this.updateAchievementProgressDisplay('game_master');
        } else if (achievement && this.isUnlocked(achievement.id)) {
             // –ï—Å–ª–∏ —É–∂–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ, —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –ø—Ä–æ–≥—Ä–µ—Å—Å = max
             achievement.progress.current = achievement.progress.max;
             this.updateAchievementProgressDisplay('game_master');
        }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä"
    checkCollectorAchievement() {
         const achievement = this.achievements.find(a => a.id === 'collector');
         if (achievement && !this.isUnlocked(achievement.id)) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
             const favorites = favoritesManager.getFavorites(); // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫
             achievement.progress.current = Math.min(favorites.length, achievement.progress.max);
             console.log(`AchievementSystem: Collector progress: ${achievement.progress.current}/${achievement.progress.max}`);
             if (achievement.progress.current >= achievement.progress.max) {
                 this.unlockAchievement('collector');
             }
             this.updateAchievementProgressDisplay('collector');
         } else if (achievement && this.isUnlocked(achievement.id)) {
             achievement.progress.current = achievement.progress.max;
             this.updateAchievementProgressDisplay('collector');
         }
    }


    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å"
    checkExplorerAchievement() {
         const achievement = this.achievements.find(a => a.id === 'explorer');
         if (achievement && !this.isUnlocked(achievement.id)) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
             const uniqueViewedCount = new Set(this.viewedGames).size;
             achievement.progress.current = Math.min(uniqueViewedCount, achievement.progress.max);
             console.log(`AchievementSystem: Explorer progress: ${achievement.progress.current}/${achievement.progress.max}`);
             if (achievement.progress.current >= achievement.progress.max) {
                 this.unlockAchievement('explorer');
             }
             this.updateAchievementProgressDisplay('explorer');
         } else if (achievement && this.isUnlocked(achievement.id)) {
             achievement.progress.current = achievement.progress.max;
             this.updateAchievementProgressDisplay('explorer');
         }
    }


    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –≤—Ä–µ–º–µ–Ω–∏
    checkTimeBasedAchievements() {
        this.achievements.forEach(achievement => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ time-based –∏ –µ—Å–ª–∏ –µ—â–µ –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
            if (['night_gamer', 'early_bird', 'weekend_warrior'].includes(achievement.id) && !this.isUnlocked(achievement.id)) {
                if (typeof achievement.condition === 'function' && achievement.condition()) {
                     console.log(`AchievementSystem: Condition met for time-based achievement: ${achievement.id}`);
                     this.unlockAchievement(achievement.id);
                }
            }
        });
    }

    // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
    unlockAchievement(achievementId) {
        if (this.isUnlocked(achievementId)) { // –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            return;
        }
        const achievement = this.achievements.find(a => a.id === achievementId);
        if (!achievement) {
            console.error(`–ü–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${achievementId}`);
            return;
        }

        console.log(`AchievementSystem: Unlocking achievement '${achievement.title}' (${achievementId})`);
        const unlockTime = new Date().toISOString();
        this.unlockedAchievements[achievementId] = { unlocked: true, unlockTime: unlockTime };
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –º–∞–∫—Å–∏–º—É–º
        achievement.progress.current = achievement.progress.max;

        // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ *—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö* –Ω–æ–≤—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
         if (!this.newAchievements.includes(achievementId)) {
            this.newAchievements.push(achievementId);
         }

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º
        this.saveUnlockedAchievements();
        this.saveNewAchievements();

        // –û–±–Ω–æ–≤–ª—è–µ–º UI
        this.updateNotificationBadge();
        this.showAchievementPopup(achievement);
        this.renderAchievementsMenu(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –º–µ–Ω—é —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ –º–µ–Ω—é
    updateAchievementProgressDisplay(achievementId) {
        const achievement = this.achievements.find(a => a.id === achievementId);
        if (!achievement) return;

        const card = this.menuContent ? this.menuContent.querySelector(`.achievement-card[data-id="${achievementId}"]`) : null;
        if (card) {
            const progressBar = card.querySelector('.achievement-progress-bar');
            const progressContainer = card.querySelector('.achievement-progress');
            if (progressBar && progressContainer) {
                 const isAchUnlocked = this.isUnlocked(achievementId);
                 // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ï —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∏ –µ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
                 if (!isAchUnlocked && achievement.progress.max > 1) {
                     const percent = achievement.progress.max > 0 ? (achievement.progress.current / achievement.progress.max) * 100 : 0;
                     progressBar.style.width = `${percent}%`;
                     progressContainer.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                 } else {
                     progressBar.style.width = '0%'; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–ª–∏ max=1
                     progressContainer.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                 }
            }
             // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—Ç—É, –µ—Å–ª–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
             const dateElement = card.querySelector('.achievement-date');
             if (dateElement) {
                 const isAchUnlocked = this.isUnlocked(achievementId);
                 if(isAchUnlocked && this.unlockedAchievements[achievementId]?.unlockTime) {
                     const unlockDate = new Date(this.unlockedAchievements[achievementId].unlockTime);
                     const unlockDateStr = unlockDate.toLocaleDateString() + ' ' + unlockDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                     dateElement.textContent = '–ü–æ–ª—É—á–µ–Ω–æ: ' + unlockDateStr;
                     dateElement.style.display = 'block';
                 } else {
                     dateElement.style.display = 'none';
                 }
             }

        } else {
             // console.warn(`–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞: ${achievementId}`);
        }
    }


    // –ü–æ–∫–∞–∑ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏
    showAchievementPopup(achievement) {
// –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
if (this.achievementSound && this.soundInitialized) {
    try {
        this.achievementSound.currentTime = 0;
        this.achievementSound.play().catch(error => {
            console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:', error);
        });
    } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –∑–≤—É–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:', e);
    }
}

         if (!this.container) {
             console.error("–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω!");
             return;
         }
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç
        const popup = document.createElement('div');
        popup.className = 'achievement-popup';
        popup.innerHTML = `
            <div class="achievement-icon">${achievement.icon}</div>
            <div class="achievement-content">
                <div class="achievement-title">${achievement.title}</div>
                <div class="achievement-description">${achievement.description}</div>
            </div>
        `;
        this.container.appendChild(popup);

        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
        requestAnimationFrame(() => {
            popup.classList.add('show');
            setTimeout(() => {
                popup.classList.remove('show');
                popup.addEventListener('transitionend', () => {
                     if (popup.parentNode === this.container) { // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –µ—â–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                         this.container.removeChild(popup);
                     }
                }, { once: true }); // –£–¥–∞–ª—è–µ–º –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
            }, 4000); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º 4 —Å–µ–∫—É–Ω–¥—ã
        });
    }


    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ–Ω—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
    showAchievementsMenu() {
         if (!this.menu) {
             console.error("–≠–ª–µ–º–µ–Ω—Ç –º–µ–Ω—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω!");
             return;
         }
        this.renderAchievementsMenu(); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º
        this.menu.classList.add('active');
        document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª —Ñ–æ–Ω–∞

        // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –Ω–æ–≤—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
        this.newAchievements = [];
        this.saveNewAchievements();
        this.updateNotificationBadge(); // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–æ–∫ (–æ–Ω –¥–æ–ª–∂–µ–Ω –∏—Å—á–µ–∑–Ω—É—Ç—å)
         console.log("Achievements menu shown.");
    }

    // –°–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
    hideAchievementsMenu() {
         if (!this.menu) return;
        this.menu.classList.remove('active');
        document.body.style.overflow = ''; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª —Ñ–æ–Ω–∞
         console.log("Achievements menu hidden.");
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ –º–µ–Ω—é
    renderAchievementsMenu() {
         if (!this.menuContent || !this.statsCompleted || !this.statsTotal || !this.statsPercentage) {
             // console.error("–ù–µ –Ω–∞–π–¥–µ–Ω—ã –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –º–µ–Ω—é –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π.");
             // –ù–µ –≤—ã–≤–æ–¥–∏–º –æ—à–∏–±–∫—É –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, —Ç.–∫. —Ä–µ–Ω–¥–µ—Ä –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –¥–æ –ø–æ–ª–Ω–æ–≥–æ DOM ready
             return;
         }

        // –°–æ—Ä—Ç–∏—Ä—É–µ–º: —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (–ø–æ –¥–∞—Ç–µ), –ø–æ—Ç–æ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (–ø–æ –ø–æ—Ä—è–¥–∫—É)
         const sortedAchievements = [...this.achievements].sort((a, b) => {
             const unlockedA = this.isUnlocked(a.id);
             const unlockedB = this.isUnlocked(b.id);

             if (unlockedA && !unlockedB) return -1; // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—ã—à–µ
             if (!unlockedA && unlockedB) return 1;  // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∏–∂–µ
             if (unlockedA && unlockedB) {
                 // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ (—Å–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ)
                 const timeA = new Date(this.unlockedAchievements[a.id]?.unlockTime || 0).getTime();
                 const timeB = new Date(this.unlockedAchievements[b.id]?.unlockTime || 0).getTime();
                 return timeB - timeA; // –ù–æ–≤—ã–µ –≤—ã—à–µ
             }
             // –ï—Å–ª–∏ –æ–±–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã, –æ—Å—Ç–∞–≤–ª—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ (–∏–ª–∏ –º–æ–∂–Ω–æ –ø–æ title)
             return 0;
              // return a.title.localeCompare(b.title); // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
         });


        // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        this.menuContent.innerHTML = '';

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
        sortedAchievements.forEach(achievement => {
            const isAchUnlocked = this.isUnlocked(achievement.id);

            let title = achievement.title;
            let description = achievement.description;
            let icon = achievement.icon;

            if (achievement.secret && !isAchUnlocked) {
                title = "???";
                description = "–°–µ–∫—Ä–µ—Ç–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ";
                icon = '‚ùì'; // –ò–∫–æ–Ω–∫–∞ –¥–ª—è —Å–µ–∫—Ä–µ—Ç–∞
            }

            const card = document.createElement('div');
            card.className = `achievement-card ${isAchUnlocked ? 'unlocked' : ''} ${achievement.secret ? 'secret' : ''}`;
            card.dataset.id = achievement.id;

            const current = achievement.progress.current;
            const max = achievement.progress.max;
            const percent = max > 0 ? (current / max) * 100 : (isAchUnlocked ? 100 : 0);

            const unlockDate = isAchUnlocked ? new Date(this.unlockedAchievements[achievement.id]?.unlockTime || Date.now()) : null;
            const unlockDateStr = unlockDate ? unlockDate.toLocaleDateString() + ' ' + unlockDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '';

            card.innerHTML = `
                <div class="achievement-icon">${icon}</div>
                <div class="achievement-content">
                    <div class="achievement-title">${title}</div>
                    <div class="achievement-description">${description}</div>
                    <div class="achievement-date" style="display: ${isAchUnlocked ? 'block' : 'none'}">${isAchUnlocked ? '–ü–æ–ª—É—á–µ–Ω–æ: ' + unlockDateStr : ''}</div>
                    <div class="achievement-progress" style="display: ${!isAchUnlocked && max > 1 ? 'block' : 'none'}">
                        <div class="achievement-progress-bar" style="width: ${percent}%"></div>
                    </div>
                </div>
            `;
            this.menuContent.appendChild(card);
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        const unlockedCount = Object.keys(this.unlockedAchievements).length;
        const totalCount = this.achievements.length;
        const percentage = totalCount > 0 ? Math.floor((unlockedCount / totalCount) * 100) : 0;

        this.statsCompleted.textContent = unlockedCount;
        this.statsTotal.textContent = totalCount;
        this.statsPercentage.textContent = `${percentage}%`;
    }

} // --- –ö–æ–Ω–µ—Ü –∫–ª–∞—Å—Å–∞ AchievementSystem ---

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    // –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –°–†–ê–ó–£
    window.achievementSystem = new AchievementSystem();

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Ä–∞–Ω–µ–µ
    // (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage)
     if (window.achievementSystem) {
         window.achievementSystem.checkInitialProgress();
     } else {
         console.error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç achievementSystem!");
     }

});
</script>

<!-- –î–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –∏–≥—Ä—ã -->
<div id="exit-game-dialog" class="exit-dialog hidden">
    <div class="exit-dialog-content">
        <h2 class="exit-dialog-title">–í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã?</h2>
        <div class="exit-dialog-buttons">
            <button id="exit-dialog-yes" class="exit-dialog-button exit-dialog-yes">–î–∞</button>
            <button id="exit-dialog-no" class="exit-dialog-button exit-dialog-no">–ù–µ—Ç</button>
        </div>
    </div>
</div>

</body>
</html>